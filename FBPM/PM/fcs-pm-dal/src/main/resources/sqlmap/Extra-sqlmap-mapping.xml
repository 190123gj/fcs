<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>estate-dalgen</tt>, a DAL (Data Access Layer)  -->
<!-- code generation utility specially developed for <tt>rent</tt>      -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>estate-dalgen</tt> to generate this file.                                -->
<!--                                                                               -->
<!-- @author peigen                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="fcspm">
	

	<!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->
    
    <!-- 表单结果通用 -->
    <resultMap id="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.SimpleFormDO">
        <result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formCode" column="form_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formName" column="form_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formUrl" column="form_url" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formStatus" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="detailStatus" column="detail_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="actDefId" column="act_def_id" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="actInstId" column="act_inst_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="taskId" column="task_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="runId" column="run_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="defId" column="def_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formUserId" column="user_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formUserAccount" column="user_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formUserName" column="user_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formDeptId" column="form_dept_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formDeptName" column="form_dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formDeptCode" column="form_dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formDeptPath" column="form_dept_path" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formDeptPathName" column="form_dept_path_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="checkStatus" column="check_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="relatedProjectCode" column="related_project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="taskUserData" column="task_user_data" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="trace" column="trace" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="submitTime" column="submit_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="finishTime" column="finish_time" javaType="java.util.Date" jdbcType="DATETIME"/>        
        <result property="formAddTime" column="form_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="formUpdateTime" column="form_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>
    
    <!-- 简单项目信息 -->
    <resultMap id="RM-EXTRA-SIMPLE-FORM-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.SimpleFormProjectDO">
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerType" column="customer_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="amount" column="amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="timeLimit" column="time_limit" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="timeUnit" column="time_unit" javaType="java.lang.String" jdbcType="VARCHAR"/>                   	
    </resultMap>
  
	
	<!-- 表单&&项目  -->
    <resultMap id="RM-FORM-F-PROJECT" extends="RM-EXTRA-SIMPLE-FORM-PROJECT" class="com.born.fcs.pm.dataobject.FormProjectDO">
       <!-- project --> 
        <result property="projectId" column="project_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerId" column="busi_manager_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerbId" column="busi_managerb_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerbName" column="busi_managerb_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptId" column="project_dept_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="deptName" column="project_dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptCode" column="project_dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptPath" column="project_dept_path" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptPathName" column="project_dept_path_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectAddTime" column="project_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="projectUpdateTime" column="project_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>
    
    <!-- 项目信息 -->
    <resultMap id="RM-PROJECT" class="com.born.fcs.pm.dal.dataobject.ProjectDO">
        <result property="projectId" column="project_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerType" column="customer_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="loanPurpose" column="loan_purpose" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="industryCode" column="industry_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="industryName" column="industry_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="timeLimit" column="time_limit" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="timeUnit" column="time_unit" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="startTime" column="start_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="endTime" column="end_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="amount" column="amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="isMaximumAmount" column="is_maximum_amount" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="accumulatedIssueAmount" column="accumulated_issue_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="loanedAmount" column="loaned_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="usedAmount" column="used_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="repayedAmount" column="repayed_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="contractNo" column="contract_no" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="spId" column="sp_id" javaType="long" jdbcType="BIGINT" nullValue="0" />
        <result property="spCode" column="sp_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerId" column="busi_manager_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerAccount" column="busi_manager_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerbId" column="busi_managerb_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerbAccount" column="busi_managerb_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerbName" column="busi_managerb_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptId" column="dept_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="deptName" column="dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="phases" column="phases" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="status" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="phasesStatus" column="phases_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isContinue" column="is_continue" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>
    
    <!-- 立项申请列表 -->
    <resultMap id="RM-SETUP-FORM-F-PROJECT" extends="RM-FORM-F-PROJECT"  class="com.born.fcs.pm.dataobject.SetupFormProjectDO">  
       <result property="investigateId" column="investigate_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
       <result property="investigateFormId" column="investigate_form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
       <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
 	   <result property="trueCustomerId" column="true_customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
       <result property="trueCustomerName" column="true_customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
       <result property="trueCustomerType" column="true_customer_type" javaType="java.lang.String" jdbcType="VARCHAR"/>      
	</resultMap> 

	 
	<!-- 风险审查报告 --> 
    <resultMap id = "RM-RISK-REVIEW-FORM-F-PROJECT" extends="RM-FORM-F-PROJECT"  class="com.born.fcs.pm.dataobject.RiskReviewFormProjectDO">  
       <result property="id"    column="risk_review_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
	   <result property="riskReviewAddTime" column="risk_review_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	</resultMap>  
	
	<!-- 保后检查报告 --> 
    <resultMap id = "RM-AFTERWARDS-CHECK-F-PROJECT" extends="RM-FORM-F-PROJECT"  class="com.born.fcs.pm.dataobject.AfterwardsCheckProjectDO">  
       <result property="id"    column="afterwards_check_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
	   <result property="afterwardsCheckAddTime" column="afterwards_check_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	   <result property="checkDate" column="check_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	   <result property="checkAddress" column="check_address" javaType="java.lang.String" jdbcType="VARCHAR"/>
	   <result property="edition" column="edition" javaType="java.lang.String" jdbcType="VARCHAR"/>
	   <result property="rounds" column="rounds" javaType="java.lang.String" jdbcType="VARCHAR"/>
	</resultMap>  
	
	<!-- 投票 -->
	<resultMap id = "RM-COUNCIL-VOTE-PROJECT" extends="RM-PROJECT"  class="com.born.fcs.pm.dataobject.CouncilVoteProjectDO">
		<result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="councilId" column="council_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="councilCode" column="council_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectVoteResult" column="project_vote_result" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="riskSecretaryQuit" column="risk_secretary_quit" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="riskSecretaryQuitMark" column="risk_secretary_quit_mark" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="judgesCount" column="judges_count" javaType="int" jdbcType="INT" nullValue="0"/>
		<result property="passCount" column="pass_count" javaType="int" jdbcType="INT" nullValue="0"/>
		<result property="notpassCount" column="notpass_count" javaType="int" jdbcType="INT" nullValue="0"/>
		<result property="quitCount" column="quit_count" javaType="int" jdbcType="INT" nullValue="0"/>
		<result property="oneVoteDown" column="one_vote_down" javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="oneVoteDownMark" column="one_vote_down_mark" javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voteStatus" column="vote_status" javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="voteResult" column="vote_result" javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="judgeId" column="judge_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="compereMessage" column="compere_message" javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="councilProjectId" column="council_project_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		
	</resultMap>
	
	<!-- 用印 -->
	<resultMap id="RM-STAMP-APPLY-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.StampApplyFormProjeactDO">
		<!-- form -->
		<!--<result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
		<!--<result property="formUserId" column="user_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
		<!--<result property="formCode" column="form_code" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
		<!--<result property="formStatus" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
		<!--<result property="formUserName" column="user_name" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
		<!--<result property="formDeptName" column="dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
		<result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="fileId" column="file_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="applyCode" column="apply_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="fileCode" column="file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="submitStatus" column="submit_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="fileName" column="file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractCode" column="contract_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="replaceFileName" column="replace_file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="replaceFormStatus" column="replace_form_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="legalChapterNum" column="legal_chapter_num" javaType="int" jdbcType="INT" nullValue="0"/>
		<result property="cachetNum" column="cachet_num" javaType="int" jdbcType="INT" nullValue="0"/>
		<result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="source" column="source" javaType="java.lang.String" jdbcType="VARCHAR"/>
	</resultMap>

    <!-- 基础资料用印 -->
    <resultMap id="RM-STAMP-BASIC-DATA-APPLY-FORM" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.StampApplyFormProjeactDO">
        <result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="applyCode" column="apply_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="fileName" column="file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!-- 征信 -->
    <resultMap id="RM-CREDIT-REFRERENCE-APPLY-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.CreditRefrerenceApplyFormDO">
        <!-- form -->
        <!--<result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
        <!--<result property="formUserId" column="user_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
        <!--<result property="formStatus" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
        <result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="companyName" column="company_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiLicenseNo" column="busi_license_no" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="applyManName" column="apply_man_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="creditReport" column="credit_report" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="attachment" column="attachment" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>
	
	<!-- 放用款申请列表 -->
    <resultMap id="RM-LOAN-USE-FORM-PROJECT" extends="RM-EXTRA-SIMPLE-FORM-PROJECT" class="com.born.fcs.pm.dataobject.LoanUseApplyFormDO">
    	<!-- 申请单部分 -->
        <result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="notificationId" column="notification_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="applyAmount" column="apply_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="applyType" column="apply_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="applyAddTime" column="apply_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="applyUpdateTime" column="apply_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <!-- 回执部分 -->
        <result property="receiptId" column="receipt_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="receiptAmount" column="receipt_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
    </resultMap>
    
	<!-- 尽职调查列表 -->
    <resultMap id="RM-INVESTIGATION-FORM" extends="RM-EXTRA-SIMPLE-FORM-PROJECT" class="com.born.fcs.pm.dataobject.InvestigationDO">
        <result property="investigateId" column="investigate_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="review" column="review" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="councilBack" column="council_back" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="creditAmount" column="credit_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>
    
	<!-- 风险预警列表 -->
    <resultMap id="RM-RISK-WARNING-FORM" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.RiskWarningDO">
        <result property="warningId" column="warning_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="signalLevel" column="signal_level" javaType="java.lang.String" jdbcType="VARCHAR"/>     
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>     
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/> 
        <result property="warningBillType" column="warning_bill_type" javaType="java.lang.String" jdbcType="VARCHAR"/>     
    </resultMap>
    
	<!-- 到期项目列表 -->
    <resultMap id="RM-EXPIRE-PROJECT" extends="RM-PROJECT" class="com.born.fcs.pm.dataobject.ExpireFormProjectDO">
        <result property="expireProjectId" column="expire_project_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="expireDate" column="expire_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="expireStatus" column="expire_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="repayCertificate" column="repay_certificate" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="templateProjectCode" column="template_projectCode" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="templateId" column="template_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
    </resultMap>
    
	<!-- 上会申报项目列表 -->
    <resultMap id="RM-RISK-HANDLE-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.CouncilApplyRiskHandleDO">
        <result property="handleId" column="handle_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="isRepay" column="is_repay" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="phases" column="phases" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerId" column="busi_manager_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerAccount" column="busi_manager_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>

	<!-- 解保申请 -->
    <resultMap id="RM-RELEASE-APPLY-FORM" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.ReleaseApplyDO">
        <result property="releaseId" column="release_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="phases" column="phases" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerId" column="busi_manager_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerAccount" column="busi_manager_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rightVoucherExtenDate" column="right_voucher_exten_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>    
    
	<!-- 风险评级 -->
    <resultMap id="RM-RISK-LEVEL-FORM" extends="RM-EXTRA-SIMPLE-FORM-PROJECT" class="com.born.fcs.pm.dataobject.RiskLevelDO">
        <result property="riskLevelId" column="risk_level_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="reevaluationId" column="reevaluation_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="evaluationLevel" column="evaluation_level" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="reevaluationLevel" column="reevaluation_level" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="checkLevel" column="check_level" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="checkPhase" column="check_phase" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>
    
	<!-- 保后检查报告 -->
    <resultMap id="RM-AFTER-CHECK-FORM" extends="RM-EXTRA-SIMPLE-FORM-PROJECT" class="com.born.fcs.pm.dataobject.AfterwardsCheckDO">
        <result property="busiManagerId" column="busi_manager_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="checkId" column="check_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="edition" column="edition" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="roundYear" column="round_year" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="roundTime" column="round_time" javaType="int" jdbcType="INT" nullValue="0"/>
    </resultMap>
    
	<!-- 理财项目立项列表 -->
    <resultMap id="RM-FINANCIAL-PROJECT-SETUP-FORM" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FinancialProjectSetupFormDO">
        <result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="productId" column="product_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="productType" column="product_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="productName" column="product_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="interestType" column="interest_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="termType" column="term_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="timeLimit" column="time_limit" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="timeUnit" column="time_unit" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="issueInstitution" column="issue_institution" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="interestRate" column="interest_rate" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="rateRangeStart" column="rate_range_start" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="rateRangeEnd" column="rate_range_end" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="interestSettlementWay" column="interest_settlement_way" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="expectBuyDate" column="expect_buy_date" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="expectExpireDate" column="expect_expire_date" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="expectBuyNum" column="expect_buy_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="buyNum" column="buy_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="buyTimes" column="buy_times" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="canRedeem" column="can_redeem" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isRoll" column="is_roll" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="yearDayNum" column="year_day_num" javaType="int" jdbcType="INT" nullValue="0"/>        
        <result property="price" column="price" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="riskLevel" column="risk_level" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="riskMeasure" column="risk_measure" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="createUserId" column="create_user_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="createUserAccount" column="create_user_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="createUserName" column="create_user_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptId" column="dept_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="deptCode" column="dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptName" column="dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptPath" column="dept_path" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptPathName" column="dept_path_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="councilType" column="council_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="councilApplyId" column="council_apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="councilStatus" column="council_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>  
    </resultMap>
    
	<!-- 理财项目转让列表 -->
    <resultMap id="RM-FINANCIAL-PROJECT-TRANSFER-FORM" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FinancialProjectTransferFormDO">
        <result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="buyNum" column="buy_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="holdNum" column="hold_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="actualHoldNum" column="actual_hold_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="transferingNum" column="transfering_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="redeemingNum" column="redeeming_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="transferPrice" column="transfer_price" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT" nullValue="0"/>
        <result property="transferNum" column="transfer_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="transferReason" column="transfer_reason" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="transferTime" column="transfer_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="transferInterest" column="transfer_interest" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="transferTo" column="transfer_to" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="interestRate" column="interest_rate" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="isTransferOwnership" column="is_transfer_ownership" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isBuyBack" column="is_buy_back" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="buyBackPrice" column="buy_back_price" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="buyBackTime" column="buy_back_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="councilType" column="council_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="councilApplyId" column="council_apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="councilStatus" column="council_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>
	
	<!-- 理财项目赎回列表 -->
    <resultMap id="RM-FINANCIAL-PROJECT-REDEEM-FORM" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FinancialProjectRedeemFormDO">
        <result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="buyNum" column="buy_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="holdNum" column="hold_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="actualHoldNum" column="actual_hold_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="transferingNum" column="transfering_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="redeemingNum" column="redeeming_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="redeemPrice" column="redeem_price" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="redeemNum" column="redeem_num" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="redeemTime" column="redeem_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="redeemPrincipal" column="redeem_principal" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="redeemInterest" column="redeem_interest" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="redeemReason" column="redeem_reason" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

	<!-- 合同列表 -->
	<resultMap id="RM-PROJECT-CONTRACT-PROJECT"  extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.ProjectContractFormDO">
		<!--<result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
		<result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<!--<result property="formUserId" column="user_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
		<!--<result property="formStatus" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
		<result property="contractId" column="contract_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="contractCode" column="contract_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractCode2" column="contract_code2" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="contractName" column="contract_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractType" column="contract_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="contractStatus" column="contract_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="creditMeasure" column="credit_measure" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="creditMeasure" column="credit_measure" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="cnt" column="cnt" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isMain" column="is_main" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="basisOfDecision" column="basis_of_decision" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="letterType" column="letter_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractScanUrl" column="contract_scan_url" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="freeFlow" column="free_flow" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="fileUrl" column="file_url" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="courtRulingUrl" column="court_ruling_url" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectCourtRuling" column="project_court_ruling" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="signedTime" column="signed_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="loannedAmount" column="loaned_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
		<result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="num" column="num" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="isNeedStamp" column="is_need_stamp" javaType="java.lang.String" jdbcType="VARCHAR"/>
	</resultMap>
    <!-- 合同作废列表 -->
    <resultMap id="RM-PROJECT-CONTRACT-INVALID"  extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.ProjectContractFormDO">
        <result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractCode" column="contract_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractName" column="contract_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

	<!-- 承销与发债 发售信息维护 -->
	<resultMap id="RM-ISSUE-INFORMATION-PROJECT" extends="RM-PROJECT" class="com.born.fcs.pm.dal.dataobject.ProjectIssueInformationDO">
	</resultMap>
	<!-- 同意发行方通知书 选择项目查询 -->
	<resultMap id="RM-CONSENT-ISSUE-NOTICE-SEARCH-PROJECT" extends="RM-PROJECT" class="com.born.fcs.pm.dal.dataobject.ConsentIssueNoticeDO">
	</resultMap>
	<!--同意发行方通知书  -->
	<resultMap id="RM-CONSENT-ISSUE-NOTICE-PROJECT" extends="RM-PROJECT" class="com.born.fcs.pm.dal.dataobject.ConsentIssueNoticeDO">
		<result property="noticeId" column="notice_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="customerType" column="customer_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="busiManagerId" column="busi_manager_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerAccount" column="busi_manager_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isUploadReceipt" column="is_upload_receipt" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiptAttachment" column="receipt_attachment" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="yourCooperationCompany" column="your_cooperation_company" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="yourCooperationAttachment" column="your_cooperation_attachment" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="myCooperationCompany" column="my_cooperation_company" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="myCooperationAttachment" column="my_cooperation_attachment" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="myCooperationContractNo" column="my_cooperation_contract_no" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	</resultMap>
	 <!-- 授信条件落实情况列表  表单-->
    <resultMap id="RM-FORM-CREDIT-CONDITION-PROJECT" extends="RM-EXTRA-SIMPLE-FORM-PROJECT" class="com.born.fcs.pm.dal.dataobject.FCreditConditionConfirmDO">
    	<result property="busiManagerbId" column="busi_managerb_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
    	<result property="confirmId" column="confirm_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>  
    	<result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="contractNo" column="contract_no" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="institutionId" column="institution_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="institutionName" column="institution_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
         <result property="isMargin" column="is_margin" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	</resultMap>
	<!--授信条件落实情况列表  实体  -->
	<resultMap id="RM-CREDIT-CONDITION-PROJECT" extends="RM-PROJECT" class="com.born.fcs.pm.dataobject.ProjectCreditConditionFormDO">
	</resultMap>
	<!-- 常用数据库字段 -->
	<resultMap id="RM-DB-FIELD" class="com.born.fcs.pm.dataobject.DbFieldProjectDO">
		<result property="fieldId" column="field_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="tableId" column="table_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
		<result property="tableName" column="table_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectPhase" column="project_phase" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="fieldName" column="field_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="tableForShort" column="table_for_short" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="fieldForShort" column="field_for_short" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="remark" column="remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	</resultMap>

	<!-- 档案出入库列表 -->
	<resultMap id="RM-FILE-FORM-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FileFormDO">
		<!-- form -->
		<!--<result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
		<!--<result property="formCode" column="form_code" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
		<!--<result property="formStatus" column="form_status" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
		<result property="fileCode" column="file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="oldFileCode" column="old_file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="status" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="applyType" column="apply_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<!--<result property="fileName" column="file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
        <result property="type" column="type" javaType="java.lang.String" jdbcType="VARCHAR"/>
		<result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	</resultMap>

    <!-- 展期列表 -->
    <resultMap id="RM-FILE-EXTENSION-FORM-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FileExtensionFormDO">
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="reason" column="reason" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="extensionDate" column="extension_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!-- 档案出入库历史 -->
    <resultMap id="RM-FILE-IN-OUT-FORM-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FileInOutFormDO">
        <result property="applyType" column="apply_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="statusUpdateTime" column="status_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!-- 档案明细列表 -->
    <resultMap id="RM-FILE-DETAIL-FORM-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FileFormDO">
        <result property="fileId" column="file_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="inputListId" column="input_list_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="fileCode" column="file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="status" column="file_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="fileName" column="file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rightVoucherExtenDate" column="right_voucher_exten_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="isInExtenDate" column="is_in_exten_date" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="filePath" column="file_path" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="type" column="type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="no" column="no" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rnum" column="rnum" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="currBorrowManId" column="curr_borrow_man_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="archiveFileName" column="archive_file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- 档案一览表 -->
    <resultMap id="RM-FILE-PROJECT-VIEW"  class="com.born.fcs.pm.dataobject.FileViewDO">
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="updateTime" column="update_time" javaType="java.util.Date" jdbcType="DATETIME"/>
    </resultMap>

    <!-- 档案需要发消息列表 -->
    <resultMap id="RM-NEED-MESSAGE-FILE"  class="com.born.fcs.pm.dataobject.FileFormDO">
        <result property="fileCode" column="file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="expectReturnTime" column="expect_return_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="handOverManId" column="hand_over_man_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="handOverMan" column="hand_over_man" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiveManId" column="receive_man_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="receiveMan" column="receive_man" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- 需要提醒归档的项目 -->
    <resultMap id="RM-FILE-NEED-MESSAGE-PROJECT" extends="RM-PROJECT" class="com.born.fcs.pm.dataobject.FileNeedSendMessageProjectDO">
        <result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="submitTime" column="submit_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="actualLoanTime" column="actual_loan_time" javaType="java.util.Date" jdbcType="DATETIME"/>
    </resultMap>

    <!-- 没有归档且不在本张单子里的档案明细 -->
    <resultMap id="RM-FILE-NOT-ARCHIVE" class="com.born.fcs.pm.dataobject.FileNotArchiveDO">
        <result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="fileId" column="file_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="fileType" column="file_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="fileName" column="file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="archiveFileName" column="archive_file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="filePage" column="file_page" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="filePath" column="file_path" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="inputRemark" column="input_remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiveTime" column="receive_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="type" column="type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isArchive" column="is_archive" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="parentId" column="parent_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="sortOrder" column="sort_order" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>
    <!-- 已经档案明细 -->
    <resultMap id="RM-FILE-ARCHIVED" class="com.born.fcs.pm.dataobject.FFileInputListDO">
        <result property="inputListId" column="input_list_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="fileId" column="file_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="fileType" column="file_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="fileName" column="file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="archiveFileName" column="archive_file_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="filePage" column="file_page" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="filePath" column="file_path" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="inputRemark" column="input_remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="sortOrder" column="sort_order" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="status" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formStatus" column="form_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="fileCode" column="file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="no" column="no" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="attachType" column="attach_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!-- 收费通知 -->
    <resultMap id="RM-CHARGE-NOTIFICATION-FORM" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.ChargeNotificationFormDO">
        <!--<result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
        <!--<result property="formUserId" column="user_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>-->
        <!--<result property="formStatus" column="form_status" javaType="java.lang.String" jdbcType="VARCHAR"/>-->
        <result property="notificationId" column="notification_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="submitManName" column="submit_man_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="chargeAmount" column="charge_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="actualAmount" column="actual_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="submitManName" column="submit_man_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="chargeBasis" column="charge_basis" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- 收费通知导出 -->
    <resultMap id="RM-CHARGE-NOTIFICATION-EXPORT"  class="com.born.fcs.pm.dataobject.ChargeNotificationExportDO">
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="chargeAmount" column="charge_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="chargeBasis" column="charge_basis" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="timeLimit" column="time_limit" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="timeUnit" column="time_unit" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="startTime" column="start_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="endTime" column="end_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="amount" column="amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="loanedAmount" column="loaned_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="releasableAmount" column="releasable_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="releasedAmount" column="released_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="compPrincipalAmount" column="comp_principal_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="contractCode" column="contract_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractName" column="contract_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contractAmount" column="contract_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="payTime" column="pay_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="feeTypeDesc" column="fee_type_desc" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="chargeBase" column="charge_base" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="chargeAmount" column="charge_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="actualAmount" column="actual_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="chargeRate" column="charge_rate" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="chargeName" column="charge_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="chargeFee" column="charge_fee" javaType="double" jdbcType="DECIMAL" nullValue="0"/>
        <result property="chargeType" column="charge_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="institutionName" column="institution_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- 特殊纸 -->
    <resultMap id="RM-SPECIAL-PAPER"  class="com.born.fcs.pm.dataobject.SpecialPaperResultDO">
        <result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="startNo" column="start_no" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="endNo" column="end_no" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="specialNo" column="special_no" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="pieces" column="pieces" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiveManName" column="receive_man_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="keepingManName" column="keeping_man_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="provideManName" column="provide_man_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiptPlace" column="receipt_place" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiptMan" column="receipt_man" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="profiles" column="profiles" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptName" column="dept_name" javaType="java.lang.String" jdbcType="VARCHAR" />
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="recevieDate" column="receive_date" javaType="java.util.Date" jdbcType="DATETIME"/>
    </resultMap>

	<!-- 资金划付申请 -->
    <resultMap id="RM-CAPITAL-APPROPRIATION-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.CapitalAppropriationApplyFormDO"> 
    	<!-- <result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formUserId" column="user_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formStatus" column="form_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="formUserName" column="user_name" javaType="java.lang.String" jdbcType="VARCHAR"/> -->
        <result property="outBizNo" column="out_biz_no" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/> 
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectType" column="project_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="appropriateAmount" column="appropriate_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="attach" column="attach" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isReceipt" column="is_receipt" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="isSimple" column="is_simple" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	</resultMap>
	<!-- 保后项目汇总  -->
    <resultMap id="RM-AFTERWARDS-PROJECT-SUMMARY" class="com.born.fcs.pm.dataobject.AfterwardsSummaryReleasingAmountDO">
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="loanedAmount" column="loaned_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/> 
        <result property="applyAmount" column="apply_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>   
    	<result property="finishTime" column="finish_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    	<result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
    	 <result property="deptId" column="dept_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="deptName" column="dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptCode" column="dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
    </resultMap>
	
	<!-- 复议申请 -->
    <resultMap id="RM-RECOUNCIL-APPLY-FORM" extends="RM-EXTRA-SIMPLE-FORM-PROJECT" class="com.born.fcs.pm.dataobject.ReCouncilApplyFormDO"> 
        <result property="oldSpId" column="old_sp_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="oldSpCode" column="old_sp_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectStatus" column="project_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="contentReason" column="content_reason" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="overview" column="overview" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="councilApplyId" column="council_apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="councilBack" column="council_back" javaType="java.lang.String" jdbcType="VARCHAR"/>        
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
       	<result property="investigateId" column="investigate_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
       	<result property="investigateFormId" column="investigate_form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
       	<result property="investigateReview" column="investigate_review" javaType="java.lang.String" jdbcType="VARCHAR"/>        
	</resultMap>
	
	<!-- 退费申请 -->
    <resultMap id="RM-REFUND-APPLICATION-PROJECT" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dal.dataobject.FRefundApplicationDO">
    	<result property="refundId" column="refund_id" javaType="long" jdbcType="BIGINT" nullValue="0"/> 
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="refundAmount" column="refund_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="attach" column="attach" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
	</resultMap>
	
    <resultMap id="RM-PROJECT-ISSUE-INFORMATION-SIMPLE" class="com.born.fcs.pm.dal.dataobject.ProjectIssueInformationDO">
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="amount" column="amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="actualAmount" column="actual_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
    </resultMap>
    
    <!-- 项目签报 -->
    <resultMap id="RM-FORM-CHANGE-APPLY" extends="RM-EXTRA-SIMPLE-FORM" class="com.born.fcs.pm.dataobject.FormChangeApplySearchDO">
        <result property="applyId" column="apply_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="applyCode" column="apply_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="applyType" column="apply_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="applyTitle" column="apply_title" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerType" column="customer_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiType" column="busi_type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiTypeName" column="busi_type_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="changeForm" column="change_form" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="changeFormId" column="change_form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="changeRemark" column="change_remark" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="isNeedCouncil" column="is_need_council" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="status" column="apply_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="chargedAmount" column="charged_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>     	
    </resultMap>
    
    <!-- result maps for database table f_afterwards_check -->
    <resultMap id="RM-AFTERWARDS-CHECK" class="com.born.fcs.pm.dal.dataobject.FAfterwardsCheckDO">
        <result property="id" column="id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="checkDate" column="check_date" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="checkAddress" column="check_address" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="edition" column="edition" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="roundYear" column="round_year" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="roundTime" column="round_time" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="isLastest" column="is_lastest" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="amount" column="amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="usedAmount" column="used_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="repayedAmount" column="repayed_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="useWay" column="use_way" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>  
    
    <resultMap id="EX-F-FILE" class="com.born.fcs.pm.dal.dataobject.FFileDO">
        <result property="fileId" column="file_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="fileCode" column="file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="oldFileCode" column="old_file_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="type" column="type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectCode" column="project_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="projectName" column="project_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="customerId" column="customer_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="customerName" column="customer_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="busiManagerId" column="busi_manager_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="busiManagerName" column="busi_manager_name" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="firstLoanTime" column="first_loan_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="filingTime" column="filing_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="handOverDeptCode" column="hand_over_dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="handOverDept" column="hand_over_dept" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="handOverManId" column="hand_over_man_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="handOverMan" column="hand_over_man" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="handOverTime" column="hand_over_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="principalMan" column="principal_man" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="viceManager" column="vice_manager" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiveDeptCode" column="receive_dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiveDept" column="receive_dept" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiveManId" column="receive_man_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="receiveMan" column="receive_man" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="receiveTime" column="receive_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="status" column="status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="fileCheckStatus" column="file_check_status" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptCode" column="dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptName" column="dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="updateTime" column="update_time" javaType="java.util.Date" jdbcType="DATETIME"/>
        <result property="remark" column="remark" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!-- mapped statement for IbatisExtraDAO.getSysdate -->
    <select id="MS-COMMON-GET-SYSDATE" resultClass="java.util.Date">
        <![CDATA[
			select current_timestamp from dual
		]]>
    </select>

    <insert id="MS-EXTRA-SYS-DATE-SEQ-INSERT">
        <![CDATA[
	        insert into sys_date_seq(name,seq_date,max_number,raw_add_time) values (#name#,#seqDate#,LAST_INSERT_ID(1),#rawAddTime#)
	    ]]>
        <selectKey resultClass="long" keyProperty="id">
            <![CDATA[SELECT LAST_INSERT_ID() AS ID ]]>
        </selectKey>
    </insert>
    <insert id="MS-EXTRA-SYS-DATE-SEQ-UPDATE">
        <![CDATA[
	        update sys_date_seq set max_number=LAST_INSERT_ID(max_number+#cacheNumber#) where name=#name# and seq_date=#seqDate#
	    ]]>

        <selectKey resultClass="long" keyProperty="id">
            <![CDATA[SELECT LAST_INSERT_ID() AS ID ]]>
        </selectKey>
    </insert>
    <select id="MS-EXTRA-SYS-DATE-SEQ-SELECT" resultClass="long" parameterClass="java.util.Map">
        <![CDATA[
	        SELECT max_number from sys_date_seq where name=#name# and seq_date=#seqDate#
	    ]]>
    </select>
    
	<!-- 表单部分通用SQl -->
    <sql id="formCommonSql">
    	f.form_id, f.form_code, f.form_name,f.form_url,f.act_inst_id,f.run_id,f.def_id,f.act_def_id,f.task_id,f.detail_status,f.status, f.user_id, f.user_account,f.user_name, f.dept_id form_dept_id, f.dept_name form_dept_name,f.dept_code form_dept_code,f.dept_path form_dept_path,f.dept_path_name form_dept_path_name,f.check_status, f.submit_time, f.finish_time, f.raw_add_time form_add_time, f.raw_update_time form_update_time,f.related_project_code,f.task_user_data,f.remark,f.trace
    </sql>
    
    <!-- 项目信息通用 -->
    <sql id="projectCommonSql">
    	p.project_id,p.project_code,p.project_name, p.customer_id, p.customer_name, p.customer_type,p.time_limit,p.time_unit,p.busi_type,p.busi_type_name,p.amount,p.busi_manager_id, p.busi_manager_name, p.busi_managerb_id, p.busi_managerb_name, p.dept_id project_dept_id, p.dept_name project_dept_name,p.dept_code project_dept_code,p.dept_path project_dept_path,p.dept_path_name project_dept_path_name,p.raw_add_time project_add_time, p.raw_update_time project_update_time
    </sql> 
    <!-- 简单项目信息 -->
    <sql id="projectCommonSimpleSql">
    	p.project_code,p.project_name, p.customer_id, p.customer_name, p.customer_type,p.time_limit,p.time_unit,p.busi_type,p.busi_type_name,p.amount, p.status project_status
    </sql> 
    
    <!-- 项目权限通用sql -->
    <sql id="projectPermissionSql">
	      <isNotEmpty property="deptIdList">
	            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
	            	   WHERE is_del = 'NO' AND 
	            	   		(dept_id in 
	            	   		<iterate property="deptIdList" open="(" close=")" conjunction=",">
								#deptIdList[]#
							</iterate>
					 		<isGreaterThan property="loginUserId"  compareValue="0" prepend=" OR ">
			            	    (user_id = #loginUserId# 
						      	<isNotEmpty property="relatedRoleList" prepend=" and ">
						      		user_type in 
			            	   		<iterate property="relatedRoleList" open="(" close=")" conjunction=",">
										#relatedRoleList[]#
									</iterate>
						      	</isNotEmpty>)  	            	   
						    </isGreaterThan>)
					   GROUP BY project_code) rl
    			  ON rl.project_code = p.project_code AND rl.rnum > 0
	      </isNotEmpty>
	      <isEmpty property="deptIdList">    
	 		  <isGreaterThan property="loginUserId"  compareValue="0">
		            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user 
		            	   WHERE user_id = #loginUserId# AND is_del = 'NO'
					      	<isNotEmpty property="relatedRoleList" prepend=" and ">
					      		user_type in 
		            	   		<iterate property="relatedRoleList" open="(" close=")" conjunction=",">
									#relatedRoleList[]#
								</iterate>
					      	</isNotEmpty>  	            	   
		            	   GROUP BY project_code) rl
	    			  ON rl.project_code = p.project_code AND rl.rnum > 0
		      </isGreaterThan>
	      </isEmpty>   	
          <isGreaterThan property="busiManagerId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user 
            	   WHERE user_id = #busiManagerId# AND user_type = 'BUSI_MANAGER' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r1
   			  ON r1.project_code = p.project_code AND r1.rnum > 0
      	  </isGreaterThan>
          <isGreaterThan property="busiManagerbId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user 
            	   WHERE user_id = #busiManagerbId# AND user_type = 'BUSI_MANAGERB' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r2
   			  ON r2.project_code = p.project_code AND r2.rnum > 0
      	  </isGreaterThan>	           
    </sql>
    
    <!-- 表单权限通用sql -->
    <sql id="formPermissionSql">
	    <isNotEmpty property="deptIdList">
            JOIN (SELECT COUNT(*) rnum,form_id FROM form_related_user
            	   WHERE dept_id in 
            	   		<iterate property="deptIdList" open="(" close=")" conjunction=",">
							#deptIdList[]#
						</iterate>
						<isGreaterThan property="loginUserId"  compareValue="0" prepend=" OR ">
							user_id = #loginUserId#
						</isGreaterThan>
				   GROUP BY form_id) rl
   			  ON rl.form_id = f.form_id AND rl.rnum > 0
	    </isNotEmpty>     
    	<isEmpty property="deptIdList">
 		  <isGreaterThan property="loginUserId"  compareValue="0">
	            JOIN (SELECT COUNT(*) rnum,form_id FROM form_related_user 
	            	   WHERE user_id = #loginUserId# GROUP BY form_id) rl
    			  ON rl.form_id = f.form_id AND rl.rnum > 0
	      </isGreaterThan>
	    </isEmpty>    	
    </sql>    
    
    <!-- 立项项目列表 -->
    <select id="MS-EXTRA-FORM-F-PROJECT-SEARCH" resultMap="RM-SETUP-FORM-F-PROJECT">
 		SELECT <include refid="formCommonSql"/>,
 			   p.project_id,p.project_code,p.project_name,p.time_limit,p.time_unit,p.busi_type,p.busi_type_name,p.amount,p.busi_manager_id, p.busi_manager_name, p.busi_managerb_id, p.busi_managerb_name, p.dept_id project_dept_id, p.dept_name project_dept_name,p.dept_code project_dept_code,p.dept_path project_dept_path,p.dept_path_name project_dept_path_name,p.raw_add_time project_add_time, p.raw_update_time project_update_time,p1.status project_status,
 			   c.customer_id, c.customer_name,c.customer_type,
 			   c.true_customer_id, c.true_customer_name,c.true_customer_type,
 			   i.investigate_id,i.form_id investigate_form_id
 		  FROM form f 
 		  LEFT JOIN f_project p ON f.form_id = p.form_id 
 		  LEFT JOIN project p1 on p.project_code = p1.project_code
 		  LEFT JOIN f_project_customer_base_info c on f.form_id = c.form_id
		  LEFT JOIN (SELECT
					  fi.project_code,
					  fi.investigate_id,
					  fi.form_id
					FROM f_investigation fi
					  JOIN (SELECT
					      MAX(fi.investigate_id) investigate_id,
					      fi.project_code
					    FROM f_investigation fi
					      JOIN form f
					        ON fi.form_id = f.form_id
					    WHERE f.status != 'DELETED'
					    GROUP BY fi.project_code) i
					    ON fi.investigate_id = i.investigate_id) i ON i.project_code = p.project_code
		 <include refid="projectPermissionSql"/>
		 WHERE 
		 	f.form_code like 'SET_UP%' AND f.form_code != 'SET_UP_FINANCING' 
		 	AND f.status != 'DELETED' 
		 	<isGreaterThan property="draftUserId"  compareValue="0" prepend=" AND ">
		 		 (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		 	</isGreaterThan>
 	        <dynamic>
	            <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
	                f.form_id = #formId#
	            </isGreaterThan>
	            <isGreaterThan property="projectId"  compareValue="0" prepend=" and ">
	                p.project_id = #projectId#
	            </isGreaterThan>
	            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
	                c.customer_id = #customerId#
	            </isGreaterThan>
	            <isGreaterThan property="trueCustomerId"  compareValue="0" prepend=" and ">
	                c.true_customer_id = #trueCustomerId#
	            </isGreaterThan>
	             <isNotEmpty property="formStatus" prepend=" and ">
	             	<isEqual property="formStatus" compareValue="fromCopy">
	             	    f.status not in ('DRAFT','DELETED')
	             	</isEqual>
	             	<isNotEqual property="formStatus" compareValue="fromCopy">
	             		f.status = #formStatus#
	             	</isNotEqual>
	            </isNotEmpty>
	             <isNotEmpty property="projectCode" prepend=" and ">
	               	p.project_code = #projectCode#
	            </isNotEmpty>
	             <isNotEmpty property="likeProjectCode" prepend=" and ">
	               	p.project_code like concat('%',#likeProjectCode#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type like concat(#busiType#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="projectName" prepend=" and ">
	               	p.project_name like concat('%',#projectName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="customerName" prepend=" and ">
	               	c.customer_name like concat('%',#customerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="trueCustomerName" prepend=" and ">
	               	c.true_customer_name like concat('%',#trueCustomerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerName" prepend=" and ">
	               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerbName" prepend=" and ">
	               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeStart" prepend=" and ">
	                <![CDATA[f.raw_add_time >= #submitTimeStart# ]]>
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeEnd" prepend=" and ">
	                <![CDATA[f.raw_add_time <= #submitTimeEnd# ]]>
	            </isNotEmpty>
	            <isNotEmpty property="busiTypeList" prepend=" and ">
					<iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
						p.busi_type like concat(#busiTypeList[]#,'%')
					</iterate>
				</isNotEmpty>	            
	        </dynamic>
	         <isNotEmpty property="sortCol" prepend=" order by ">
	             $sortCol$
	                <isNotEmpty property="sortOrder">
              	 		$sortOrder$
             		</isNotEmpty>
	         </isNotEmpty>
            LIMIT #limitStart#,#pageSize#;
    </select>
    
    <!-- 立项项目列 统计-->
    <select id="MS-EXTRA-FORM-F-PROJECT-SEARCH-COUNT" resultClass="long">
  		SELECT count(*) 
 		  FROM form f 
 		  LEFT JOIN f_project p ON f.form_id = p.form_id 
 		  LEFT JOIN f_project_customer_base_info c on f.form_id = c.form_id
		  LEFT JOIN (SELECT
					  fi.project_code,
					  fi.investigate_id,
					  fi.form_id
					FROM f_investigation fi
					  JOIN (SELECT
					      MAX(fi.investigate_id) investigate_id,
					      fi.project_code
					    FROM f_investigation fi
					      JOIN form f
					        ON fi.form_id = f.form_id
					    WHERE f.status != 'DELETED'
					    GROUP BY fi.project_code) i
					    ON fi.investigate_id = i.investigate_id) i ON i.project_code = p.project_code
 		  <include refid="projectPermissionSql"/>      		  
		 WHERE f.form_code like 'SET_UP%' AND f.form_code != 'SET_UP_FINANCING' 
		 	AND f.status != 'DELETED' 
		 	<isGreaterThan property="draftUserId"  compareValue="0" prepend=" AND ">
		 		 (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		 	</isGreaterThan>
 	        <dynamic>
	            <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
	                f.form_id = #formId#
	            </isGreaterThan>
	            <isGreaterThan property="projectId"  compareValue="0" prepend=" and ">
	                p.project_id = #projectId#
	            </isGreaterThan>
	            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
	                c.customer_id = #customerId#
	            </isGreaterThan>
	            <isGreaterThan property="trueCustomerId"  compareValue="0" prepend=" and ">
	                c.true_customer_id = #trueCustomerId#
	            </isGreaterThan>	            
	             <isNotEmpty property="projectCode" prepend=" and ">
	               	p.project_code = #projectCode#
	            </isNotEmpty>
	             <isNotEmpty property="likeProjectCode" prepend=" and ">
	               	p.project_code like concat('%',#likeProjectCode#,'%')
	            </isNotEmpty>	            
	             <isNotEmpty property="formStatus" prepend=" and ">
	             	<isEqual property="formStatus" compareValue="fromCopy">
	             	    f.status not in ('DRAFT','DELETED')
	             	</isEqual>
	             	<isNotEqual property="formStatus" compareValue="fromCopy">
	             		f.status = #formStatus#
	             	</isNotEqual>
	            </isNotEmpty>            
	             <isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type like concat(#busiType#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="projectName" prepend=" and ">
	               	p.project_name like concat('%',#projectName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="customerName" prepend=" and ">
	               	c.customer_name like concat('%',#customerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="trueCustomerName" prepend=" and ">
	               	c.true_customer_name like concat('%',#trueCustomerName#,'%')
	            </isNotEmpty>	            
	             <isNotEmpty property="busiManagerName" prepend=" and ">
	               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerbName" prepend=" and ">
	               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeStart" prepend=" and ">
	                <![CDATA[f.raw_add_time >= #submitTimeStart# ]]>
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeEnd" prepend=" and ">
	                <![CDATA[f.raw_add_time <= #submitTimeEnd# ]]>
	            </isNotEmpty>
	            <isNotEmpty property="busiTypeList" prepend=" and ">
					<iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
						p.busi_type like concat(#busiTypeList[]#,'%')
					</iterate>
				</isNotEmpty>	            
	        </dynamic>
    </select>
	
	<!-- 风险审查列表 -->
    <select id="MS-EXTRA-RISK_REVIEW-F-PROJECT-SEARCH" resultMap="RM-RISK-REVIEW-FORM-F-PROJECT">
 		SELECT <include refid="formCommonSql"/>,
 		 	   <include refid="projectCommonSql"/>, 
 			   c.raw_add_time  risk_review_add_time, c.id risk_review_id
 		 FROM form f
		  INNER JOIN f_risk_review_report c
		    ON f.form_id = c.form_id
		  INNER JOIN f_project p
		      ON p.project_code = c.project_code
 		  <include refid="projectPermissionSql"/>		      
		WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
 	        <dynamic>
	            <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
	                f.form_id = #formId#
	            </isGreaterThan>
	            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
	                c.customer_id = #customerId#
	            </isGreaterThan>
	            <isGreaterThan property="riskManagerId"  compareValue="0" prepend=" and ">
	                p.risk_manager_id = #riskManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
	             <isNotEmpty property="projectCode" prepend=" and ">
	               	p.project_code = #projectCode#
	            </isNotEmpty>
	             <isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	            </isNotEmpty>
	             <isNotEmpty property="loanType" prepend=" and ">
	               	p.loan_type = #loanType#
	            </isNotEmpty>
	             <isNotEmpty property="projectName" prepend=" and ">
	               	p.project_name like concat('%',#projectName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="customerName" prepend=" and ">
	               	c.customer_name like concat('%',#customerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="riskManagerName" prepend=" and ">
	               	p.risk_manager_name like concat('%',#riskManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerName" prepend=" and ">
	               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerbName" prepend=" and ">
	               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeStart" prepend=" and ">
	                <![CDATA[f.raw_add_time >= #submitTimeStart# ]]>
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeEnd" prepend=" and ">
	                <![CDATA[f.raw_add_time <= #submitTimeEnd# ]]>
	            </isNotEmpty>
	        </dynamic>
	         <isNotEmpty property="sortCol" prepend=" order by ">
	             $sortCol$
	                <isNotEmpty property="sortOrder">
              	 		$sortOrder$
             		</isNotEmpty>
	         </isNotEmpty>
           	<isGreaterThan property="pageSize" compareValue="0" prepend="">
				LIMIT #limitStart#,#pageSize#;
			</isGreaterThan>
    </select>
    
    <!-- 风险审查列表 统计-->
    <select id="MS-EXTRA-RISK_REVIEW-F-PROJECT-SEARCH-COUNT" resultClass="long">
 		SELECT count(*)  FROM form f
			  INNER JOIN f_risk_review_report c
			    ON f.form_id = c.form_id
			  INNER JOIN f_project p
 			  <include refid="projectPermissionSql"/>			  
			      ON p.project_code = c.project_code
			WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
                f.form_id = #formId#
            </isGreaterThan>
            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
                c.customer_id = #customerId#
            </isGreaterThan>
            <isGreaterThan property="riskManagerId"  compareValue="0" prepend=" and ">
                p.risk_manager_id = #riskManagerId#
            </isGreaterThan>
            <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
                p.busi_manager_id = #busiManagerId#
            </isGreaterThan>
            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
                p.busi_managerb_id = #busiManagerbId#
            </isGreaterThan>
             <isNotEmpty property="projectCode" prepend=" and ">
               	p.project_code = #projectCode#
            </isNotEmpty>
             <isNotEmpty property="busiType" prepend=" and ">
               	p.busi_type = #busiType#
            </isNotEmpty>
             <isNotEmpty property="loanType" prepend=" and ">
               	p.loan_type = #loanType#
            </isNotEmpty>
             <isNotEmpty property="projectName" prepend=" and ">
               	p.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
             <isNotEmpty property="customerName" prepend=" and ">
               	c.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
             <isNotEmpty property="riskManagerName" prepend=" and ">
               	p.risk_manager_name like concat('%',#riskManagerName#,'%')
            </isNotEmpty>
             <isNotEmpty property="busiManagerName" prepend=" and ">
               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
            </isNotEmpty>
             <isNotEmpty property="busiManagerbName" prepend=" and ">
               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
            </isNotEmpty>
             <isNotEmpty property="submitTimeStart" prepend=" and ">
                <![CDATA[f.raw_add_time >= #submitTimeStart# ]]>
            </isNotEmpty>
             <isNotEmpty property="submitTimeEnd" prepend=" and ">
                <![CDATA[f.raw_add_time <= #submitTimeEnd# ]]>
            </isNotEmpty>
           </dynamic> 
    </select>
    
 
	<!-- 项目调查列表 -->
    <select id="MS-EXTRA-FORM-PROJECT-INVESTIGATION-SEARCH" resultMap="RM-INVESTIGATION-FORM">
 		SELECT <include refid="formCommonSql"/>, 
 			   <include refid="projectCommonSql"/>, i.investigate_id,i.review,i.council_back, i.amount credit_amount, p.status AS project_status 
 		  FROM f_investigation i 
 		  LEFT JOIN form f ON f.form_id = i.form_id 
 		  INNER JOIN project p ON p.project_code = i.project_code 
 		  <include refid="projectPermissionSql"/> 
		 WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
                p.customer_id = #customerId#
            </isGreaterThan>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
				p.busi_type = #busiType#
			</isNotEmpty>
       		<isEqual property="bType" compareValue="UNDERWRITING" prepend=" and ">
       			p.busi_type like '5%' 
       		</isEqual>
       		<isEqual property="bType" compareValue="LITIGATION" prepend=" and ">
       			p.busi_type like '211%' 
       		</isEqual>
       		<isEqual property="bType" compareValue="BANK_FINANCING" prepend=" and ">
       			p.busi_type like '11%' 
       		</isEqual>
       		<isEqual property="bType" compareValue="GUARANTEE" prepend=" and ">
       			(p.busi_type not like '5%' and p.busi_type not like '211%') 
       		</isEqual>			
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>
			<isNotEmpty property="review" prepend=" and ">
				i.review = #review#
			</isNotEmpty>
			<isEmpty property="review" prepend=" and ">
				(i.review = 'YES' OR i.review = 'NO')
			</isEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
	        <isNotEmpty property="sortOrder">
		    	 $sortOrder$
	   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY i.investigate_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 项目调查列表统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-INVESTIGATION-COUNT" resultClass="long">
		SELECT count(*)
		FROM f_investigation i 
		LEFT JOIN form f ON f.form_id = i.form_id 
		INNER JOIN project p ON p.project_code = i.project_code 
		<include refid="projectPermissionSql"/> 
		WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)    
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
                p.customer_id = #customerId#
            </isGreaterThan>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
				p.busi_type = #busiType#
			</isNotEmpty>
       		<isEqual property="bType" compareValue="UNDERWRITING" prepend=" and ">
       			p.busi_type like '5%' 
       		</isEqual>
       		<isEqual property="bType" compareValue="LITIGATION" prepend=" and ">
       			p.busi_type like '211%' 
       		</isEqual>
       		<isEqual property="bType" compareValue="BANK_FINANCING" prepend=" and ">
       			p.busi_type like '11%' 
       		</isEqual>
       		<isEqual property="bType" compareValue="GUARANTEE" prepend=" and ">
       			(p.busi_type not like '5%' and p.busi_type not like '211%') 
       		</isEqual>
			<isNotEmpty property="busiType" prepend=" and ">
				p.busi_type = #busiType#
			</isNotEmpty>			
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>			
			<isNotEmpty property="review" prepend=" and ">
				i.review = #review#
			</isNotEmpty>
			<isEmpty property="review" prepend=" and ">
				(i.review = 'YES' OR i.review = 'NO')
			</isEmpty>			
		</dynamic>
	</select>  
	

	  
	<!-- 风险审查报告列表 -->
    <select id="MS-EXTRA-FORM-PROJECT-RISK-REPORT-SEARCH" resultMap="RM-FORM-F-PROJECT">
 		SELECT <include refid="formCommonSql"/>, 
 			   <include refid="projectCommonSql"/>
 		  FROM f_risk_review_report i LEFT JOIN form f ON f.form_id = i.form_id INNER JOIN project p ON p.project_code = i.project_code 
 		  <include refid="projectPermissionSql"/> 
		 WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY i.id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 风险审查报告统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-RISK-REPORT-COUNT" resultClass="long">
		SELECT count(*)
		FROM f_risk_review_report i LEFT JOIN form f ON f.form_id = i.form_id INNER JOIN project p ON p.project_code = i.project_code 
		<include refid="projectPermissionSql"/> 
		WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>			
		</dynamic>
	</select>    
	    	
    <!-- 项目投票详情  -->
    <select id="MS-EXTRA-COUNCIL-VOTE-PROJECT-SEARCH" resultMap="RM-COUNCIL-VOTE-PROJECT">
 		 		SELECT c.id council_project_id, c.project_code,c.project_name,p.*,c.council_id,c.council_code,c.project_vote_result,c.risk_secretary_quit,c.risk_secretary_quit_mark, 
	c.judges_count,c.pass_count,c.notpass_count,a.form_id , c.one_vote_down , c.one_vote_down_mark,
	c.quit_count,v.id ,v.vote_status,v.vote_result, v.judge_id , c.compere_message 
		 	  FROM council_projects c
		LEFT JOIN project p ON p.project_code = c.project_code
		 <dynamic>
		<isGreaterThan property="judgeId"  compareValue="0" prepend=" inner ">
	                join  
	            </isGreaterThan>
	            
	      <isLessEqual property="judgeId"  compareValue="0" prepend=" left ">
	                join  
	       </isLessEqual>
		   council_project_vote v ON c.council_id = v.council_id AND  c.project_code = v.project_code
		 and   v.judge_id =  #judgeId# 
		 LEFT JOIN council_apply a ON c.apply_id = a.apply_id 
		 
			WHERE 1=1
	            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
	                p.customer_id = #customerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
	            
	           <!--   <isGreaterThan property="judgeId"  compareValue="0" prepend=" and ">
	                v.judge_id =  #judgeId#
	            </isGreaterThan>
	             -->
	             <isNotEmpty property="projectCode" prepend=" and ">
	               	c.project_code = #projectCode#
	            </isNotEmpty>
	             <isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	            </isNotEmpty>
	             <isNotEmpty property="projectName" prepend=" and ">
	               	p.project_name like concat('%',#projectName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="customerName" prepend=" and ">
	               	p.customer_name like concat('%',#customerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerName" prepend=" and ">
	               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerbName" prepend=" and ">
	               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
	            </isNotEmpty>
	            <isGreaterThan property="id"  compareValue="0" prepend=" and ">
	                c.id = #id#
	            </isGreaterThan>
	            <isGreaterThan property="councilId"  compareValue="0" prepend=" and ">
	                c.council_id = #councilId#
	            </isGreaterThan>
	            <isNotEmpty property="councilCode" prepend=" and ">
	               	c.council_code like concat('%',#councilCode#,'%')
	            </isNotEmpty>
	        </dynamic>
	         <isNotEmpty property="sortCol" prepend=" order by ">
	             $sortCol$
	                <isNotEmpty property="sortOrder">
              	 		$sortOrder$
             		</isNotEmpty>
	         </isNotEmpty>
           	<isGreaterThan property="pageSize" compareValue="0" prepend="">
				LIMIT #limitStart#,#pageSize#;
			</isGreaterThan>
    </select>
    
     <!-- 项目投票详情  统计-->
    <select id="MS-EXTRA-COUNCIL-VOTE-PROJECT-SEARCH-COUNT" resultClass="long">
 			SELECT count(*)
		 	  FROM council_projects c
		LEFT JOIN project p ON p.project_code = c.project_code 
		LEFT JOIN council_apply a ON c.apply_id = a.apply_id 
		  <dynamic>
		 <isGreaterThan property="judgeId"  compareValue="0" prepend=" inner ">
	            join  
	     </isGreaterThan>
	      <isLessEqual property="judgeId"  compareValue="0" prepend=" left ">
	            join  
	      </isLessEqual>
		 council_project_vote v ON c.council_id = v.council_id AND  c.project_code = v.project_code
		 and   v.judge_id =  #judgeId# 
      WHERE 1=1
              	<isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
	                p.customer_id = #customerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
	            
	            <!-- 
	             <isGreaterThan property="judgeId"  compareValue="0" prepend=" and ">
	                v.judge_id =  #judgeId#
	            </isGreaterThan>
	             -->
	             <isNotEmpty property="projectCode" prepend=" and ">
	               	c.project_code = #projectCode#
	            </isNotEmpty>
	             <isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	            </isNotEmpty>
	             <isNotEmpty property="projectName" prepend=" and ">
	               	p.project_name like concat('%',#projectName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="customerName" prepend=" and ">
	               	p.customer_name like concat('%',#customerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerName" prepend=" and ">
	               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerbName" prepend=" and ">
	               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
	            </isNotEmpty>
	            <isGreaterThan property="id"  compareValue="0" prepend=" and ">
	                c.id = #id#
	            </isGreaterThan>
	            <isGreaterThan property="councilId"  compareValue="0" prepend=" and ">
	                c.council_id = #councilId#
	            </isGreaterThan>
	            <isNotEmpty property="councilCode" prepend=" and ">
	               	c.council_code like concat('%',#councilCode#,'%')
	            </isNotEmpty>
           </dynamic> 
    </select>

	<!-- 用印明细列表 -->
	<select id="MS-EXTRA-STAMP-APPLY-SEARCH" resultMap="RM-STAMP-APPLY-PROJECT">
		SELECT * from (
		SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
		fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,p.status as project_status,
        <include refid="formCommonSql"/>,"IS" as replace_form_status,
		fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,fsaf.source FROM f_stamp_apply_file fsaf LEFT JOIN f_stamp_apply fsa ON fsa.apply_id=fsaf.replace_apply_id
		LEFT JOIN  form f ON fsa.form_id =f.form_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
		WHERE  f.status="APPROVAL"
		UNION all
		SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
		fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,p.status as project_status,
        <include refid="formCommonSql"/>,f1.status as replace_form_status,
		fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.old_legal_chapter_num AS legal_chapter_num,
		fsaf.old_cachet_num AS cachet_num,fsaf.source
		FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
		LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
		LEFT JOIN f_stamp_apply fsa1 ON fsa1.apply_id=fsaf.replace_apply_id
		LEFT JOIN form f1 ON fsa1.form_id=f1.form_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
		WHERE 1=1 AND f.status="APPROVAL" AND f.form_code="STAMP_APPLY"
        <isNotEmpty property="isNeedChannelContract" prepend="  "> <!--查渠道合同-->
            <isEqual property="isNeedChannelContract" compareValue="IS" prepend="  ">
        UNION ALL
        SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
        fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,"" as project_status,
        <include refid="formCommonSql"/>,"IS" as replace_form_status,
        fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,fsaf.source FROM f_stamp_apply_file fsaf LEFT JOIN f_stamp_apply fsa ON fsa.apply_id=fsaf.replace_apply_id
        LEFT JOIN  form f ON fsa.form_id =f.form_id
        WHERE  f.status="APPROVAL" AND  fsa.project_code="-"
        UNION ALL
        SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
        fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,"" as project_status,
        <include refid="formCommonSql"/>,"IS" as replace_form_status,
        fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,fsaf.source
        FROM  f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
        LEFT JOIN f_stamp_apply fsa1 ON fsa1.apply_id=fsaf.replace_apply_id
        LEFT JOIN form f1 ON fsa1.form_id=f1.form_id
        WHERE 1=1 AND f.status="APPROVAL" AND f.form_code="STAMP_APPLY" AND fsa.project_code="-"
            </isEqual>
        </isNotEmpty>
		) A where 1=1
        <dynamic>
            <isNotEmpty property="customerName" prepend=" and ">
                A.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileCode" prepend=" and ">
                A.file_code like concat('%',#fileCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyCode" prepend=" and ">
                A.apply_code like concat('%',#applyCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                A.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileName" prepend=" and ">
                A.file_name like concat('%',#fileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                A.status = #status#
            </isNotEmpty>
            <isNotEmpty property="submitStatus" prepend=" and ">
                A.status = #submitStatus#
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[A.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[A.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
			$sortCol$
			<isNotEmpty property="sortOrder">
				$sortOrder$
			</isNotEmpty>
		</isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY A.raw_add_time desc
        </isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>

	<!-- 用印明细 统计-->
	<select id="MS-EXTRA-STAMP-APPLY-SEARCH-COUNT" resultClass="long">
        SELECT count(*) from (
        SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
        fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,p.status as project_status,
        <include refid="formCommonSql"/>,"IS" as replace_form_status,
        fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,fsaf.source FROM f_stamp_apply_file fsaf LEFT JOIN f_stamp_apply fsa ON fsa.apply_id=fsaf.replace_apply_id
        LEFT JOIN  form f ON fsa.form_id =f.form_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
        WHERE  f.status="APPROVAL"
        UNION all
        SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
        fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,p.status as project_status,
        <include refid="formCommonSql"/>,f1.status as replace_form_status,
        fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.old_legal_chapter_num AS legal_chapter_num,
        fsaf.old_cachet_num AS cachet_num,fsaf.source
        FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
        LEFT JOIN f_stamp_apply fsa1 ON fsa1.apply_id=fsaf.replace_apply_id
        LEFT JOIN form f1 ON fsa1.form_id=f1.form_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
        WHERE 1=1 AND f.status="APPROVAL" AND f.form_code="STAMP_APPLY"
        <isNotEmpty property="isNeedChannelContract" prepend="  "> <!--查渠道合同-->
            <isEqual property="isNeedChannelContract" compareValue="IS" prepend="  ">
                UNION ALL
                SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
                fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,"" as project_status,
                <include refid="formCommonSql"/>,"IS" as replace_form_status,
                fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,fsaf.source FROM f_stamp_apply_file fsaf LEFT JOIN f_stamp_apply fsa ON fsa.apply_id=fsaf.replace_apply_id
                LEFT JOIN  form f ON fsa.form_id =f.form_id
                WHERE  f.status="APPROVAL" AND  fsa.project_code="-"
                UNION ALL
                SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,
                fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,"" as project_status,
                <include refid="formCommonSql"/>,"IS" as replace_form_status,
                fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,"" AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,fsaf.source
                FROM  f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
                LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
                LEFT JOIN f_stamp_apply fsa1 ON fsa1.apply_id=fsaf.replace_apply_id
                LEFT JOIN form f1 ON fsa1.form_id=f1.form_id
                WHERE 1=1 AND f.status="APPROVAL" AND f.form_code="STAMP_APPLY" AND fsa.project_code="-"
            </isEqual>
        </isNotEmpty>
        ) A where 1=1
        <dynamic>
			<isNotEmpty property="customerName" prepend=" and ">
                A.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileCode" prepend=" and ">
                A.file_code like concat('%',#fileCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="applyCode" prepend=" and ">
                A.apply_code like concat('%',#applyCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileName" prepend=" and ">
                A.file_name like concat('%',#fileName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                A.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
                A.status = #status#
			</isNotEmpty>
			<isNotEmpty property="submitStatus" prepend=" and ">
                A.status = #submitStatus#
			</isNotEmpty>
			<isNotEmpty property="applyTimeStart" prepend=" and ">
				<![CDATA[A.raw_add_time >= #applyTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="applyTimeEnd" prepend=" and ">
				<![CDATA[A.raw_add_time <= #applyTimeEnd# ]]>
			</isNotEmpty>
		</dynamic>
		 ORDER BY A.raw_add_time desc

	</select>

	<!-- 用印台账列表 -->
	<select id="MS-EXTRA-STAMP-LEDGER-SEARCH" resultMap="RM-STAMP-APPLY-PROJECT">
		SELECT * FROM
        (SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,p.status as project_status,
        <include refid="formCommonSql"/>,"" as replace_form_status,
		fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,fsaf1.file_name AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,"" as source
		FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
		LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
		LEFT JOIN f_stamp_apply_file fsaf1 ON fsaf1.replace_apply_id=fsa.apply_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
		WHERE 1=1 AND f.status!="DRAFT" AND f.status!="CANCEL" AND f.status!="DELETED"
        <isNotEmpty property="isNeedChannelContract" prepend="  "> <!--查渠道合同-->
            <isEqual property="isNeedChannelContract" compareValue="IS" prepend="  ">
                UNION ALL
                SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,"" as project_status,
                <include refid="formCommonSql"/>,"" as replace_form_status,
                fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,fsaf1.file_name AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,"" as source
                FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
                LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
                LEFT JOIN f_stamp_apply_file fsaf1 ON fsaf1.replace_apply_id=fsa.apply_id
                WHERE 1=1 AND f.status!="DRAFT" AND f.status!="CANCEL" AND f.status!="DELETED" AND  fsa.project_code="-"
            </isEqual>
        </isNotEmpty>
        ) A where 1=1
		<dynamic>
			<isNotEmpty property="customerName" prepend=" and ">
				A.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileCode" prepend=" and ">
				A.file_code like concat('%',#fileCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="applyCode" prepend=" and ">
				A.apply_code like concat('%',#applyCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				A.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileName" prepend=" and ">
				(A.file_name like concat('%',#fileName#,'%') or A.replace_file_name like concat('%',#fileName#,'%'))
			</isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
                A.status = #status#
			</isNotEmpty>
			<isNotEmpty property="formCode" prepend=" and ">
                A.form_code = #formCode#
			</isNotEmpty>
			<isNotEmpty property="submitStatus" prepend=" and ">
                A.status = #submitStatus#
			</isNotEmpty>
			<isNotEmpty property="applyTimeStart" prepend=" and ">
				<![CDATA[A.raw_add_time >= #applyTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="applyTimeEnd" prepend=" and ">
				<![CDATA[A.raw_add_time <= #applyTimeEnd# ]]>
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		$sortCol$
		<isNotEmpty property="sortOrder">
		$sortOrder$
		</isNotEmpty>
		</isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY A.raw_add_time desc
        </isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>

	<!-- 用印台账 统计-->
	<select id="MS-EXTRA-STAMP-LEDGER-SEARCH-COUNT" resultClass="long">
        SELECT count(*) FROM
        (SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,p.status as project_status,
        <include refid="formCommonSql"/>,"" as replace_form_status,
        fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,fsaf1.file_name AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,"" as source
        FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
        LEFT JOIN f_stamp_apply_file fsaf1 ON fsaf1.replace_apply_id=fsa.apply_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
        WHERE 1=1 AND f.status!="DRAFT" AND f.status!="CANCEL" AND f.status!="DELETED"
        <isNotEmpty property="isNeedChannelContract" prepend="  "> <!--查渠道合同-->
            <isEqual property="isNeedChannelContract" compareValue="IS" prepend="  ">
                UNION ALL
                SELECT  fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,"" as project_status,
                <include refid="formCommonSql"/>,"" as replace_form_status,
                fsaf.id as file_id,fsaf.file_name,fsaf.contract_code,fsaf1.file_name AS replace_file_name,fsaf.legal_chapter_num,fsaf.cachet_num,"" as source
                FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
                LEFT JOIN f_stamp_apply_file fsaf ON fsa.apply_id=fsaf.apply_id
                LEFT JOIN f_stamp_apply_file fsaf1 ON fsaf1.replace_apply_id=fsa.apply_id
                WHERE 1=1 AND f.status!="DRAFT" AND f.status!="CANCEL" AND f.status!="DELETED" AND  fsa.project_code="-"
            </isEqual>
        </isNotEmpty>
        ) A where 1=1
		<dynamic>
			<isNotEmpty property="customerName" prepend=" and ">
				A.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileCode" prepend=" and ">
				A.file_code like concat('%',#fileCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="applyCode" prepend=" and ">
				A.apply_code like concat('%',#applyCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileName" prepend=" and ">
				(A.file_name like concat('%',#fileName#,'%') or A.replace_file_name like concat('%',#fileName#,'%'))
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                A.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
                A.status = #status#
			</isNotEmpty>
			<isNotEmpty property="formCode" prepend=" and ">
                A.form_code = #formCode#
			</isNotEmpty>
			<isNotEmpty property="submitStatus" prepend=" and ">
                A.status = #submitStatus#
			</isNotEmpty>
			<isNotEmpty property="applyTimeStart" prepend=" and ">
				<![CDATA[A.raw_add_time >= #applyTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="applyTimeEnd" prepend=" and ">
				<![CDATA[A.raw_add_time <= #applyTimeEnd# ]]>
			</isNotEmpty>
		</dynamic>
	</select>
	
	<!-- 用印申请列表 -->
	<select id="MS-EXTRA-STAMP-APPLY-FORM-SEARCH" resultMap="RM-STAMP-APPLY-PROJECT">
        SELECT * from (
		SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,fsaf.file_name,fsaf.contract_code,0 as legal_chapter_num,0 as cachet_num,p.status as project_status,
		0 as file_id,<include refid="formCommonSql"/>,"" as replace_form_status,"" AS replace_file_name,"" as source
		FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        JOIN (SELECT GROUP_CONCAT(file_name) AS file_name ,GROUP_CONCAT(contract_code) AS contract_code, apply_id FROM f_stamp_apply_file  GROUP BY apply_id) fsaf ON fsa.apply_id=fsaf.apply_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
		WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <isNotEmpty property="isNeedChannelContract" prepend="  "> <!--查渠道合同-->
            <isEqual property="isNeedChannelContract" compareValue="IS" prepend="  ">
        UNION ALL
        SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,fsaf.file_name,fsaf.contract_code,0 as legal_chapter_num,0 as cachet_num,"" as project_status,
        0 as file_id,<include refid="formCommonSql"/>,"" as replace_form_status,"" AS replace_file_name,"" as source
        FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        JOIN (SELECT GROUP_CONCAT(file_name) AS file_name ,GROUP_CONCAT(contract_code) AS contract_code, apply_id FROM f_stamp_apply_file  GROUP BY apply_id) fsaf ON fsa.apply_id=fsaf.apply_id
        WHERE 1=1 AND f.status!="DELETED" AND  fsa.project_code="-" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
            </isEqual>
        </isNotEmpty>
        ) A where 1=1
		<dynamic>
			<isNotEmpty property="customerName" prepend=" and ">
                A.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileCode" prepend=" and ">
                A.file_code like concat('%',#fileCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="applyCode" prepend=" and ">
                A.apply_code like concat('%',#applyCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                A.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
            <isNotEmpty property="fileName" prepend=" and ">
                A.file_name like concat('%',#fileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="contractCode" prepend=" and ">
                A.contract_code like concat('%',#contractCode#,'%')
            </isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
                A.status = #status#
			</isNotEmpty>
			<isNotEmpty property="formCode" prepend=" and ">
                A.form_code = #formCode#
			</isNotEmpty>
			<isNotEmpty property="submitStatus" prepend=" and ">
                A.status = #submitStatus#
			</isNotEmpty>
			<isNotEmpty property="applyTimeStart" prepend=" and ">
				<![CDATA[A.raw_add_time >= #applyTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="applyTimeEnd" prepend=" and ">
				<![CDATA[A.raw_add_time <= #applyTimeEnd# ]]>
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
			$sortCol$
			<isNotEmpty property="sortOrder">
				$sortOrder$
			</isNotEmpty>
		</isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY A.raw_add_time desc
        </isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>
	
	<!-- 用印申请列表 统计-->
	<select id="MS-EXTRA-STAMP-APPLY-FORM-SEARCH-COUNT" resultClass="long">
        SELECT count(*) from (
        SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,fsaf.file_name,fsaf.contract_code,0 as legal_chapter_num,0 as cachet_num,p.status as project_status,
        0 as file_id,<include refid="formCommonSql"/>,"" as replace_form_status,"" AS replace_file_name,"" as source
        FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        JOIN (SELECT GROUP_CONCAT(file_name) AS file_name ,GROUP_CONCAT(contract_code) AS contract_code,apply_id FROM f_stamp_apply_file  GROUP BY apply_id) fsaf ON fsa.apply_id=fsaf.apply_id
        LEFT JOIN project p ON fsa.project_code=p.project_code
        <include refid="projectPermissionSql"/>
        WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <isNotEmpty property="isNeedChannelContract" prepend="  "> <!--查渠道合同-->
            <isEqual property="isNeedChannelContract" compareValue="IS" prepend="  ">
                UNION ALL
                SELECT fsa.apply_id,fsa.apply_code,fsa.replace_form_id,fsa.file_code,fsa.project_code,fsa.project_name,fsa.customer_name,fsa.status AS submit_status,fsa.raw_add_time,fsaf.file_name,fsaf.contract_code,0 as legal_chapter_num,0 as cachet_num,"" as project_status,
                0 as file_id,<include refid="formCommonSql"/>,"" as replace_form_status,"" AS replace_file_name,"" as source
                FROM f_stamp_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
                JOIN (SELECT GROUP_CONCAT(file_name) AS file_name ,GROUP_CONCAT(contract_code) AS contract_code, apply_id FROM f_stamp_apply_file  GROUP BY apply_id) fsaf ON fsa.apply_id=fsaf.apply_id
                WHERE 1=1 AND f.status!="DELETED" and fsa.project_code="-" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
            </isEqual>
        </isNotEmpty>
        ) A where 1=1
		<dynamic>
			<isNotEmpty property="customerName" prepend=" and ">
				A.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileCode" prepend=" and ">
				A.file_code like concat('%',#fileCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="applyCode" prepend=" and ">
				A.apply_code like concat('%',#applyCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				A.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
            <isNotEmpty property="fileName" prepend=" and ">
                A.file_name like concat('%',#fileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="contractCode" prepend=" and ">
                A.contract_code like concat('%',#contractCode#,'%')
            </isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
				A.status = #status#
			</isNotEmpty>
			<isNotEmpty property="formCode" prepend=" and ">
				A.form_code = #formCode#
			</isNotEmpty>
			<isNotEmpty property="submitStatus" prepend=" and ">
				A.status = #submitStatus#
			</isNotEmpty>
			<isNotEmpty property="applyTimeStart" prepend=" and ">
				<![CDATA[fsa.raw_add_time >= #applyTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="applyTimeEnd" prepend=" and ">
				<![CDATA[fsa.raw_add_time <= #applyTimeEnd# ]]>
			</isNotEmpty>

		</dynamic>
	</select>

    <!-- 基础资料用印列表 -->
    <select id="MS-EXTRA-STAMP-BASIC-DATA-APPLY-FORM-SEARCH" resultMap="RM-STAMP-BASIC-DATA-APPLY-FORM">
        SELECT * from (
        SELECT fsa.apply_id,fsa.apply_code,fsa.raw_add_time,fsaf.file_name,
        <include refid="formCommonSql"/>
        FROM f_stamp_basic_data_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        JOIN (SELECT GROUP_CONCAT(file_name) AS file_name,apply_id FROM f_stamp_basic_data_apply_file  GROUP BY apply_id) fsaf ON fsa.apply_id=fsaf.apply_id
        <include refid="formPermissionSql"/>
        WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        ) A where 1=1
        <dynamic>
            <isNotEmpty property="applyCode" prepend=" and ">
                A.apply_code like concat('%',#applyCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileName" prepend=" and ">
                A.file_name like concat('%',#fileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                A.status = #status#
            </isNotEmpty>
            <isNotEmpty property="formUserName" prepend=" and ">
                A.user_name like concat('%', #formUserName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[A.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[A.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY A.raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 基础资料用印列表 统计-->
    <select id="MS-EXTRA-STAMP-BASIC-DATA-APPLY-FORM-SEARCH-COUNT" resultClass="long">
        SELECT count(*) from (
        SELECT fsa.apply_id,fsa.apply_code,fsa.raw_add_time,fsaf.file_name,
        <include refid="formCommonSql"/>
        FROM f_stamp_basic_data_apply fsa LEFT JOIN  form f ON fsa.form_id =f.form_id
        JOIN (SELECT GROUP_CONCAT(file_name) AS file_name,apply_id FROM f_stamp_basic_data_apply_file  GROUP BY apply_id) fsaf ON fsa.apply_id=fsaf.apply_id
        <include refid="formPermissionSql"/>
        WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        ) A where 1=1
        <dynamic>
            <isNotEmpty property="applyCode" prepend=" and ">
                A.apply_code like concat('%',#applyCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileName" prepend=" and ">
                A.file_name like concat('%',#fileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                A.status = #status#
            </isNotEmpty>
            <isNotEmpty property="formUserName" prepend=" and ">
                A.user_name like concat('%', #formUserName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[A.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[A.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>
    </select>
	
	<!-- 放用款申请列表 -->
	<select id="MS-EXTRA-LOAN-USE-APPLY-FORM-SEARCH" resultMap="RM-LOAN-USE-FORM-PROJECT">
		SELECT <include refid="formCommonSql"/>,
			   <include refid="projectCommonSimpleSql"/>,
			   a.apply_id,a.notification_id,a.apply_type,a.raw_add_time apply_add_time,a.raw_update_time apply_update_time,a.amount apply_amount,
			   r.id receipt_id,r.receipt_amount
		  FROM form f
		  JOIN f_loan_use_apply a ON f.form_id = a.form_id
		  JOIN project p ON a.project_code = p.project_code
		  LEFT JOIN (SELECT MIN(id) id,sum(actual_amount) receipt_amount,apply_id FROM f_loan_use_apply_receipt GROUP BY apply_id) r ON a.apply_id = r.apply_id
		  <include refid="projectPermissionSql"/>
		  WHERE 1= 1 AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
           <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.apply_id = #applyId#
           </isGreaterThan>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
           <isNotEmpty property="formStatus" prepend=" and ">
              	f.status = #formStatus#
           </isNotEmpty>
           <isNotEmpty property="statusList" prepend=" and ">
              	f.status in 
              	<iterate property="statusList" conjunction="," open="(" close=")">
              		#statusList[]#
              	</iterate>
           </isNotEmpty>           
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
           </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
              	p.busi_type like concat(#busiType#,'%')
           </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
              	p.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
              	p.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
           <isEqual property="hasReceipt" compareValue="IS" prepend=" and ">
           	   r.id > 0
           </isEqual>
           <isEqual property="hasReceipt" compareValue="NO" prepend=" and ">
           	    <![CDATA[(r.id is null or r.id <=0) AND apply_type !='USE']]>
           </isEqual>
       </dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
			$sortCol$
			<isNotEmpty property="sortOrder">
				$sortOrder$
			</isNotEmpty>
		</isNotEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>
	
	<!-- 放用款申请列表 统计-->
	<select id="MS-EXTRA-LOAN-USE-APPLY-FORM-SEARCH-COUNT" resultClass="long">
		SELECT count(*)
		  FROM form f
		  JOIN f_loan_use_apply a ON f.form_id = a.form_id
		  JOIN project p ON a.project_code = p.project_code
		  LEFT JOIN (SELECT MIN(id) id,sum(actual_amount) receipt_amount,apply_id FROM f_loan_use_apply_receipt GROUP BY apply_id) r ON a.apply_id = r.apply_id
		  <include refid="projectPermissionSql"/>
		  WHERE 1= 1 AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
           <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.apply_id = #applyId#
           </isGreaterThan>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
           <isNotEmpty property="formStatus" prepend=" and ">
              	f.status = #formStatus#
           </isNotEmpty>
           <isNotEmpty property="statusList" prepend=" and ">
              	f.status in 
              	<iterate property="statusList" conjunction="," open="(" close=")">
              		#statusList[]#
              	</iterate>
           </isNotEmpty>                       
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
           </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
              	p.busi_type like concat(#busiType#,'%')
           </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
              	p.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
              	p.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
           <isEqual property="hasReceipt" compareValue="IS" prepend=" and ">
           	   r.id > 0
           </isEqual>
           <isEqual property="hasReceipt" compareValue="NO" prepend=" and ">
           	    <![CDATA[(r.id is null or r.id <=0) AND apply_type !='USE']]>
           </isEqual>           
       </dynamic>
	</select>
	
	<!-- 放用款选择项目 -->
	<select id="MS-EXTRA-LOAN-USE-APPLY-SELECT-PROJECT" resultMap="RM-PROJECT">
		  SELECT
		    project.*
		  FROM (SELECT
	  		  cnum,
	  		  anum,		  
		      p.*
		      <!-- ,
		      <![CDATA[
		      CASE WHEN p.busi_type LIKE '12%' AND p.reinsurance_ratio > 0 THEN p.reinsurance_amount
		           WHEN p.busi_type LIKE '12%' AND (p.reinsurance_ratio <= 0 OR p.reinsurance_ratio IS NULL) THEN accumulated_issue_amount ELSE p.contract_amount END max_amount,
		       ]]> 
		      CASE WHEN fp.charge_phase = 'BEFORE' THEN 1 ELSE 0 END isChargeBefore,
		      fee.guarenteeFee
		       -->
		    FROM project p
		      <include refid="projectPermissionSql"/>
		      <!-- 
		      JOIN f_council_summary_project fp
		        ON p.sp_id = fp.sp_id
		      LEFT JOIN (SELECT
		          n.project_code,
		          SUM(fee.charge_amount) guarenteeFee
		        FROM f_charge_notification n
		          JOIN form f
		            ON n.form_id = f.form_id
		            AND f.status = 'APPROVAL'
		          JOIN (SELECT
		              SUM(charge_amount) charge_amount,
		              notification_id
		            FROM f_charge_notification_fee
		            WHERE fee_type = 'GUARANTEE_FEE'
		            GROUP BY notification_id) fee
		            ON n.notification_id = fee.notification_id
		        GROUP BY n.project_code) fee
		        ON p.project_code = fee.project_code
		         -->
			      LEFT JOIN (SELECT
			          project_code,
			          COUNT(*) cnum
			        FROM project_credit_condition
			        GROUP BY project_code) cnum
			        ON cnum.project_code = p.project_code
			      LEFT JOIN (SELECT
			          c.project_code,
			          COUNT(*) anum
			        FROM f_credit_condition_confirm c
			          JOIN form f
			            ON c.form_id = f.form_id
			            AND f.status = 'APPROVAL'
			        GROUP BY c.project_code) anum 
			        ON anum.project_code = p.project_code		        
		    WHERE ((p.contract_no IS NOT NULL AND p.contract_no != '') OR (p.is_redo_project = 'IS'))
		      AND (p.busi_type LIKE '1%'
		       OR p.busi_type LIKE '221%'
		       OR p.busi_type LIKE '231%'
		       OR p.busi_type LIKE '241%'
		       OR p.busi_type LIKE '3%'
		       OR p.busi_type LIKE '4%'
		       OR p.busi_type LIKE '6%'
               OR p.busi_type = '999'
		       OR p.busi_type LIKE '7%')
		       <!-- AND (p.accumulated_issue_amount > 0 OR p.busi_type NOT LIKE '12%') -->
		   ) project
		  WHERE <!--((project.isChargeBefore = 1 AND ((project.busi_type NOT LIKE '4%' AND project.guarenteeFee > 0) OR (project.busi_type LIKE '4%' AND project.charged_amount > 0))) OR project.isChargeBefore = 0)
		    	AND ((project.is_maximum_amount = 'IS' AND project.max_amount + project.released_amount > project.loaned_amount) OR ((project.is_maximum_amount = 'NO' OR project.is_maximum_amount IS NULL) AND project.max_amount > project.loaned_amount) OR (project.loaned_amount > project.used_amount))
         		--> 
         	CASE WHEN project.is_redo_project = 'IS' THEN 1=1 ELSE	
         	<![CDATA[((project.is_maximum_amount = 'IS' AND project.contract_amount + project.released_amount > project.loaned_amount) 
         				 OR ((project.is_maximum_amount = 'NO' OR project.is_maximum_amount IS NULL) AND project.contract_amount > project.loaned_amount) 
         				 OR (project.busi_type LIKE '12%' AND project.accumulated_issue_amount > project.used_amount)
         				 OR (project.busi_type NOT LIKE '12%' AND project.loaned_amount > project.used_amount))
         	AND (cnum IS NULL OR anum > 0) ]]> END
         <dynamic>
             <isNotEmpty property="projectCode" prepend=" and ">
                 project.project_code = #projectCode#
            </isNotEmpty>
             <isNotEmpty property="customerName" prepend=" and ">
               project.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>         	
             <isNotEmpty property="projectName" prepend=" and ">
               project.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
             <isNotEmpty property="projectCodeOrName" prepend=" and ">
               (project.project_code like concat('%',#projectCodeOrName#,'%') OR project.project_name like concat('%',#projectCodeOrName#,'%'))
            </isNotEmpty>
         </dynamic>
         <isNotEmpty property="sortCol" prepend=" order by ">
             $sortCol$
                <isNotEmpty property="sortOrder">
             	 		$sortOrder$
            		</isNotEmpty>
         </isNotEmpty>
         LIMIT #limitStart#,#pageSize#;	
       		
	</select>
	
	<!-- 放用款选择项目统计 -->
	<select id="MS-EXTRA-LOAN-USE-APPLY-SELECT-PROJECT-COUNT" resultClass="long">
		  SELECT
		   count(*)
		  FROM (SELECT
	  		  cnum,
	  		  anum,		  
		      p.*
		      <!-- ,
		      <![CDATA[
		      CASE WHEN p.busi_type LIKE '12%' AND p.reinsurance_ratio > 0 THEN p.reinsurance_amount
		           WHEN p.busi_type LIKE '12%' AND (p.reinsurance_ratio <= 0 OR p.reinsurance_ratio IS NULL) THEN accumulated_issue_amount ELSE p.contract_amount END max_amount,
		       ]]> 
		      CASE WHEN fp.charge_phase = 'BEFORE' THEN 1 ELSE 0 END isChargeBefore,
		      fee.guarenteeFee
		       -->
		    FROM project p
		      <include refid="projectPermissionSql"/>
		      <!-- 
		      JOIN f_council_summary_project fp
		        ON p.sp_id = fp.sp_id
		      LEFT JOIN (SELECT
		          n.project_code,
		          SUM(fee.charge_amount) guarenteeFee
		        FROM f_charge_notification n
		          JOIN form f
		            ON n.form_id = f.form_id
		            AND f.status = 'APPROVAL'
		          JOIN (SELECT
		              SUM(charge_amount) charge_amount,
		              notification_id
		            FROM f_charge_notification_fee
		            WHERE fee_type = 'GUARANTEE_FEE'
		            GROUP BY notification_id) fee
		            ON n.notification_id = fee.notification_id
		        GROUP BY n.project_code) fee
		        ON p.project_code = fee.project_code
		         -->
			      LEFT JOIN (SELECT
			          project_code,
			          COUNT(*) cnum
			        FROM project_credit_condition
			        GROUP BY project_code) cnum
			        ON cnum.project_code = p.project_code
			      LEFT JOIN (SELECT
			          c.project_code,
			          COUNT(*) anum
			        FROM f_credit_condition_confirm c
			          JOIN form f
			            ON c.form_id = f.form_id
			            AND f.status = 'APPROVAL'
			        GROUP BY c.project_code) anum 
			        ON anum.project_code = p.project_code		        
		    WHERE ((p.contract_no IS NOT NULL AND p.contract_no != '') OR (p.is_redo_project = 'IS'))
		      AND (p.busi_type LIKE '1%'
		       OR p.busi_type LIKE '221%'
		       OR p.busi_type LIKE '231%'
		       OR p.busi_type LIKE '241%'
		       OR p.busi_type LIKE '3%'
		       OR p.busi_type LIKE '4%'
		       OR p.busi_type LIKE '6%'
               OR p.busi_type =999
		       OR p.busi_type LIKE '7%')
		       <!-- AND (p.accumulated_issue_amount > 0 OR p.busi_type NOT LIKE '12%') -->
		   ) project
		  WHERE <!--((project.isChargeBefore = 1 AND ((project.busi_type NOT LIKE '4%' AND project.guarenteeFee > 0) OR (project.busi_type LIKE '4%' AND project.charged_amount > 0))) OR project.isChargeBefore = 0)
		    	AND ((project.is_maximum_amount = 'IS' AND project.max_amount + project.released_amount > project.loaned_amount) OR ((project.is_maximum_amount = 'NO' OR project.is_maximum_amount IS NULL) AND project.max_amount > project.loaned_amount) OR (project.loaned_amount > project.used_amount))
         		-->
         	CASE WHEN project.is_redo_project = 'IS' THEN 1=1 ELSE
         	<![CDATA[((project.is_maximum_amount = 'IS' AND project.contract_amount + project.released_amount > project.loaned_amount) 
         				 OR ((project.is_maximum_amount = 'NO' OR project.is_maximum_amount IS NULL) AND project.contract_amount > project.loaned_amount) 
         				 OR (project.busi_type LIKE '12%' AND project.accumulated_issue_amount > project.used_amount)
         				 OR (project.busi_type NOT LIKE '12%' AND project.loaned_amount > project.used_amount))
         	AND (cnum IS NULL OR anum > 0) ]]> END
           <dynamic>
             <isNotEmpty property="projectCode" prepend=" and ">
               project.project_code = #projectCode#
            </isNotEmpty>
             <isNotEmpty property="customerName" prepend=" and ">
               project.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>         	
             <isNotEmpty property="projectName" prepend=" and ">
               project.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCodeOrName" prepend=" and ">
               (project.project_code like concat('%',#projectCodeOrName#,'%') OR project.project_name like concat('%',#projectCodeOrName#,'%'))
            </isNotEmpty>           
         </dynamic>
	</select>	
	
	<!-- 风险预警列表 -->
    <select id="MS-EXTRA-FORM-RISK-WARNING-SEARCH" resultMap="RM-RISK-WARNING-FORM">
 		SELECT DISTINCT <include refid="formCommonSql"/>,r.warning_id,r.signal_level,r.customer_id,r.customer_name,r.warning_bill_type
 		FROM f_risk_warning r INNER JOIN form f ON f.form_id = r.form_id  
 		LEFT JOIN  f_risk_warning_credit c on r.warning_id=c.warning_id
		LEFT JOIN project p ON c.project_code = p.project_code 
 		<include refid="projectPermissionSql"/>
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isGreaterThan property="warningId" compareValue="0" prepend=" and ">
				r.warning_id = #warningId#
			</isGreaterThan>		
			<isNotEmpty property="customerName" prepend=" and ">
				r.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerNameFull" prepend=" and ">
				r.customer_name = #customerNameFull#
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="warningBillType" prepend=" and ">
				r.warning_bill_type = #warningBillType#
			</isNotEmpty>
			<isNotEmpty property="submitUserName" prepend=" and ">
				f.user_name LIKE CONCAT('%',#submitUserName#,'%')
			</isNotEmpty>
			<isNotEmpty property="signalLevel" prepend=" and ">
				r.signal_level = #signalLevel#
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY r.warning_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
    <!-- 风险预警列表统计 -->
	<select id="MS-EXTRA-FORM-RISK-WARNING-COUNT" resultClass="long">
		SELECT count(DISTINCT r.warning_id)
		FROM f_risk_warning r INNER JOIN form f ON f.form_id = r.form_id  
 		LEFT JOIN  f_risk_warning_credit c on r.warning_id=c.warning_id
		LEFT JOIN project p ON c.project_code = p.project_code 
 		<include refid="projectPermissionSql"/>
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isGreaterThan property="warningId" compareValue="0" prepend=" and ">
				r.warning_id = #warningId#
			</isGreaterThan>		
			<isNotEmpty property="customerName" prepend=" and ">
				r.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerNameFull" prepend=" and ">
				r.customer_name = #customerNameFull#
			</isNotEmpty> 			
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="submitUserName" prepend=" and ">
				f.user_name LIKE CONCAT('%',#submitUserName#,'%')
			</isNotEmpty>
			<isNotEmpty property="signalLevel" prepend=" and ">
				r.signal_level = #signalLevel#
			</isNotEmpty>
			<isNotEmpty property="warningBillType" prepend=" and ">
				r.warning_bill_type = #warningBillType#
			</isNotEmpty>
		</dynamic>
	</select>  
	
	<!-- 尽职调查报告申明选择项目列表list -->
    <select id="MS-EXTRA-INVESTIGATION-SELECT-PROJECT-SEARCH" resultMap="RM-PROJECT">
 		SELECT p.*
 		FROM project p
 			LEFT JOIN f_investigation i ON p.project_code = i.project_code
 			<include refid="projectPermissionSql"/>   
		WHERE p.phases = 'INVESTIGATING_PHASES' AND p.status = 'NORMAL' AND p.phases_status = 'WAITING' AND i.project_code is null  
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.project_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
    <!-- 尽职调查报告申明选择项目列表count -->
	<select id="MS-EXTRA-INVESTIGATION-SELECT-PROJECT-COUNT" resultClass="long">
 		SELECT COUNT(p.project_code) 
 		FROM project p
 			LEFT JOIN f_investigation i ON p.project_code = i.project_code
 			<include refid="projectPermissionSql"/>   
		WHERE p.phases = 'INVESTIGATING_PHASES' AND p.status = 'NORMAL' AND p.phases_status = 'WAITING' AND i.project_code is null  
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
		</dynamic>
	</select> 
	
	<!-- 上会申报项目列表list -->
    <select id="MS-EXTRA-RISK-HANDLE-PROJECT-SEARCH" resultMap="RM-RISK-HANDLE-PROJECT">
    	SELECT DISTINCT <include refid="formCommonSql"/>, rh.is_repay, rh.id handle_id, rh.project_code, rh.project_name, rh.customer_id, rh.customer_name, 0 busi_manager_id, '' busi_manager_account,'' busi_manager_name,'' project_status, '' phases  
 		FROM f_council_apply_risk_handle rh 
 			LEFT JOIN form f ON rh.form_id = f.form_id 
			LEFT JOIN  f_council_apply_credit c on rh.id=c.handle_id
			LEFT JOIN project p ON c.project_code = p.project_code 
		<include refid="projectPermissionSql"/>
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				rh.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				rh.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				rh.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
				p.status = #status#
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>			
			<isNotEmpty property="phases" prepend=" and ">
				p.phases = #phases#
			</isNotEmpty>
			<isNotEmpty property="isRepay" prepend=" and ">
				rh.is_repay = #isRepay#
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY rh.id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
    <!-- 上会申报项目列表count -->
	<select id="MS-EXTRA-RISK-HANDLE-PROJECT-COUNT" resultClass="long">
 		SELECT COUNT(DISTINCT rh.id) 
 		FROM f_council_apply_risk_handle rh 
 			LEFT JOIN form f ON rh.form_id = f.form_id 
 			LEFT JOIN  f_council_apply_credit c on rh.id=c.handle_id
			LEFT JOIN project p ON c.project_code = p.project_code 
		<include refid="projectPermissionSql"/>
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				rh.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				rh.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				rh.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
				p.status = #status#
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="phases" prepend=" and ">
				p.phases = #phases#
			</isNotEmpty>
			<isNotEmpty property="isRepay" prepend=" and ">
				rh.is_repay = #isRepay#
			</isNotEmpty>
		</dynamic>
	</select> 
	
	<!-- 解保申请列表list -->
    <select id="MS-EXTRA-RELEASE-APPLY-SEARCH" resultMap="RM-RELEASE-APPLY-FORM">
       	SELECT <include refid="formCommonSql"/>, r.id release_id, p.project_code, p.project_name, p.customer_id, p.customer_name, p.busi_manager_id, p.busi_manager_account, p.busi_manager_name, p.status project_status, p.phases, p.busi_type,p.busi_type_name,p.right_voucher_exten_date  
 		FROM f_counter_guarantee_release r 
 			LEFT JOIN form f ON r.form_id = f.form_id 
			LEFT JOIN project p ON r.project_code = p.project_code 
			<include refid="projectPermissionSql"/> 
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				r.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				r.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				r.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
				p.status = #status#
			</isNotEmpty>
			<isNotEmpty property="phases" prepend=" and ">
				p.phases = #phases#
			</isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>			
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY r.id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
    <!-- 解保申请列表count -->
	<select id="MS-EXTRA-RELEASE-APPLY-COUNT" resultClass="long">
 		SELECT COUNT(r.id) 
 		FROM f_counter_guarantee_release r 
 			LEFT JOIN form f ON r.form_id = f.form_id 
			LEFT JOIN project p ON r.project_code = p.project_code 
			<include refid="projectPermissionSql"/> 
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				r.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				r.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				r.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="status" prepend=" and ">
				p.status = #status#
			</isNotEmpty>
			<isNotEmpty property="phases" prepend=" and ">
				p.phases = #phases#
			</isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>			
		</dynamic>
	</select>
	
    <!-- 已经解保的金额 -->
	<select id="MS-EXTRA-COUNTER-GUARANTEE-APPLY-SUM" resultClass="long">
 		SELECT IFNULL(SUM(r.apply_amount), 0) 
 		FROM f_counter_guarantee_release r 
 			LEFT JOIN form f ON r.form_id = f.form_id 
		WHERE r.project_code = #projectCode#  
		<dynamic>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
              	f.status in 
              	<iterate property="formStatusList" conjunction="," open="(" close=")">
              		#formStatusList[]#
              	</iterate>
			</isNotEmpty>
		</dynamic>		
	</select> 
	
	<!-- 风险评级列表list -->
    <select id="MS-EXTRA-RISK-LEVEL-SEARCH" resultMap="RM-RISK-LEVEL-FORM">
       	SELECT <include refid="formCommonSql"/>, <include refid="projectCommonSimpleSql"/>, 
       			r.id risk_level_id, r.reevaluation_id, r.evaluation_level, r.reevaluation_level, r.check_level, r.check_phase 
 		FROM f_risk_level r 
 			LEFT JOIN form f ON r.form_id = f.form_id 
			LEFT JOIN project p ON r.project_code = p.project_code AND p.busi_type NOT LIKE '5%' AND p.busi_type NOT LIKE '211%' 
			<include refid="projectPermissionSql"/> 
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectStatus" prepend=" and ">
				p.status = #projectStatus#
			</isNotEmpty>
			<isNotEmpty property="projectPhases" prepend=" and ">
				p.phases = #projectPhases#
			</isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>			
            <isNotEmpty property="phases" prepend=" and ">
               r.check_phase = #phases#
            </isNotEmpty>			
            <!-- 
           	<isEqual property="phases" compareValue="RE" prepend=" and "> 
           		r.reevaluation_id != 0 
           	</isEqual>            
           	<isEqual property="phases" compareValue="E" prepend=" and "> 
           		r.reevaluation_id = 0 
           	</isEqual>            
           	 -->            
            <isNotEmpty property="riskLevel" prepend=" and ">
               	r.check_level = #riskLevel#
            </isNotEmpty>		
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY r.id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
    <!-- 风险评级列表count -->
	<select id="MS-EXTRA-RISK-LEVEL-COUNT" resultClass="long">
       	SELECT COUNT(r.id) 
 		FROM f_risk_level r 
 			LEFT JOIN form f ON r.form_id = f.form_id 
			LEFT JOIN project p ON r.project_code = p.project_code AND p.busi_type NOT LIKE '5%' AND p.busi_type NOT LIKE '211%' 
			<include refid="projectPermissionSql"/> 
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectStatus" prepend=" and ">
				p.status = #projectStatus#
			</isNotEmpty>
			<isNotEmpty property="projectPhases" prepend=" and ">
				p.phases = #projectPhases#
			</isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>			
            <isNotEmpty property="phases" prepend=" and ">
               r.check_phase = #phases#
            </isNotEmpty>			
            <!-- 
           	<isEqual property="phases" compareValue="RE" prepend=" and "> 
           		r.reevaluation_id != 0 
           	</isEqual>            
           	<isEqual property="phases" compareValue="E" prepend=" and "> 
           		r.reevaluation_id = 0 
           	</isEqual>            
           	 -->
            <isNotEmpty property="riskLevel" prepend=" and ">
               	r.check_level = #riskLevel#
            </isNotEmpty>		
		</dynamic>
	</select>
	
	<!-- 到期项目列表list -->
    <select id="MS-EXTRA-EXPIRE-PROJECT-SEARCH" resultMap="RM-EXPIRE-PROJECT">
        SELECT A.*,epnt.id AS template_id,epnt.project_code AS template_projectCode FROM(
        SELECT ep.id AS expire_project_id, ep.expire_date AS expire_date, ep.status AS expire_status,ep.repay_certificate, p.*
        FROM expire_project ep
        LEFT JOIN project p ON ep.project_code = p.project_code
        <include refid="projectPermissionSql"/>
        WHERE p.status != 'DELETED'
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="expireStatus" prepend=" and ">
				ep.status = #expireStatus#
			</isNotEmpty>
			<isEmpty property="expireStatus" prepend=" and ">
				ep.status != 'UNDUE'
			</isEmpty>
		</dynamic>
        ) A
        LEFT JOIN expire_project_notice_template epnt
        ON IF(A.busi_type LIKE '5%',A.expire_project_id = epnt.expire_id,(A.expire_project_id = epnt.expire_id   AND  (A.expire_status = epnt.status OR epnt.status IS NULL
        OR epnt.status = '' ))) where 1=1
        <isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY expire_date DESC
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>	
    
    <!-- 到期项目列表count -->
	<select id="MS-EXTRA-EXPIRE-PROJECT-COUNT" resultClass="long">
        SELECT count(*) FROM(select ep.id AS expire_project_id, ep.expire_date AS expire_date, ep.status AS expire_status,ep.repay_certificate, p.*
 		FROM expire_project ep
 			LEFT JOIN project p ON ep.project_code = p.project_code
        <include refid="projectPermissionSql"/>
		WHERE p.status != 'DELETED'
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="expireStatus" prepend=" and ">
				ep.status = #expireStatus#
			</isNotEmpty>
			<isEmpty property="expireStatus" prepend=" and ">
				ep.status != 'UNDUE'
			</isEmpty>
		</dynamic>
        ) A
        LEFT JOIN expire_project_notice_template epnt
        ON IF(A.busi_type LIKE '5%',A.expire_project_id = epnt.expire_id,(A.expire_project_id = epnt.expire_id   AND  (A.expire_status = epnt.status OR epnt.status IS NULL
        OR epnt.status = '' )))
        where 1=1

	</select> 
	
	
	<!-- 理财项目立项单列表list -->
    <select id="MS-EXTRA-FINANCIAL-PROJECT-SETUP-SEARCH" resultMap="RM-FINANCIAL-PROJECT-SETUP-FORM">
		SELECT
			<include refid="formCommonSql"/>, p.*
		  FROM form f INNER JOIN f_project_financial p ON f.form_id = p.form_id
		  <include refid="projectPermissionSql"/>
	     WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)  
	     <dynamic>
            <isGreaterThan property="deptId"  compareValue="0" prepend=" and ">
                p.dept_id = #deptId#
            </isGreaterThan>
            <isGreaterThan property="productId"  compareValue="0" prepend=" and ">
                p.product_id = #productId#
            </isGreaterThan>
             <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code = #projectCode#
            </isNotEmpty>
             <isNotEmpty property="deptName" prepend=" and ">
                p.dept_name like concat('%',#deptName#,'%')
            </isNotEmpty>
             <isNotEmpty property="issueInstitution" prepend=" and ">
                p.issue_institution like concat('%',#issueInstitution#,'%')
            </isNotEmpty>
             <isNotEmpty property="productName" prepend=" and ">
                p.product_name like concat('%',#productName#,'%')
            </isNotEmpty>
            <isNotEmpty property="deptCode" prepend=" and ">
                p.dept_code = #deptCode#
            </isNotEmpty>
             <isNotEmpty property="deptPath" prepend=" and ">
               p.dept_path like concat(#deptPath#,'%')
            </isNotEmpty>
             <isNotEmpty property="deptPathName" prepend=" and ">
               p.dept_path_name like concat(#deptPathName#,'%')
            </isNotEmpty>            
             <isNotEmpty property="formStatus" prepend=" and ">
            	<!-- 送审中 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_SENDING">
            		 p.council_status = 'COUNCIL_SENDING'
            	</isEqual>
            	<!-- 上会中 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_WAITING">
            		 p.council_status = 'COUNCIL_WAITING'
            	</isEqual>
            	<!-- 上会不通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_DENY">
            		 p.council_status = 'COUNCIL_DENY'
            	</isEqual>
            	<!-- 上会通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
            		 p.council_status = 'COUNCIL_APPROVAL'
            	</isEqual>
            	<!-- 其他表单状态 -->
             	<isNotEqual property="formStatus" compareValue="COUNCIL_SENDING">
             		<isNotEqual property="formStatus" compareValue="COUNCIL_WAITING">
             			<isNotEqual property="formStatus" compareValue="COUNCIL_DENY">
             				<isNotEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
             					f.status = #formStatus#
             				</isNotEqual>
             			</isNotEqual>
             		</isNotEqual>			
             	</isNotEqual>
            </isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>
			<isNotEmpty property="chooseForContract" prepend=" and ">
				<isEqual property="chooseForContract" compareValue="YES">
	            	( p.council_status = 'COUNCIL_APPROVAL' OR ( (p.council_status IS NULL OR p.council_status = '') AND f.status = 'APPROVAL') )
	            </isEqual>
            </isNotEmpty>
        </dynamic>                            				
         <isNotEmpty property="sortCol" prepend=" order by ">
             $sortCol$
                <isNotEmpty property="sortOrder">
             	 		$sortOrder$
            	</isNotEmpty>
         </isNotEmpty>
         LIMIT #limitStart#,#pageSize#;
    </select>
    

    <!-- 理财项目立项单列表count -->
	<select id="MS-EXTRA-FINANCIAL-PROJECT-SETUP-SEARCH-COUNT" resultClass="long">
		SELECT count(*)
		  FROM form f INNER JOIN f_project_financial p ON f.form_id = p.form_id
		  <include refid="projectPermissionSql"/>
	     WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)  
     <dynamic>
           <isGreaterThan property="deptId"  compareValue="0" prepend=" and ">
               p.dept_id = #deptId#
           </isGreaterThan>
            <isGreaterThan property="productId"  compareValue="0" prepend=" and ">
                p.product_id = #productId#
            </isGreaterThan>           
            <isNotEmpty property="projectCode" prepend=" and ">
               p.project_code = #projectCode#
           </isNotEmpty>
            <isNotEmpty property="deptName" prepend=" and ">
               p.dept_name like concat('%',#deptName#,'%')
           </isNotEmpty>
            <isNotEmpty property="issueInstitution" prepend=" and ">
               p.issue_institution like concat('%',#issueInstitution#,'%')
           </isNotEmpty>
            <isNotEmpty property="productName" prepend=" and ">
               p.product_name like concat('%',#productName#,'%')
           </isNotEmpty>
           <isNotEmpty property="deptCode" prepend=" and ">
               p.dept_code = #deptCode#
           </isNotEmpty>
            <isNotEmpty property="deptPath" prepend=" and ">
              p.dept_path like concat(#deptPath#,'%')
           </isNotEmpty>
            <isNotEmpty property="deptPathName" prepend=" and ">
              p.dept_path_name like concat(#deptPathName#,'%')
           </isNotEmpty>            
             <isNotEmpty property="formStatus" prepend=" and ">
            	<!-- 送审中 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_SENDING">
            		 p.council_status = 'COUNCIL_SENDING'
            	</isEqual>
            	<!-- 上会中 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_WAITING">
            		 p.council_status = 'COUNCIL_WAITING'
            	</isEqual>
            	<!-- 上会不通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_DENY">
            		 p.council_status = 'COUNCIL_DENY'
            	</isEqual>
            	<!-- 上会通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
            		 p.council_status = 'COUNCIL_APPROVAL'
            	</isEqual>
            	<!-- 其他表单状态 -->
             	<isNotEqual property="formStatus" compareValue="COUNCIL_SENDING">
             		<isNotEqual property="formStatus" compareValue="COUNCIL_WAITING">
             			<isNotEqual property="formStatus" compareValue="COUNCIL_DENY">
             				<isNotEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
             					f.status = #formStatus#
             				</isNotEqual>
             			</isNotEqual>
             		</isNotEqual>			
             	</isNotEqual>		
            </isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>
			<isNotEmpty property="chooseForContract" prepend=" and ">
				<isEqual property="chooseForContract" compareValue="YES">
	            	( p.council_status = 'COUNCIL_APPROVAL' OR ( (p.council_status IS NULL OR p.council_status = '') AND f.status = 'APPROVAL') )
	            </isEqual>
            </isNotEmpty>			            
       </dynamic>    
	</select>
	
	
	<!-- 理财项目转让单列表list -->
    <select id="MS-EXTRA-FINANCIAL-PROJECT-TRANSFER-SEARCH" resultMap="RM-FINANCIAL-PROJECT-TRANSFER-FORM">
		SELECT
			<include refid="formCommonSql"/>,a.*
		  FROM form f INNER JOIN f_project_financial_tansfer_apply a ON f.form_id = a.form_id
		  			  INNER JOIN project_financial p ON a.project_code = p.project_code
		  			  LEFT JOIN project_financial_trade_tansfer t on a.apply_id = t.apply_id
		   <include refid="projectPermissionSql"/>
	     WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
	     <dynamic>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.apply_id = #applyId#
           </isGreaterThan>	     
             <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code = #projectCode#
            </isNotEmpty>
             <isNotEmpty property="productName" prepend=" and ">
                p.product_name like concat('%',#productName#,'%')
            </isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
            	<!-- 待回购 -->
            	<isEqual property="formStatus" compareValue="BUY_BACK_WAITING"> 
            		t.is_buy_back = 'IS' and t.is_confirm = 'NO'
            	</isEqual>
            	 <!-- 已回购 -->
            	<isEqual property="formStatus" compareValue="BUY_BACK_FINISH">
            		t.is_buy_back = 'IS' and t.is_confirm = 'IS'
            	</isEqual>
        		<!-- 转让完成 -->
            	<isEqual property="formStatus" compareValue="TRANSFERED">
            		 t.is_buy_back = 'NO'
            	</isEqual>            	
            	<!-- 上会中 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_WAITING">
            		 a.council_status = 'COUNCIL_WAITING'
            	</isEqual>
            	<!-- 上会不通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_DENY">
            		 a.council_status = 'COUNCIL_DENY'
            	</isEqual>
            	<!-- 上会通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
            		 a.council_status = 'COUNCIL_APPROVAL' AND (t.trade_id is null or t.trade_id = 0)
            	</isEqual>
    
            	<!-- 其他表单状态 -->
               	<isNotEqual property="formStatus" compareValue="TRANSFERED">
	               	<isNotEqual property="formStatus" compareValue="BUY_BACK_WAITING">
		               	<isNotEqual property="formStatus" compareValue="BUY_BACK_FINISH">
		               		<isNotEqual property="formStatus" compareValue="COUNCIL_WAITING">
		               			<isNotEqual property="formStatus" compareValue="COUNCIL_DENY">
		               				<isNotEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
		               					f.status = #formStatus#
		               					AND (t.trade_id is null or t.trade_id = 0)
		               				</isNotEqual>
		               			</isNotEqual>
		               		</isNotEqual>			
		               	</isNotEqual>                   	
	               	</isNotEqual>               	
               	</isNotEqual>
            </isNotEmpty>
            <isNotEmpty property="transferTimeStart" prepend=" and ">
              <![CDATA[ CASE WHEN t.transfer_time IS NULL THEN a.transfer_time ELSE t.transfer_time END >= #transferTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="transferTimeEnd" prepend=" and ">
              <![CDATA[ CASE WHEN t.transfer_time IS NULL THEN a.transfer_time ELSE t.transfer_time END <= #transferTimeEnd# ]]>
            </isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>            
        </dynamic>                            				
         <isNotEmpty property="sortCol" prepend=" order by ">
             $sortCol$
                <isNotEmpty property="sortOrder">
             	 		$sortOrder$
            	</isNotEmpty>
         </isNotEmpty>
         LIMIT #limitStart#,#pageSize#;
    </select>
    
	<!-- 理财项目转让单列表count -->
    <select id="MS-EXTRA-FINANCIAL-PROJECT-TRANSFER-SEARCH-COUNT" resultClass="long">
		SELECT
			 count(*)
		  FROM form f INNER JOIN f_project_financial_tansfer_apply a ON f.form_id = a.form_id
		  			  INNER JOIN project_financial p ON a.project_code = p.project_code
		  			  LEFT JOIN project_financial_trade_tansfer t on a.apply_id = t.apply_id
		 <include refid="projectPermissionSql"/>
	     WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
	     <dynamic>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.apply_id = #applyId#
           </isGreaterThan>	  	     
             <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code = #projectCode#
            </isNotEmpty>
             <isNotEmpty property="productName" prepend=" and ">
               p.product_name like concat('%',#productName#,'%')
            </isNotEmpty>            
             <isNotEmpty property="formStatus" prepend=" and ">
            	<!-- 待回购 -->
            	<isEqual property="formStatus" compareValue="BUY_BACK_WAITING"> 
            		t.is_buy_back = 'IS' and t.is_confirm = 'NO'
            	</isEqual>
            	 <!-- 已回购 -->
            	<isEqual property="formStatus" compareValue="BUY_BACK_FINISH">
            		t.is_buy_back = 'IS' and t.is_confirm = 'IS'
            	</isEqual>
        		<!-- 转让完成 -->
            	<isEqual property="formStatus" compareValue="TRANSFERED">
            		 t.is_buy_back = 'NO'
            	</isEqual>            	
            	<!-- 上会中 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_WAITING">
            		 a.council_status = 'COUNCIL_WAITING'
            	</isEqual>
            	<!-- 上会不通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_DENY">
            		 a.council_status = 'COUNCIL_DENY'
            	</isEqual>
            	<!-- 上会通过 -->
            	<isEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
            		 a.council_status = 'COUNCIL_APPROVAL' AND (t.trade_id is null or t.trade_id = 0)
            	</isEqual>
    
            	<!-- 其他表单状态 -->
               	<isNotEqual property="formStatus" compareValue="TRANSFERED">
	               	<isNotEqual property="formStatus" compareValue="BUY_BACK_WAITING">
		               	<isNotEqual property="formStatus" compareValue="BUY_BACK_FINISH">
		               		<isNotEqual property="formStatus" compareValue="COUNCIL_WAITING">
		               			<isNotEqual property="formStatus" compareValue="COUNCIL_DENY">
		               				<isNotEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
		               					f.status = #formStatus#
		               					AND (t.trade_id is null or t.trade_id = 0)
		               				</isNotEqual>
		               			</isNotEqual>
		               		</isNotEqual>			
		               	</isNotEqual>                   	
	               	</isNotEqual>               	
               	</isNotEqual>
            </isNotEmpty>
            <isNotEmpty property="transferTimeStart" prepend=" and ">
              <![CDATA[ CASE WHEN t.transfer_time IS NULL THEN a.transfer_time ELSE t.transfer_time END >= #transferTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="transferTimeEnd" prepend=" and ">
              <![CDATA[ CASE WHEN t.transfer_time IS NULL THEN a.transfer_time ELSE t.transfer_time END <= #transferTimeEnd# ]]>
            </isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>            
        </dynamic>                            				
    </select>    
    
	<!-- 理财项目赎回单列表list -->
    <select id="MS-EXTRA-FINANCIAL-PROJECT-REDEEM-SEARCH" resultMap="RM-FINANCIAL-PROJECT-REDEEM-FORM">
		SELECT
			<include refid="formCommonSql"/>,a.*
		  FROM form f INNER JOIN f_project_financial_redeem_apply a ON f.form_id = a.form_id
		  			  INNER JOIN project_financial p ON a.project_code = p.project_code
		  			  LEFT JOIN project_financial_trade_redeem t on a.apply_id = t.apply_id
		 <include refid="projectPermissionSql"/>
	     WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
	     <dynamic>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.apply_id = #applyId#
           </isGreaterThan>	  	     
             <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code = #projectCode#
            </isNotEmpty>
              <isNotEmpty property="productName" prepend=" and ">
                p.product_name like concat('%',#productName#,'%')
            </isNotEmpty>           
            <isNotEmpty property="formStatus" prepend=" and ">
            	<!-- 已赎回 -->
            	<isEqual property="formStatus" compareValue="REDEEMED">
            		 t.trade_id > 0
            	</isEqual>
            	<!-- 其他表单状态 -->
               	<isNotEqual property="formStatus" compareValue="REDEEMED">
               		f.status = #formStatus#
               		and (t.trade_id is null or t.trade_id = 0)
               	</isNotEqual>
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
              <![CDATA[f.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
              <![CDATA[f.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
            <isNotEmpty property="redeemTimeStart" prepend=" and ">
              <![CDATA[t.redeem_time >= #redeemTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="redeemTimeEnd" prepend=" and ">
              <![CDATA[t.redeem_time <= #redeemTimeEnd# ]]>
            </isNotEmpty>
            <isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>
        </dynamic>                            				
         <isNotEmpty property="sortCol" prepend=" order by ">
             $sortCol$
                <isNotEmpty property="sortOrder">
             	 		$sortOrder$
            	</isNotEmpty>
         </isNotEmpty>
         LIMIT #limitStart#,#pageSize#;
    </select>
    
	<!-- 理财项目赎回单列表count -->
    <select id="MS-EXTRA-FINANCIAL-PROJECT-REDEEM-SEARCH-COUNT" resultClass="long">
		SELECT
			   count(*)
		  FROM form f INNER JOIN f_project_financial_redeem_apply a ON f.form_id = a.form_id
		  			  INNER JOIN project_financial p ON a.project_code = p.project_code
		  			  LEFT JOIN project_financial_trade_redeem t on a.apply_id = t.apply_id
		 <include refid="projectPermissionSql"/>
	     WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
	     <dynamic>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.apply_id = #applyId#
           </isGreaterThan>	  	     
             <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code = #projectCode#
            </isNotEmpty>
             <isNotEmpty property="productName" prepend=" and ">
                p.product_name like concat('%',#productName#,'%')
            </isNotEmpty>            
            <isNotEmpty property="formStatus" prepend=" and ">
            	<!-- 已赎回 -->
            	<isEqual property="formStatus" compareValue="REDEEMED">
            		 t.trade_id > 0
            	</isEqual>
            	<!-- 其他表单状态 -->
               	<isNotEqual property="formStatus" compareValue="REDEEMED">
               		f.status = #formStatus#
               		and (t.trade_id is null or t.trade_id = 0)
               	</isNotEqual>
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
              <![CDATA[f.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
              <![CDATA[f.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
            <isNotEmpty property="redeemTimeStart" prepend=" and ">
              <![CDATA[t.redeem_time >= #redeemTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="redeemTimeEnd" prepend=" and ">
              <![CDATA[t.redeem_time <= #redeemTimeEnd# ]]>
            </isNotEmpty>
			<isNotEmpty property="formStatusList" prepend=" and ">
             		f.status in 
    			<iterate property="formStatusList" conjunction="," open="(" close=")">
             		#formStatusList[]#
    			 </iterate>
			</isNotEmpty>            
        </dynamic>                           				
    </select>    
    	

	<!-- 合同列表 -->
	<select id="MS-EXTRA-PROJECT-CONTRACT-SEARCH" resultMap="RM-PROJECT-CONTRACT-PROJECT">
        SELECT
        <isNotEmpty property="chooseProject">
            0 AS contract_id,0 AS id,"" AS signed_time,"" AS contract_code,"" AS contract_code2,"" AS contract_name,"" as contract_status,"" AS contract_type,"" AS credit_measure,"" AS cnt,"" as raw_add_time,"" as is_main,"" as basis_of_decision,"" as letter_type,"" as contract_scan_url,"" as file_url,"" as court_ruling_url,"" as remark,0 as num,"" as is_need_stamp,
        </isNotEmpty>
        <isEmpty property="chooseProject">
        fpci.contract_id,fpci.id,fpci.signed_time,fpci.contract_code,CONCAT('CQEXG',fpci.contract_code2) as contract_code2,fpci.contract_name,fpci.contract_status,fpci.contract_type,fpci.credit_measure,fpci.cnt,fpci.is_main ,ifnull(fpci.raw_update_time,fpci.raw_add_time) as raw_add_time,fpci.basis_of_decision,fpci.letter_type,fpci.contract_scan_url,fpci.file_url,fpci.court_ruling_url,fpci.remark,ifnull(i.num,0) as num,fpci.is_need_stamp,
        </isEmpty>
        p.status as project_status,p.busi_type,p.loaned_amount,p.is_court_ruling as project_court_ruling,p.busi_type_name,fpc.customer_name,fpc.project_code,fpc.project_name,fpc.free_flow,
        <include refid="formCommonSql"/>
        FROM f_project_contract fpc LEFT JOIN
        form f ON fpc.form_id=f.form_id LEFT JOIN
        project p on fpc.project_code=p.project_code
        <isEmpty property="chooseProject">
        LEFT JOIN f_project_contract_item fpci
        ON fpc.contract_id=fpci.contract_id
            LEFT    JOIN <!-- 是否作废的标志查询 -->
            (
            SELECT COUNT(*) AS num,p2.project_code FROM project p2 WHERE p2.is_court_ruling="IS" AND p2.busi_type ='211'  GROUP BY p2.project_code
            UNION ALL
            SELECT COUNT(*) AS num,p2.project_code FROM project_issue_information p2 WHERE p2.busi_type LIKE '12%'  GROUP BY p2.project_code
            UNION ALL
            SELECT 0 AS num,p2.project_code FROM project p2 WHERE P2.busi_type LIKE '5%' GROUP BY p2.project_code
            UNION ALL
            SELECT COUNT(*) AS num,fl.project_code FROM f_loan_use_apply fl JOIN project p2 ON fl.project_code=p2.project_code JOIN form f2 ON fl.form_id=f2.form_id WHERE  (p2.busi_type!='211' AND p2.busi_type NOT LIKE '12%' AND p2.busi_type NOT LIKE '5%')  AND f2.status !='DELETED'  GROUP BY p2.project_code
            ) i
            ON fpc.project_code=i.project_code
        </isEmpty>
        <include refid="projectPermissionSql"/>
        WHERE 1=1 and f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
            <isEmpty property="chooseProject">
			<isNotEmpty property="customerName" prepend=" and ">
				fpc.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="contractCode" prepend=" and ">
				fpci.contract_code like concat('%',#contractCode#,'%')
			</isNotEmpty>
                <isNotEmpty property="contractCode2" prepend=" and ">
                    CONCAT('CQEXG',fpci.contract_code2) like concat('%',#contractCode2#,'%')
                </isNotEmpty>
			<isNotEmpty property="contractName" prepend=" and ">
				fpci.contract_name like concat('%',#contractName#,'%')
			</isNotEmpty>
            <isNotEmpty property="contractStatus" prepend=" and ">
                fpci.contract_status = #contractStatus#
            </isNotEmpty>
            <isNotEmpty property="exceptContractStatus" prepend=" and ">
                fpci.contract_status != #exceptContractStatus#
            </isNotEmpty>
            <isNotEmpty property="likeContractCodeOrNmae" prepend=" and ">
                fpci.contract_code like concat('%',#likeContractCodeOrNmae#,'%')
                or
                fpci.contract_name like concat('%',#likeContractCodeOrNmae#,'%')
            </isNotEmpty>
                <isNotEmpty property="isMain" prepend=" and ">
                    <isEqual property="isMain" compareValue="IS">
                        fpci.is_main =#isMain#
                    </isEqual>
                    <isEqual property="isMain" compareValue="NO">
                        (fpci.is_main =#isMain# or fpci.is_main ='' or fpci.is_main is null)
                    </isEqual>
                </isNotEmpty>
            <isNotEmpty property="letterType" prepend=" and ">
                fpci.letter_type =#letterType#
            </isNotEmpty>
                <isNotEmpty property="remark" prepend=" and ">
                    fpci.remark like concat('%',#remark#,'%')
                </isNotEmpty>
            <isNotEmpty property="isChargeNotification" prepend=" and ">
                <isEqual property="isChargeNotification" compareValue="IS">
                    fpci.signed_time is not null and fpci.signed_time != ''
                </isEqual>
            </isNotEmpty>
            </isEmpty>
            <isNotEmpty property="applyType" prepend=" and ">
                <isEqual property="applyType" compareValue="PROJECT_CONTRACT">
                    ( fpc.apply_type =#applyType# or fpc.apply_type is  null or fpc.apply_type = '')
                </isEqual>
                <isNotEqual property="applyType" compareValue="PROJECT_CONTRACT">
                    fpc.apply_type =#applyType#
                </isNotEqual>
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                fpc.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                fpc.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                fpc.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
				p.busi_type =#busiType#
			</isNotEmpty>
			<isNotEmpty property="operateTimeStart" prepend=" and ">
                <![CDATA[fpc.raw_add_time >= #operateTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="operateTimeEnd" prepend=" and ">
				<![CDATA[fpc.raw_add_time <= #operateTimeEnd# ]]>
			</isNotEmpty>
		</dynamic>
        <isNotEmpty property="chooseProject">
            GROUP BY fpc.project_code
        </isNotEmpty>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY raw_add_time desc
        </isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>

	<!-- 合同列表 统计-->
	<select id="MS-EXTRA-PROJECT-CONTRACT-SEARCH-COUNT" resultClass="long">
		SELECT count(*)
		FROM (select
        0 AS contract_id,0 AS id,"" AS signed_time,"" AS contract_code,"" AS contract_code2,"" AS contract_name,"" ascontract_status,"" AS contract_type,"" AS credit_measure,"" AS cnt,
        p.status AS project_status,p.busi_type,p.loaned_amount,p.busi_type_name,fpc.customer_name,fpc.project_code,fpc.project_name,"" AS raw_add_time,
        <include refid="formCommonSql"/>
        from
        f_project_contract fpc LEFT JOIN
		form f ON fpc.form_id=f.form_id LEFT JOIN
		project p on fpc.project_code=p.project_code
        <isEmpty property="chooseProject">
            LEFT JOIN f_project_contract_item fpci
            ON fpc.contract_id=fpci.contract_id
        </isEmpty>
        <include refid="projectPermissionSql"/>
		WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isEmpty property="chooseProject">
                <isNotEmpty property="customerName" prepend=" and ">
                    fpc.customer_name like concat('%',#customerName#,'%')
                </isNotEmpty>
                <isNotEmpty property="contractCode" prepend=" and ">
                    fpci.contract_code like concat('%',#contractCode#,'%')
                </isNotEmpty>
                <isNotEmpty property="contractCode2" prepend=" and ">
                    CONCAT('CQEXG',fpci.contract_code2) like concat('%',#contractCode2#,'%')
                </isNotEmpty>
                <isNotEmpty property="contractName" prepend=" and ">
                    fpci.contract_name like concat('%',#contractName#,'%')
                </isNotEmpty>
                <isNotEmpty property="contractStatus" prepend=" and ">
                    fpci.contract_status = #contractStatus#
                </isNotEmpty>
                <isNotEmpty property="exceptContractStatus" prepend=" and ">
                    fpci.contract_status != #exceptContractStatus#
                </isNotEmpty>
                <isNotEmpty property="likeContractCodeOrNmae" prepend=" and ">
                    fpci.contract_code like concat('%',#likeContractCodeOrNmae#,'%')
                    or
                    fpci.contract_name like concat('%',#likeContractCodeOrNmae#,'%')
                </isNotEmpty>
                <isNotEmpty property="isMain" prepend=" and ">
                    <isEqual property="isMain" compareValue="IS">
                        fpci.is_main =#isMain#
                    </isEqual>
                    <isEqual property="isMain" compareValue="NO">
                        (fpci.is_main =#isMain# or fpci.is_main ='' or fpci.is_main is null)
                    </isEqual>
                </isNotEmpty>
                <isNotEmpty property="letterType" prepend=" and ">
                    fpci.letter_type =#letterType#
                </isNotEmpty>
                <isNotEmpty property="remark" prepend=" and ">
                    fpci.remark like concat('%',#remark#,'%')
                </isNotEmpty>
                <isNotEmpty property="isChargeNotification" prepend=" and ">
                    <isEqual property="isChargeNotification" compareValue="IS">
                        fpci.signed_time is not null and fpci.signed_time != ''
                    </isEqual>
                </isNotEmpty>
            </isEmpty>
            <isNotEmpty property="applyType" prepend=" and ">
                <isEqual property="applyType" compareValue="PROJECT_CONTRACT">
                   ( fpc.apply_type =#applyType# or fpc.apply_type is  null or fpc.apply_type = '')
                </isEqual>
                <isNotEqual property="applyType" compareValue="PROJECT_CONTRACT">
                    fpc.apply_type =#applyType#
                </isNotEqual>
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                fpc.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                fpc.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                fpc.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
                p.busi_type =#busiType#
            </isNotEmpty>
            <isNotEmpty property="operateTimeStart" prepend=" and ">
                <![CDATA[fpc.raw_add_time >= #operateTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="operateTimeEnd" prepend=" and ">
                <![CDATA[fpc.raw_add_time <= #operateTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="chooseProject">
            GROUP BY fpc.project_code
        </isNotEmpty>
        ) A
	</select>


    <!-- 合同作废列表 -->
    <select id="MS-EXTRA-PROJECT-CONTRACT-INVALID-SEARCH" resultMap="RM-PROJECT-CONTRACT-INVALID">
        SELECT
        d.id,d.project_code,d.project_name,d.customer_name,d.contract_code,d.contract_name,d.raw_add_time,p.busi_type,p.busi_type_name,
        <include refid="formCommonSql"/>
        FROM f_project_contract_item_invalid d  JOIN
        form f ON d.form_id=f.form_id  JOIN
        project p on d.project_code=p.project_code
        <include refid="projectPermissionSql"/>
        WHERE 1=1 and f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
                <isNotEmpty property="contractCode" prepend=" and ">
                    d.contract_code like concat('%',#contractCode#,'%')
                </isNotEmpty>
                <isNotEmpty property="contractName" prepend=" and ">
                    d.contract_name like concat('%',#contractName#,'%')
                </isNotEmpty>
                <isNotEmpty property="likeContractCodeOrNmae" prepend=" and ">
                    d.contract_code like concat('%',#likeContractCodeOrNmae#,'%')
                    or
                    d.contract_name like concat('%',#likeContractCodeOrNmae#,'%')
                </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                d.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                d.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                d.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
                p.busi_type =#busiType#
            </isNotEmpty>
            <isNotEmpty property="contractStatus" prepend=" and ">
                f.status = #contractStatus#
            </isNotEmpty>
            <isNotEmpty property="operateTimeStart" prepend=" and ">
                <![CDATA[d.raw_add_time >= #operateTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="operateTimeEnd" prepend=" and ">
                <![CDATA[d.raw_add_time <= #operateTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 合同作废列表 统计-->
    <select id="MS-EXTRA-PROJECT-CONTRACT-INVALID-SEARCH-COUNT" resultClass="long">
        SELECT count(*)
        FROM f_project_contract_item_invalid d  JOIN
        form f ON d.form_id=f.form_id  JOIN
        project p on d.project_code=p.project_code
        <include refid="projectPermissionSql"/>
        WHERE 1=1 and f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isNotEmpty property="contractCode" prepend=" and ">
                d.contract_code like concat('%',#contractCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="contractName" prepend=" and ">
                d.contract_name like concat('%',#contractName#,'%')
            </isNotEmpty>
            <isNotEmpty property="likeContractCodeOrNmae" prepend=" and ">
                d.contract_code like concat('%',#likeContractCodeOrNmae#,'%')
                or
                d.contract_name like concat('%',#likeContractCodeOrNmae#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                d.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                d.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                d.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
                p.busi_type =#busiType#
            </isNotEmpty>
            <isNotEmpty property="contractStatus" prepend=" and ">
                f.status = #contractStatus#
            </isNotEmpty>
            <isNotEmpty property="operateTimeStart" prepend=" and ">
                <![CDATA[d.raw_add_time >= #operateTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="operateTimeEnd" prepend=" and ">
                <![CDATA[d.raw_add_time <= #operateTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>

    </select>
	
	
	<!-- 保后检查列表 -->
    <select id="MS-EXTRA-AFTERWARDS-CHECK-F-PROJECT-SEARCH" resultMap="RM-AFTERWARDS-CHECK-F-PROJECT">
 		  SELECT <include refid="formCommonSql"/>, 
 			   <include refid="projectCommonSql"/> , c.raw_add_time  afterwards_check_add_time, c.id afterwards_check_id,
 			   c.check_date,c.check_address, c.edition,c.rounds,c.used_amount,c.repayed_amount
		 	  FROM f_afterwards_check c LEFT JOIN form f ON f.form_id = c.form_id 
		INNER JOIN project p ON p.project_code = c.project_code
			WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
 	        <dynamic>
	        
	            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
	                c.customer_id = #customerId#
	            </isGreaterThan>
	            <isGreaterThan property="riskManagerId"  compareValue="0" prepend=" and ">
	                p.risk_manager_id = #riskManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
	             <isNotEmpty property="projectCode" prepend=" and ">
	               	p.project_code = #projectCode#
	            </isNotEmpty>
	             <isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	            </isNotEmpty>
	             <isNotEmpty property="loanType" prepend=" and ">
	               	p.loan_type = #loanType#
	            </isNotEmpty>
	             <isNotEmpty property="projectName" prepend=" and ">
	               	p.project_name like concat('%',#projectName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="customerName" prepend=" and ">
	               	c.customer_name like concat('%',#customerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="riskManagerName" prepend=" and ">
	               	p.risk_manager_name like concat('%',#riskManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerName" prepend=" and ">
	               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerbName" prepend=" and ">
	               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeStart" prepend=" and ">
	                <![CDATA[c.raw_add_time >= #submitTimeStart# ]]>
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeEnd" prepend=" and ">
	                <![CDATA[c.raw_add_time <= #submitTimeEnd# ]]>
	            </isNotEmpty>
	        </dynamic>
	         <isNotEmpty property="sortCol" prepend=" order by ">
	             $sortCol$
	                <isNotEmpty property="sortOrder">
              	 		$sortOrder$
             		</isNotEmpty>
	         </isNotEmpty>
           	<isGreaterThan property="pageSize" compareValue="0" prepend="">
				LIMIT #limitStart#,#pageSize# 
			</isGreaterThan>
    </select>
    
    <!-- 保后检查列表 统计-->
    <select id="MS-EXTRA-AFTERWARDS-CHECK-F-PROJECT-SEARCH-COUNT" resultClass="long">
 		SELECT count(*)
		 	  FROM f_afterwards_check c LEFT JOIN form f ON f.form_id = c.form_id 
		INNER JOIN project p ON p.project_code = c.project_code
			WHERE f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
	            <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
	                c.customer_id = #customerId#
	            </isGreaterThan>
	            <isGreaterThan property="riskManagerId"  compareValue="0" prepend=" and ">
	                p.risk_manager_id = #riskManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
	             <isNotEmpty property="projectCode" prepend=" and ">
	               	p.project_code = #projectCode#
	            </isNotEmpty>
	             <isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	            </isNotEmpty>
	             <isNotEmpty property="loanType" prepend=" and ">
	               	p.loan_type = #loanType#
	            </isNotEmpty>
	             <isNotEmpty property="projectName" prepend=" and ">
	               	p.project_name like concat('%',#projectName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="customerName" prepend=" and ">
	               	c.customer_name like concat('%',#customerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="riskManagerName" prepend=" and ">
	               	p.risk_manager_name like concat('%',#riskManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerName" prepend=" and ">
	               	p.busi_manager_name like concat('%',#busiManagerName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="busiManagerbName" prepend=" and ">
	               	p.busi_managerb_name like concat('%',#busiManagerbName#,'%')
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeStart" prepend=" and ">
	                <![CDATA[c.raw_add_time >= #submitTimeStart# ]]>
	            </isNotEmpty>
	             <isNotEmpty property="submitTimeEnd" prepend=" and ">
	                <![CDATA[c.raw_add_time <= #submitTimeEnd# ]]>
	            </isNotEmpty>
	        </dynamic>
    </select>
	<!--  授信条件落实表单项目列表 -->
    <select id="MS-EXTRA-FORM-PROJECT-CREDIT-SEARCH" resultMap="RM-FORM-CREDIT-CONDITION-PROJECT">
 		 SELECT <include refid="projectCommonSql"/>,<include refid="formCommonSql"/>,c.*,p.status as project_status
 		  FROM f_credit_condition_confirm c LEFT JOIN form f ON f.form_id = c.form_id INNER JOIN project p ON p.project_code = c.project_code 
		 <include refid="projectPermissionSql"/>
		 WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>		
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	          </isNotEmpty>
	          <isNotEmpty property="isMargin" prepend=" and ">
	               	c.is_margin = #isMargin#
	          </isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY form_add_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   <!-- 授信条件落实表单项目列表统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-CREDIT-SEARCH-COUNT" resultClass="long">
		  SELECT count(*)
		FROM f_credit_condition_confirm i LEFT JOIN form f ON f.form_id = i.form_id INNER JOIN project p ON p.project_code = i.project_code 
		<include refid="projectPermissionSql"/>
		 WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<!--  SELECT count(*) FROM project p WHERE p.project_code IN (SELECT project_code FROM f_credit_condition_confirm pii)
		 and 1=1 -->
		<dynamic>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	          </isNotEmpty>
	          <isNotEmpty property="isMargin" prepend=" and ">
	               	c.is_margin = #isMargin#
	          </isNotEmpty>
		</dynamic>
	</select>
<!--  授信条件落实 选择项目列表 -->
    <select id="MS-EXTRA-FORM-CREDIT-AND-PROJECT-SEARCH" resultMap="RM-CREDIT-CONDITION-PROJECT">
 		 SELECT p.* FROM project p LEFT JOIN f_project_contract_item f on  p.contract_no = f.contract_code 
 		 <include refid="projectPermissionSql"/>
 		 WHERE 
 			((p.contract_no IS NOT NULL AND f.is_main='IS' AND f.signed_time IS NOT NULL AND (f.contract_status="SEAL" or f.contract_status="RETURN")) OR p.is_redo_project = 'IS')
 			 and p.project_code IN (SELECT project_code FROM project_credit_condition pcc WHERE pcc.is_confirm='NO' and (pcc.status='NOT_APPLY' or pcc.status='CHECK_PASS') AND pcc.contract_no IS NOT NULL)
		<dynamic>
				<isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="projectCodeOrName" prepend=" and ">
              (p.project_code like concat('%',#projectCodeOrName#,'%') 
              	OR p.project_name like concat('%',#projectCodeOrName#,'%') )
           </isNotEmpty> 			
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="phasesStatus" prepend=" and ">
						 p.phases_status in 
						<iterate property="phasesStatus" open="(" close=")" conjunction=",">
							#phasesStatus[]#
						</iterate>
				</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.raw_update_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   <!-- 授信条件落实 选择项目列表统计 -->
	<select id="MS-EXTRA-FORM-CREDIT-AND-PROJECT-COUNT" resultClass="long">
	 SELECT count(*) FROM project p LEFT JOIN f_project_contract_item f on  p.contract_no = f.contract_code 
            <include refid="projectPermissionSql"/>	
  WHERE 
 	((p.contract_no IS NOT NULL AND f.is_main='IS' AND f.signed_time IS NOT NULL AND (f.contract_status="SEAL" or f.contract_status="RETURN")) OR p.is_redo_project = 'IS')
 	AND p.project_code IN (SELECT project_code FROM project_credit_condition pcc WHERE pcc.is_confirm='NO' and (pcc.status='NOT_APPLY' or pcc.status='CHECK_PASS') AND pcc.contract_no IS NOT NULL)
		  <!--  SELECT count(*) FROM project p WHERE p.project_code IN (SELECT project_code FROM project_credit_condition pcc)
		 AND 1=1-->
		<!--  SELECT count(*) FROM project p WHERE p.project_code IN (SELECT project_code FROM f_credit_condition_confirm pii)
		 and 1=1 -->
		<dynamic>
				<isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>	
            <isNotEmpty property="projectCodeOrName" prepend=" and ">
              (p.project_code like concat('%',#projectCodeOrName#,'%') 
              	OR p.project_name like concat('%',#projectCodeOrName#,'%') )
           </isNotEmpty>  					
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="phasesStatus" prepend=" and ">
						 p.phases_status in 
						<iterate property="phasesStatus" open="(" close=")" conjunction=",">
							#phasesStatus[]#
						</iterate>
				</isNotEmpty>
		</dynamic>
	</select>
	<!-- 常用数据库字段维护列表 -->
	<select id="MS-EXTRA-DB-FIELD-SEARCH" resultMap="RM-DB-FIELD">
		SELECT dt.table_id,dt.table_name,dt.table_for_short,dt.project_phase,dt.table_for_short,
		df.field_id,df.field_name,df.field_for_short,df.remark,df.raw_add_time
		FROM db_field df LEFT JOIN db_table dt
		ON df.table_id = dt.table_id
        WHERE 1=1 AND df.is_delete="NO"
		<dynamic>
			<isNotEmpty property="tableName" prepend=" and ">
				dt.table_name LIKE CONCAT('%',#tableName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fieldName" prepend=" and ">
				df.field_name LIKE CONCAT('%',#fieldName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectPhase" prepend=" and ">
				dt.project_phase = #projectPhase#
			</isNotEmpty>
		</dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY dt.table_id desc
        </isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>

	<!-- 常用数据库字段维护列表 统计-->
	<select id="MS-EXTRA-DB-FIELD-SEARCH-COUNT" resultClass="long">
		SELECT count(*) FROM db_field df LEFT JOIN db_table dt
		ON df.table_id = dt.table_id
        WHERE 1=1 AND df.is_delete="NO"
			<dynamic>
				<isNotEmpty property="tableName" prepend=" and ">
					dt.table_name LIKE CONCAT('%',#tableName#,'%')
				</isNotEmpty>
				<isNotEmpty property="fieldName" prepend=" and ">
					df.field_name LIKE CONCAT('%',#fieldName#,'%')
				</isNotEmpty>
				<isNotEmpty property="projectPhase" prepend=" and ">
					dt.project_phase = #projectPhase#
				</isNotEmpty>
			</dynamic>
	</select>
	<!--  承销/发债已发售项目列表 -->
    <select id="MS-EXTRA-FORM-PROJECT-ISSUE-SEARCH" resultMap="RM-ISSUE-INFORMATION-PROJECT">
		 SELECT p.* FROM project p <include refid="projectPermissionSql"/> WHERE p.project_code IN (SELECT project_code FROM project_issue_information pii)
		
		 AND 1=1
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.raw_update_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   <!-- 承销/发债已发售项目列表统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-ISSUE-SEARCH-COUNT" resultClass="long">
		SELECT count(*) FROM project p <include refid="projectPermissionSql"/> 
		WHERE p.project_code IN (SELECT project_code FROM project_issue_information pii)
		AND 1=1 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
		</dynamic>
	</select>
<!--  承销发售项目  选择列表(排除已发售过的项目) -->
    <select id="MS-EXTRA-FORM-PROJECT-CONSIGNMENT-SALES-SEARCH" resultMap="RM-PROJECT">
		 SELECT pr.* FROM project pr WHERE pr.project_code NOT IN (SELECT p.project_code FROM project p WHERE p.project_code IN (SELECT project_code FROM project_issue_information pii))
		 AND 1=1 and p.status = 'NORMAL'
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				pr.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				pr.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				pr.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				pr.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	             pr.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="isContinue" prepend=" and ">
	               	pr.is_continue like concat('%',#isContinue#,'%')
	          </isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY pr.raw_update_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   <!-- 承销已发售项目列表统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-CONSIGNMENT-SALES-SEARCH-COUNT" resultClass="long">
		SELECT count(*) FROM project pr WHERE pr.project_code NOT IN (SELECT p.project_code FROM project p WHERE p.project_code IN (SELECT project_code FROM project_issue_information pii))
		 AND 1=1 and p.status = 'NORMAL'
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				pr.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				pr.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				pr.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				pr.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	             pr.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="isContinue" prepend=" and ">
	               	pr.is_continue like concat('%',#isContinue#,'%')
	          </isNotEmpty>
		</dynamic>
	</select>
<!--  发债发售项目  选择列表(排除已发售过的项目 和合同未签订的项目) -->
    <select id="MS-EXTRA-FORM-PROJECT-BOND-SEARCH" resultMap="RM-ISSUE-INFORMATION-PROJECT">
		 SELECT * FROM project p
		 <include refid="projectPermissionSql"/> 
		WHERE (p.is_redo_project = 'IS' OR (p.contract_no IS NOT NULL AND p.contract_no !='')) 
 	  	  AND NOT EXISTS (SELECT * FROM project_issue_information iss WHERE p.project_code = iss.project_code)		
		<dynamic>
			<isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			
			<isNotEmpty property="busiType" prepend=" and ">
	             p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="isContinue" prepend=" and ">
	               	p.is_continue like concat('%',#isContinue#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="phasesStatus" prepend=" and ">
						 p.phases_status in 
						<iterate property="phasesStatus" open="(" close=")" conjunction=",">
							#phasesStatus[]#
						</iterate>
				</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.raw_update_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    <!--  发债发售项目  选择列表统计(排除已发售过的项目 和合同未签订的项目) -->
	<select id="MS-EXTRA-FORM-PROJECT-BOND-SEARCH-COUNT" resultClass="long">
		SELECT count(*) FROM project p
		<include refid="projectPermissionSql"/>  
		WHERE (p.is_redo_project = 'IS' OR (p.contract_no IS NOT NULL AND p.contract_no !='')) 
 	  	  AND NOT EXISTS (SELECT * FROM project_issue_information iss WHERE p.project_code = iss.project_code)		
		<dynamic>
			<isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	             p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="isContinue" prepend=" and ">
	               	p.is_continue like concat('%',#isContinue#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="phasesStatus" prepend=" and ">
						 p.phases_status in 
						<iterate property="phasesStatus" open="(" close=")" conjunction=",">
							#phasesStatus[]#
						</iterate>
				</isNotEmpty>
		</dynamic>
	</select>
	<!--  同意发行通知书  列表 -->
    <select id="MS-EXTRA-FORM-PROJECT-CONSENT-ISSUE-NOTICE-LIST-SEARCH" resultMap="RM-CONSENT-ISSUE-NOTICE-PROJECT">
		SELECT * FROM consent_issue_notice c
		LEFT JOIN project p ON c.project_code=p.project_code 
		<include refid="projectPermissionSql"/>
		where p.project_code=c.project_code
     	and 1=1
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				c.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				c.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				c.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				c.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				c.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	             c.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="isUploadReceipt" prepend=" and ">
	             c.is_upload_receipt = #isUploadReceipt#
	          </isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY c.raw_update_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    <!--  同意发行通知书  列表统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-CONSENT-ISSUE-NOTICE-LIST-COUNT" resultClass="long">
		SELECT count(*) FROM consent_issue_notice c
		LEFT JOIN project p ON c.project_code=p.project_code 
		<include refid="projectPermissionSql"/>
		where p.project_code=c.project_code
     	and 1=1
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	             p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="isUploadReceipt" prepend=" and ">
	             c.is_upload_receipt = #isUploadReceipt#
	          </isNotEmpty>
		</dynamic>
	</select>
	<!--  同意发行通知书  选择列表(排除已发行过的项目、合同未签订的项目和项目已发售完成的项目) -->
    <select id="MS-EXTRA-FORM-PROJECT-CONSENT-ISSUE-NOTICE-SEARCH" resultMap="RM-CONSENT-ISSUE-NOTICE-SEARCH-PROJECT">
     	<!--  SELECT * FROM project p 
		<include refid="projectPermissionSql"/>
 	 WHERE 
  		(p.is_continue='NO' OR p.is_continue IS NULL) and
 		p.contract_no IS NOT NULL AND p.contract_time IS NOT NULL AND p.project_code NOT IN 
  		(SELECT pr.project_code FROM project pr ,
     		(SELECT * FROM consent_issue_notice) c where pr.project_code=c.project_code)
     	and 1=1 -->
     	SELECT * FROM project p 
		<include refid="projectPermissionSql"/>
 		 WHERE 
  	  (p.is_continue='NO' OR p.is_continue IS NULL) AND	(p.is_maximum_amount='IS' OR 
  		((p.is_maximum_amount IS NULL OR p.is_maximum_amount='NO') AND p.amount>p.accumulated_issue_amount))  
  		and
 		p.contract_no IS NOT NULL AND p.contract_time IS NOT NULL AND p.project_code NOT IN 
  		(SELECT pr.project_code FROM project pr ,
     		(SELECT * FROM consent_issue_notice) c where pr.project_code=c.project_code)
     	and 1=1 and p.status = 'NORMAL'
		<dynamic>
				<isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	             p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="phasesStatus" prepend=" and ">
						 p.phases_status in 
						<iterate property="phasesStatus" open="(" close=")" conjunction=",">
							#phasesStatus[]#
						</iterate>
				</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.raw_update_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    <!--  同意发行通知书  选择列表统计(排除已发行过的项目、合同未签订的项目和项目已发售完成的项目) -->
	<select id="MS-EXTRA-FORM-PROJECT-CONSENT-ISSUE-NOTICE-SEARCH-COUNT" resultClass="long">
		
     	<!-- SELECT count(*) FROM project p 
		<include refid="projectPermissionSql"/>
 	 WHERE 
  		(p.is_continue='NO' OR p.is_continue IS NULL) and
 		p.contract_no IS NOT NULL AND p.contract_time IS NOT NULL AND p.project_code NOT IN 
  		(SELECT pr.project_code FROM project pr ,
     		(SELECT * FROM consent_issue_notice) c where pr.project_code=c.project_code)
     	and 1=1 -->
     	SELECT count(*) FROM project p 
		<include refid="projectPermissionSql"/>
     	WHERE 
  	  (p.is_continue='NO' OR p.is_continue IS NULL) AND	(p.is_maximum_amount='IS' OR 
  		((p.is_maximum_amount IS NULL OR p.is_maximum_amount='NO') AND p.amount>p.accumulated_issue_amount))  
  		and
 		p.contract_no IS NOT NULL AND p.contract_time IS NOT NULL AND p.project_code NOT IN 
  		(SELECT pr.project_code FROM project pr ,
     		(SELECT * FROM consent_issue_notice) c where pr.project_code=c.project_code)
     	and 1=1 and p.status = 'NORMAL'
		<dynamic>
	          <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	             p.busi_type like concat(#busiType#,'%')
	          </isNotEmpty>
	          <isNotEmpty property="phasesStatus" prepend=" and ">
						 p.phases_status in 
						<iterate property="phasesStatus" open="(" close=")" conjunction=",">
							#phasesStatus[]#
						</iterate>
				</isNotEmpty>
		</dynamic>
	</select>

    <!--档案选择项目-->
    <select id="MS-EXTRA-FILE-SELECT-PROJECT-SEARCH" resultMap="RM-PROJECT">
        SELECT * FROM project p
        <isGreaterThan property="busiManagerId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #busiManagerId# AND user_type = 'BUSI_MANAGER' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r1
            ON r1.project_code = p.project_code AND r1.rnum > 0
        </isGreaterThan>
        <isGreaterThan property="busiManagerbId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #busiManagerbId# AND user_type = 'BUSI_MANAGERB' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r2
            ON r2.project_code = p.project_code AND r2.rnum > 0
        </isGreaterThan>
        <isGreaterThan property="legalManagerId"  compareValue="0">
           LEFT JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #legalManagerId# AND user_type = 'LEGAL_MANAGER' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r3
            ON r3.project_code = p.project_code
        </isGreaterThan>
        <isGreaterThan property="riskManagerId"  compareValue="0">
            LEFT JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #riskManagerId# AND user_type = 'RISK_MANAGER' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r4
            ON r4.project_code = p.project_code
        </isGreaterThan>
        where 1=1 AND (IF(p.busi_type=211,is_court_ruling ='IS',
        <isNotEmpty property="isHasLoanAmount" prepend="  ">
            <isEqual property="isHasLoanAmount" compareValue="IS">
                p.loaned_amount > 0
            </isEqual>
            <isEqual property="isHasLoanAmount" compareValue="NO">
                1=1
            </isEqual>
        </isNotEmpty>
        )   OR p.is_redo_project='IS')
        <dynamic>
            <isGreaterThan property="legalManagerId"  compareValue="0" prepend=" and "> <!--项目移交-->
                 (r3.rnum > 0 or p.busi_manager_id=#legalManagerId#)
            </isGreaterThan>
            <isGreaterThan property="riskManagerId"  compareValue="0" prepend=" and ">
                (r4.rnum > 0)
            </isGreaterThan>
            <isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <!--<isNotEmpty property="isHasLoanAmount" prepend=" and ">-->
                <!--<isEqual property="isHasLoanAmount" compareValue="IS">-->
                    <!--p.loaned_amount > 0-->
                <!--</isEqual>-->
                <!--<isEqual property="isHasLoanAmount" compareValue="NO">-->
                    <!--1=1-->
                <!--</isEqual>-->
            <!--</isNotEmpty>-->
            <isNotEmpty property="phases" prepend=" and ">
                p.phases in
                <iterate property="phases" open="(" close=")" conjunction=",">
                    #phases[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="busiTypeList" prepend=" and ">
                <iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
                    p.busi_type like concat(#busiTypeList[]#,'%')
                </iterate>
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY p.project_id DESC
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>
    <!--档案选择项目统计-->
    <select id="MS-EXTRA-FILE-SELECT-PROJECT-SEARCH-COUNT" resultClass="long">
        SELECT COUNT(*) FROM project p
        <isGreaterThan property="busiManagerId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #busiManagerId# AND user_type = 'BUSI_MANAGER' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r1
            ON r1.project_code = p.project_code AND r1.rnum > 0
        </isGreaterThan>
        <isGreaterThan property="busiManagerbId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #busiManagerbId# AND user_type = 'BUSI_MANAGERB' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r2
            ON r2.project_code = p.project_code AND r2.rnum > 0
        </isGreaterThan>
        <isGreaterThan property="legalManagerId"  compareValue="0">
           LEFT JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #legalManagerId# AND user_type = 'LEGAL_MANAGER' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r3
            ON r3.project_code = p.project_code
        </isGreaterThan>
        <isGreaterThan property="riskManagerId"  compareValue="0">
            LEFT JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
            WHERE user_id = #riskManagerId# AND user_type = 'RISK_MANAGER' AND is_current = 'IS' AND is_del = 'NO'  GROUP BY project_code) r4
            ON r4.project_code = p.project_code
        </isGreaterThan>
        where 1=1 AND (IF(p.busi_type=211,is_court_ruling ='IS',
        <isNotEmpty property="isHasLoanAmount" prepend="  ">
            <isEqual property="isHasLoanAmount" compareValue="IS">
                p.loaned_amount > 0
            </isEqual>
            <isEqual property="isHasLoanAmount" compareValue="NO">
                1=1
            </isEqual>
        </isNotEmpty>
        ) OR p.is_redo_project='IS')
        <dynamic>
            <isGreaterThan property="legalManagerId"  compareValue="0" prepend=" and "> <!--项目移交-->
                (r3.rnum > 0 or p.busi_manager_id=#legalManagerId#)
            </isGreaterThan>
            <isGreaterThan property="riskManagerId"  compareValue="0" prepend=" and ">
                (r4.rnum > 0)
            </isGreaterThan>
            <isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <!--<isNotEmpty property="isHasLoanAmount" prepend=" and ">-->
                <!--<isEqual property="isHasLoanAmount" compareValue="IS">-->
                    <!--p.loaned_amount > 0-->
                <!--</isEqual>-->
            <!--</isNotEmpty>-->
            <isNotEmpty property="phases" prepend=" and ">
                p.phases in
                <iterate property="phases" open="(" close=")" conjunction=",">
                    #phases[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="busiTypeList" prepend=" and ">
                <iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
                    p.busi_type like concat(#busiTypeList[]#,'%')
                </iterate>
            </isNotEmpty>
        </dynamic>
    </select>

    
	<!-- 档案列表 -->
	<select id="MS-EXTRA-FILE-FORM-SEARCH" resultMap="RM-FILE-FORM-PROJECT">
        SELECT
        * FROM
        (
        SELECT
        form_id,form_code,form_name,form_url,act_inst_id,run_id,def_id,act_def_id,task_id,detail_status,B.status,user_id,user_account,user_name,form_dept_id,form_dept_name,form_dept_code,form_dept_path,form_dept_path_name,check_status,submit_time,finish_time,form_add_time,form_update_time,related_project_code,task_user_data,remark,trace,
        B.file_code,B.old_file_code,B.project_code,B.project_name,B.type,B.customer_name,B.raw_add_time,B.apply_man_id,B.detail_id,B.apply_type
        FROM(
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ff.raw_add_time,0 as apply_man_id,0 as detail_id,
        "入库申请" AS apply_type
        FROM f_file ff
        LEFT JOIN form f ON ff.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffo.raw_add_time,ffo.apply_man_id,ffo.output_detail_ids as detail_id,
        "出库申请" AS apply_type
        FROM  f_file_output ffo
        LEFT JOIN f_file ff  ON  ff.file_id=ffo.file_id
        LEFT JOIN form f ON ffo.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_OUTPUT_APPLY'
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffo.raw_add_time,ffo.apply_man_id,ffo.output_detail_ids as detail_id,
        "查阅申请" AS apply_type
        FROM  f_file_output ffo
        LEFT JOIN f_file ff  ON  ff.file_id=ffo.file_id
        LEFT JOIN form f ON ffo.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_VIEW_APPLY' AND f.user_id != #draftUserId#
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ffb.file_code,ffb.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffb.raw_add_time,ffb.apply_man_id,0 as detail_id,
        "借阅申请" AS apply_type
        FROM  f_file_borrow ffb
        LEFT JOIN f_file ff  ON  ff.file_id=ffb.file_id
        LEFT JOIN form f ON ffb.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_BORROW_APPLY'  AND f.user_id != #draftUserId#
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffb.raw_add_time,ffb.apply_man_id,0 as detail_id,
        "归还申请" AS apply_type
        FROM  f_file_borrow ffb
        LEFT JOIN f_file ff  ON  ff.file_id=ffb.file_id
        LEFT JOIN form f ON ffb.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_RETURN_APPLY'
        ) B LEFT JOIN project p  ON B.project_code=p.project_code
        <isNotEmpty property="isFileAdmin" prepend="  ">
            <isEqual property="isFileAdmin"  compareValue="NO" prepend="  ">
                <include refid="projectPermissionSql"/>
            </isEqual>
        </isNotEmpty>
		WHERE 1=1 and B.status != 'DELETED'  AND (B.status != 'DRAFT' OR B.user_id = #draftUserId#)
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffo.raw_add_time,ffo.apply_man_id,ffo.output_detail_ids as detail_id,
        "查阅申请" AS apply_type
        FROM  f_file_output ffo
        LEFT JOIN f_file ff  ON  ff.file_id=ffo.file_id
        LEFT JOIN form f ON ffo.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_VIEW_APPLY' AND f.status != 'DELETED'    AND f.status != 'DRAFT' AND f.user_id = #draftUserId#
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ffb.file_code,ffb.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffb.raw_add_time,ffb.apply_man_id,0 as detail_id,
        "借阅申请" AS apply_type
        FROM  f_file_borrow ffb
        LEFT JOIN f_file ff  ON  ff.file_id=ffb.file_id
        LEFT JOIN form f ON ffb.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_BORROW_APPLY' AND f.status != 'DELETED'    AND f.status != 'DRAFT' AND f.user_id = #draftUserId#
        )A where 1=1
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				A.project_code LIKE CONCAT('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				A.customer_name LIKE CONCAT('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileCode" prepend=" and ">
				A.file_code LIKE CONCAT('%',#fileCode#,'%')
			</isNotEmpty>
            <isNotEmpty property="oldFileCode" prepend=" and ">
                A.old_file_code LIKE CONCAT('%',#oldFileCode#,'%')
            </isNotEmpty>
			<isNotEmpty property="fileName" prepend=" and ">
				A.file_name LIKE CONCAT('%',#fileName#,'%')
			</isNotEmpty>
            <isNotEmpty property="fileType" prepend=" and ">
                A.type = #fileType#
            </isNotEmpty>
			<isNotEmpty property="formStatus" prepend="and">
				A.status = #formStatus#
			</isNotEmpty>
            <isNotEmpty property="applyType" prepend=" and ">
                A.apply_type = #applyType#
            </isNotEmpty>
            <isGreaterThan property="applyManId" compareValue="0" prepend="and ">
                A.apply_man_id = #applyManId#
            </isGreaterThan>
            <isGreaterThan property="detailId" compareValue="0" prepend=" and ">
                FIND_IN_SET(#detailId#,A.detail_id)
            </isGreaterThan>
            <isNotEmpty property="startTime" prepend=" and ">
                <![CDATA[A.raw_add_time >= #startTime# ]]>
            </isNotEmpty>
            <isNotEmpty property="endTime" prepend=" and ">
                <![CDATA[A.raw_add_time <= #endTime# ]]>
            </isNotEmpty>
		</dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY A.raw_add_time DESC
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>

	<!-- 档案列表 统计 -->
	<select id="MS-EXTRA-FILE-FORM-SEARCH-COUNT" resultClass="long">
		SELECT count(*) FROM (
        SELECT
        form_id,form_code,form_name,form_url,act_inst_id,run_id,def_id,act_def_id,task_id,detail_status,B.status,user_id,user_account,user_name,form_dept_id,form_dept_name,form_dept_code,form_dept_path,form_dept_path_name,check_status,submit_time,finish_time,form_add_time,form_update_time,related_project_code,task_user_data,remark,trace,
        B.file_code,B.old_file_code,B.project_code,B.project_name,B.type,B.customer_name,B.raw_add_time,B.apply_type
        FROM(
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ff.raw_add_time,
        "入库申请" AS apply_type
        FROM f_file ff
        LEFT JOIN form f ON ff.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffo.raw_add_time,
        "出库申请" AS apply_type
        FROM  f_file_output ffo
        LEFT JOIN f_file ff  ON  ff.file_id=ffo.file_id
        LEFT JOIN form f ON ffo.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_OUTPUT_APPLY'
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffo.raw_add_time,
        "查阅申请" AS apply_type
        FROM  f_file_output ffo
        LEFT JOIN f_file ff  ON  ff.file_id=ffo.file_id
        LEFT JOIN form f ON ffo.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_VIEW_APPLY' AND f.user_id != #draftUserId#
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ffb.file_code,ffb.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffb.raw_add_time,
        "借阅申请" AS apply_type
        FROM  f_file_borrow ffb
        LEFT JOIN f_file ff  ON  ff.file_id=ffb.file_id
        LEFT JOIN form f ON ffb.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_BORROW_APPLY' AND f.user_id != #draftUserId#
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffb.raw_add_time,
        "归还申请" AS apply_type
        FROM  f_file_borrow ffb
        LEFT JOIN f_file ff  ON  ff.file_id=ffb.file_id
        LEFT JOIN form f ON ffb.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_RETURN_APPLY'
        ) B LEFT JOIN project p  ON B.project_code=p.project_code
        <isNotEmpty property="isFileAdmin" prepend="  ">
            <isEqual property="isFileAdmin"  compareValue="NO" prepend="  ">
                <include refid="projectPermissionSql"/>
            </isEqual>
        </isNotEmpty>
        WHERE 1=1 and B.status != 'DELETED'    AND (B.status != 'DRAFT' OR B.user_id = #draftUserId#)
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ff.file_code,ff.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffo.raw_add_time,
        "查阅申请" AS apply_type
        FROM  f_file_output ffo
        LEFT JOIN f_file ff  ON  ff.file_id=ffo.file_id
        LEFT JOIN form f ON ffo.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_VIEW_APPLY' AND f.status != 'DELETED'    AND f.status != 'DRAFT' AND f.user_id = #draftUserId#
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        ffb.file_code,ffb.old_file_code,ff.project_code,ff.project_name,ff.type,
        ff.customer_name,ffb.raw_add_time,
        "借阅申请" AS apply_type
        FROM  f_file_borrow ffb
        LEFT JOIN f_file ff  ON  ff.file_id=ffb.file_id
        LEFT JOIN form f ON ffb.form_id=f.form_id
        LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.form_code='FILE_BORROW_APPLY' AND f.status != 'DELETED'    AND f.status != 'DRAFT' AND f.user_id = #draftUserId#
        ) A where 1=1
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				A.project_code
				LIKE CONCAT('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				A.customer_name LIKE CONCAT('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="fileCode" prepend=" and ">
				A.file_code LIKE
				CONCAT('%',#fileCode#,'%')
			</isNotEmpty>
            <isNotEmpty property="oldFileCode" prepend=" and ">
                A.old_file_code LIKE CONCAT('%',#oldFileCode#,'%')
            </isNotEmpty>
			<isNotEmpty property="fileName" prepend=" and ">
				A.file_name LIKE
				CONCAT('%',#fileName#,'%')
			</isNotEmpty>
            <isNotEmpty property="fileType" prepend=" and ">
                A.type = #fileType#
            </isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				A.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="applyType" prepend=" and ">
				A.apply_type = #applyType#
			</isNotEmpty>
            <isNotEmpty property="startTime" prepend=" and ">
                <![CDATA[A.raw_add_time >= #startTime# ]]>
            </isNotEmpty>
            <isNotEmpty property="endTime" prepend=" and ">
                <![CDATA[A.raw_add_time <= #endTime# ]]>
            </isNotEmpty>
		</dynamic>
	</select>

    <!-- 展期列表 -->
    <select id="MS-EXTRA-FILE-EXTENSION-SEARCH" resultMap="RM-FILE-EXTENSION-FORM-PROJECT">
        SELECT
        <include refid="formCommonSql"/>,
        p.project_code,p.project_name,p.extension_date,p.reason,
        p.customer_name,p.raw_add_time
        FROM f_file_output_extension p
        JOIN form f ON p.form_id=f.form_id
        <include refid="projectPermissionSql"/>
        WHERE  f.status != 'DELETED'  AND f.status != 'DRAFT' AND f.user_id = #draftUserId#
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="formStatus" prepend="and">
                f.status = #formStatus#
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY p.raw_add_time DESC
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 展期列表 统计 -->
    <select id="MS-EXTRA-FILE-EXTENSION-SEARCH-COUNT" resultClass="long">
        SELECT count(*) FROM
          f_file_output_extension p
        JOIN form f ON p.form_id=f.form_id
        <include refid="projectPermissionSql"/>
        WHERE  f.status != 'DELETED'    AND f.status != 'DRAFT' AND f.user_id = #draftUserId#
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code
                LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
                f.status = #formStatus#
            </isNotEmpty>
        </dynamic>
    </select>

    <!--档案出入库记录-->
    <select id="MS-EXTRA-FILE-IN-OUT-FORM-SEARCH" resultMap="RM-FILE-IN-OUT-FORM-PROJECT">
        SELECT
        <include refid="formCommonSql"/>,
        "入库申请" AS apply_type,IFNULL(ffil.raw_update_time,ffil.raw_add_time) AS status_update_time,ff.raw_add_time
        FROM f_file ff LEFT JOIN form f ON ff.form_id=f.form_id
        LEFT JOIN f_file_input_list ffil ON
        ff.file_id=ffil.file_id WHERE ffil.input_list_id=#inputListId#
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        "出库申请" AS apply_type,IFNULL(o.raw_update_time,o.raw_add_time) AS status_update_time,o.raw_add_time
        FROM f_file_output o LEFT JOIN form f ON o.form_id=f.form_id
        WHERE   FIND_IN_SET(#inputListId#,o.output_detail_ids) AND f.form_code='FILE_OUTPUT_APPLY'
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        "查阅申请" AS apply_type,IFNULL(o.raw_update_time,o.raw_add_time) AS status_update_time,o.raw_add_time
        FROM f_file_output o LEFT JOIN form f ON o.form_id=f.form_id
        WHERE   FIND_IN_SET(#inputListId#,o.output_detail_ids) AND f.form_code='FILE_VIEW_APPLY'
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        "借阅申请" AS apply_type,IFNULL(o.raw_update_time,o.raw_add_time) AS status_update_time,o.raw_add_time
        FROM f_file_borrow o LEFT JOIN form f ON o.form_id=f.form_id where FIND_IN_SET(#inputListId#,o.borrow_detail_id)
        AND f.form_code='FILE_BORROW_APPLY'
        UNION ALL
        SELECT
        <include refid="formCommonSql"/>,
        "归还申请" AS apply_type,IFNULL(o.raw_update_time,o.raw_add_time) AS status_update_time,o.raw_add_time
        FROM f_file_borrow o LEFT JOIN form f ON o.form_id=f.form_id where FIND_IN_SET(#inputListId#,o.borrow_detail_id)
        AND f.form_code='FILE_RETURN_APPLY'
    </select>

    <!-- 档案明细列表 -->
    <select id="MS-EXTRA-FILE-DETAIL-FORM-SEARCH" resultMap="RM-FILE-DETAIL-FORM-PROJECT">
        SELECT <include refid="formCommonSql"/>,ff.file_id,ff.project_code,ff.project_name,ff.customer_name,ff.file_code,ff.type,
        p.right_voucher_exten_date,<![CDATA[DATE_FORMAT(SYSDATE(),'%Y-%m-%d')  <= DATE_FORMAT(p.right_voucher_exten_date,'%Y-%m-%d')  ]]> is_in_exten_date,ffil.input_list_id,ffil.file_path,ffil.file_name,ffil.status as file_status,ffil.archive_file_name,ffil.no,ffil.curr_borrow_man_id,IFNULL(ffil.raw_update_time,ffil.raw_add_time) as raw_add_time
        <isNotEmpty property="isFileAdmin" prepend="  ">
        <isEqual property="isFileAdmin" compareValue="NO" prepend="  ">
        <isEqual property="isXinhui" compareValue="NO" prepend="  ">
            <isGreaterThan property="loginUserId"  compareValue="0">
                 ,rl.rnum
            </isGreaterThan>
            <isNotEmpty property="deptIdList">
                ,rl.rnum
            </isNotEmpty>
            <isLessEqual property="loginUserId"  compareValue="0">
                <isEmpty property="deptIdList">
                ,1 as rnum
                </isEmpty>
            </isLessEqual>
            <isEmpty property="deptIdList">
                <isLessEqual property="loginUserId"  compareValue="0">
                ,1 as rnum
                </isLessEqual>
            </isEmpty>
        </isEqual>
        <isEqual property="isXinhui" compareValue="IS" prepend="  ">
                 ,1 as rnum
        </isEqual>
        </isEqual>
        <isEqual property="isFileAdmin" compareValue="IS" prepend="  ">
                 ,1 as rnum
        </isEqual>
        </isNotEmpty>
        <isEmpty property="isFileAdmin" prepend="  ">
                 ,1 as rnum
        </isEmpty>

        FROM f_file_input_list ffil
        LEFT JOIN f_file ff ON ffil.file_id=ff.file_id
        LEFT JOIN form f ON ff.form_id=f.form_id
        LEFT JOIN project p  ON ff.project_code=p.project_code
        <isNotEmpty property="isFileAdmin" prepend="  ">
            <isEqual property="isFileAdmin" compareValue="NO" prepend="  ">
                <isNotEmpty property="isXinhui" prepend="  ">
                    <isEqual property="isXinhui" compareValue="IS" prepend="  ">
                        <include refid="projectPermissionSql"/>
                    </isEqual>
                    <isEqual property="isXinhui" compareValue="NO" prepend="  ">
                        <isNotEmpty property="deptIdList">
                            LEFT JOIN (SELECT COUNT(*) rnum,project_code  FROM project_related_user
                            WHERE is_del = 'NO' AND 
                            (dept_id in
	                            <iterate property="deptIdList" open="(" close=")" conjunction=",">
	                                #deptIdList[]#
	                            </iterate>
	                            <isGreaterThan property="loginUserId"  compareValue="0" prepend=" OR ">
	                            	(user_id = #loginUserId#
		                            <isNotEmpty property="relatedRoleList" prepend=" and ">
		                                user_type in
		                                <iterate property="relatedRoleList" open="(" close=")" conjunction=",">
		                                    #relatedRoleList[]#
		                                </iterate>
		                            </isNotEmpty>)	                            	
	                            </isGreaterThan>
	                         )
                            GROUP BY project_code) rl
                            ON rl.project_code = p.project_code
                        </isNotEmpty>
                    	<isEmpty property="deptIdList">
	                        <isGreaterThan property="loginUserId"  compareValue="0">
	                            LEFT JOIN (SELECT COUNT(*) rnum,project_code FROM project_related_user
	                            WHERE user_id = #loginUserId# AND is_del = 'NO'
	                            <isNotEmpty property="relatedRoleList" prepend=" and ">
	                                user_type in
	                                <iterate property="relatedRoleList" open="(" close=")" conjunction=",">
	                                    #relatedRoleList[]#
	                                </iterate>
	                            </isNotEmpty>
	                            GROUP BY project_code) rl
	                            ON rl.project_code = p.project_code
	                        </isGreaterThan>
                        </isEmpty>
                    </isEqual>
                </isNotEmpty>
            </isEqual>
        </isNotEmpty>
        WHERE 1=1 and (ffil.status is not null or ffil.status!='')  AND f.status!='DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isNotEmpty property="isXinhui" prepend="  ">
                <isEqual property="isXinhui"  compareValue="IS" prepend="  ">
                    <isNotEmpty property="xinhuiDeptCode" prepend=" and ">
                        p.dept_code=#xinhuiDeptCode#
                    </isNotEmpty>
                </isEqual>
                <isEqual property="isXinhui"  compareValue="NO" prepend="  ">
                    <isNotEmpty property="xinhuiDeptCode" prepend=" and ">
                        p.dept_code !=#xinhuiDeptCode#
                    </isNotEmpty>
                </isEqual>
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                ff.project_code LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                ff.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileCode" prepend=" and ">
                ff.file_code LIKE CONCAT('%',#fileCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileType" prepend=" and ">
                ff.type = #fileType#
            </isNotEmpty>
            <isNotEmpty property="fileName" prepend=" and ">
                ffil.file_name LIKE CONCAT('%',#fileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="archiveFileName" prepend=" and ">
                ffil.archive_file_name LIKE CONCAT('%',#archiveFileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                ffil.status = #status#
            </isNotEmpty>
            <isNotEmpty property="startTime" prepend=" and ">
                <![CDATA[A.raw_add_time >= #startTime# ]]>
            </isNotEmpty>
            <isNotEmpty property="endTime" prepend=" and ">
                <![CDATA[A.raw_add_time <= #endTime# ]]>
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY ffil.raw_add_time DESC
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 档案明细列表 统计-->
    <select id="MS-EXTRA-FILE-DETAIL-FORM-SEARCH-COUNT" resultClass="long">
        SELECT count(*)
        FROM f_file_input_list ffil
        LEFT JOIN f_file ff ON ffil.file_id=ff.file_id
        LEFT JOIN form f ON ff.form_id=f.form_id
        LEFT JOIN project p  ON ff.project_code=p.project_code
        <isNotEmpty property="isFileAdmin" prepend="  ">
            <isEqual property="isFileAdmin" compareValue="NO" prepend="  ">
                <isNotEmpty property="isXinhui" prepend="  ">
                    <isEqual property="isXinhui" compareValue="IS" prepend="  ">
                        <include refid="projectPermissionSql"/>
                    </isEqual>
                </isNotEmpty>
            </isEqual>
        </isNotEmpty>
        WHERE 1=1 and (ffil.status is not null or ffil.status!='') AND f.status!='DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isNotEmpty property="isXinhui" prepend="  ">
                <isEqual property="isXinhui"  compareValue="IS" prepend="  ">
                    <isNotEmpty property="xinhuiDeptCode" prepend=" and ">
                        p.dept_code=#xinhuiDeptCode#
                    </isNotEmpty>
                </isEqual>
                <isEqual property="isXinhui"  compareValue="NO" prepend="  ">
                    <isNotEmpty property="xinhuiDeptCode" prepend=" and ">
                        p.dept_code !=#xinhuiDeptCode#
                    </isNotEmpty>
                </isEqual>
            </isNotEmpty>

            <isNotEmpty property="projectCode" prepend=" and ">
                ff.project_code LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                ff.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileCode" prepend=" and ">
                ff.file_code LIKE CONCAT('%',#fileCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileName" prepend=" and ">
                ffil.file_name LIKE CONCAT('%',#fileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="archiveFileName" prepend=" and ">
                ffil.archive_file_name LIKE CONCAT('%',#archiveFileName#,'%')
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                ffil.status = #status#
            </isNotEmpty>
        </dynamic>
    </select>

    <!-- 档案一览表 -->
    <select id="MS-EXTRA-FILE-VIEW-SEARCH" resultMap="RM-FILE-PROJECT-VIEW">
        SELECT ff.customer_name,ff.project_code,ff.project_name,p.busi_manager_name,MAX(ff.update_time) as update_time
        FROM f_file ff
        LEFT JOIN form f ON ff.form_id=f.form_id LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.status!='DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                ff.project_code LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                ff.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                ff.project_name LIKE CONCAT('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiManagerName" prepend=" and ">
                p.busi_manager_name LIKE CONCAT('%',#busiManagerName#,'%')
            </isNotEmpty>
        </dynamic>
        GROUP BY project_code
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY ff.update_time DESC
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 档案一览表 统计-->
    <select id="MS-EXTRA-FILE-VIEW-SEARCH-COUNT" resultClass="long">
       SELECT COUNT(*) FROM ( SELECT ff.customer_name,ff.project_code,ff.project_name,p.busi_manager_name,MAX(ff.update_time) as update_time
        FROM f_file ff
        LEFT JOIN form f ON ff.form_id=f.form_id LEFT JOIN project p ON ff.project_code=p.project_code
        WHERE f.status!='DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                ff.project_code LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                ff.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                ff.project_name LIKE CONCAT('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiManagerName" prepend=" and ">
                p.busi_manager_name LIKE CONCAT('%',#busiManagerName#,'%')
            </isNotEmpty>
        </dynamic>
        GROUP BY project_code) A
    </select>

    <!-- 查询需要发消息的档案 -->
    <select id="MS-EXTRA-NEED-MESSAGE-FILE-SEARCH" resultMap="RM-NEED-MESSAGE-FILE">
        SELECT  ff.file_code,ff.project_code,ff.project_name,
        b.hand_over_man_id,b.hand_over_man,b.receive_man_id,b.receive_man,b.expect_return_time
        FROM f_file_input_list il
        LEFT JOIN f_file ff
        ON il.file_id=ff.file_id
        LEFT JOIN form f
        ON ff.form_id=f.form_id
        LEFT JOIN f_file_borrow b
        ON il.curr_borrow_id=b.id
        WHERE   il.status='BORROW' AND f.status!='DELETED' AND il.curr_borrow_man_id>0
    </select>

    <!-- 查询需要提醒归档的项目 -->
    <select id="MS-EXTRA-NEED-MESSAGE-PROJECT-SEARCH" resultMap="RM-FILE-NEED-MESSAGE-PROJECT">
        SELECT MIN(a.apply_id) as apply_id,p.*,f.submit_time,r.actual_loan_time
        FROM  form f LEFT JOIN  f_loan_use_apply a ON f.form_id =a.form_id
        LEFT JOIN project p ON a.project_code = p.project_code
        LEFT JOIN f_loan_use_apply_receipt r ON a.apply_id = r.apply_id WHERE
        NOT EXISTS (SELECT project_code FROM f_file b WHERE a.project_code=b.project_code and b.type=#type#)
        <isEmpty property="statusList" prepend=" and ">
        r.id > 0
        </isEmpty>
        <isNotEmpty property="statusList" prepend=" and ">
            f.status not in
            <iterate property="statusList" conjunction="," open="(" close=")">
                #statusList[]#
            </iterate>
        </isNotEmpty>
        GROUP BY project_code HAVING MIN(a.apply_id)>0
    </select>

    <!-- 查询该项目没有审核过的档案明细 -->
    <select id="MS-EXTRA-FILE-NOT-ARCHIVE-SEARCH" resultMap="RM-FILE-NOT-ARCHIVE">
        SELECT * FROM f_file_list ffl WHERE ffl.id  NOT IN (
        SELECT ffil.id FROM
        f_file ff LEFT JOIN f_file_input_list ffil
        ON ffil.file_id=ff.file_id
        LEFT JOIN form f ON f.form_id= ff.form_id
        WHERE ff.project_code=#projectCode# AND f.status NOT IN("DELETED")
        <!--AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)-->
        AND ff.type=#type#
        )
        <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
             ffl.id  NOT IN (
            SELECT id FROM f_file_input_list ffil LEFT JOIN
            f_file ff ON ffil.file_id=ff.file_id WHERE ff.form_id=#formId# AND ff.type=#type#
            )
        </isGreaterThan>
        AND ffl.type=#type#
        ORDER BY sort_order asc
    </select>

    <!-- 查询该项目已经归档过的档案明细 -->
    <select id="MS-EXTRA-FILE-ARCHIVED-SEARCH" resultMap="RM-FILE-ARCHIVED">
        SELECT ffil.*,f.status as form_status,ff.file_code FROM
        f_file ff LEFT JOIN f_file_input_list ffil
        ON ffil.file_id=ff.file_id
        LEFT JOIN form f ON f.form_id= ff.form_id
        WHERE ff.project_code=#projectCode# AND f.status !="DELETED"
        <!-- AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)-->
        AND ff.type=#type#
        <isNotEmpty property="notNeedDraft"  prepend=" and " >
            f.status !="DRAFT"
        </isNotEmpty>
        <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
            ffil.input_list_id  NOT IN (
        SELECT input_list_id FROM f_file_input_list ffil LEFT JOIN
        f_file ff ON ffil.file_id=ff.file_id WHERE ff.form_id=#formId# AND ff.type=#type#
        )
        </isGreaterThan>
        <isNotEmpty property="no" prepend=" and ">
            ffil.no  = #no#
        </isNotEmpty>
        ORDER BY ffil.input_list_id
    </select>

    <!-- 查询当前档案编号当前卷的最大件号 -->
    <select id="MS-EXTRA-FILE-MAX-NO-SERACH" resultClass="long">
        SELECT MAX(ffil.no) FROM f_file ff
        LEFT JOIN form f ON ff.form_id=f.form_id
        LEFT JOIN f_file_input_list ffil ON ffil.file_id=ff.file_id
        WHERE 1=1 AND  f.status!='DELETED' AND
        ff.file_code=#fileCode#
    </select>

    <!-- 查询当前档案编号所有件号，除开本张单子 -->
    <select id="MS-EXTRA-FILE-NOS-SEARCH" resultMap="RM-FILE-DETAIL-FORM-PROJECT">
        SELECT  <include refid="formCommonSql"/>,ff.file_id,ff.project_code,ff.project_name,ff.customer_name,ff.file_code,ff.type,
        "" right_voucher_exten_date,0 is_in_exten_date,ffil.input_list_id,ffil.file_path,ffil.file_name,ffil.status as file_status,ffil.archive_file_name,ffil.no,ffil.curr_borrow_man_id,IFNULL(ffil.raw_update_time,ffil.raw_add_time) as raw_add_time
        ,1 as rnum FROM f_file ff
         JOIN form f ON ff.form_id=f.form_id
        LEFT JOIN f_file_input_list ffil ON ffil.file_id=ff.file_id
        WHERE 1=1 AND  f.status!='DELETED' AND
        ff.file_code=#fileCode# and f.form_id!=#formId#
    </select>

    <!-- 查询当前档案编号当前卷的最大件号 -->
    <select id="MS-EXTRA-CHECK-FILE-CODE" resultClass="long">
        SELECT count(*) FROM f_file ff
        JOIN form f ON ff.form_id=f.form_id
        WHERE 1=1 AND  f.status!='DELETED' AND f.status!='END' AND
        ff.file_code=#fileCode#
    </select>

    <!-- 查询项目归档时间内处理已入库状态的档案id集 -->
    <select id="MS-EXTRA-INPUT-STATUS-FILE-IDS-SERACH" resultClass="String">
        SELECT GROUP_CONCAT(ffil.input_list_id) FROM f_file ff LEFT JOIN f_file_input_list ffil
        ON ffil.file_id=ff.file_id WHERE ff.type=#type# AND ff.project_code=#projectCode# AND ffil.status='INPUT'
        <isNotEmpty property="startTime" prepend=" and ">
            <![CDATA[ff.receive_time >= #startTime# ]]>
        </isNotEmpty>
        <isNotEmpty property="startTime" prepend=" and ">
            <![CDATA[ff.receive_time <= #endTime# ]]>
        </isNotEmpty>
    </select>
    <!-- 统计是否还有合同没有确认 -->
    <select id="MS-EXTRA-IS-ALL-CONFIRM-COUNT" resultClass="long">
        SELECT COUNT(*) FROM f_project_contract_item fpci
        LEFT JOIN f_project_contract fpc
        ON fpci.contract_id=fpc.contract_id
        LEFT JOIN form f ON f.form_id=fpc.form_id
        WHERE 1=1
        AND ( fpc.apply_type ='PROJECT_CONTRACT' or fpc.apply_type is  null or fpc.apply_type = '')
        AND fpci.contract_status!="CONFIRMED"
        AND fpci.contract_status!="SEAL"
        AND fpci.contract_status!="SEALING"
        AND fpci.contract_status!="INVALID"
        AND fpci.contract_status!="RETURN"
        AND f.status != 'DELETED'
        AND fpc.project_code = #value#
    </select>

    <!-- 查询没有确认的合同 -->
    <select id="MS-EXTRA-IS-ALL-CONFIRM-SEARCH" resultMap="RM-PROJECT-CONTRACT-PROJECT">
        SELECT fpci.contract_id,fpci.id,fpci.contract_code,fpci.contract_code2,fpci.contract_name,fpci.contract_status,fpci.contract_type,fpci.credit_measure,fpci.cnt,fpci.is_main,fpci.signed_time,0 as loaned_amount,fpci.basis_of_decision,fpci.letter_type,fpci.contract_scan_url,fpci.file_url,fpci.court_ruling_url,fpci.remark,fpci.is_need_stamp,
        p.status as project_status,p.busi_type,p.busi_type_name,fpc.customer_name,fpc.project_code,fpc.project_name,fpc.free_flow,fpc.raw_add_time,
        <include refid="formCommonSql"/>
        FROM f_project_contract_item fpci
        LEFT JOIN f_project_contract fpc
        ON fpci.contract_id=fpc.contract_id
        LEFT JOIN project p on fpc.project_code=p.project_code
        LEFT JOIN form f ON f.form_id=fpc.form_id
        WHERE 1=1
        AND ( fpc.apply_type ='PROJECT_CONTRACT' or fpc.apply_type is  null or fpc.apply_type = '')
        AND fpci.contract_status!="SEAL"
        AND fpci.contract_status!="SEALING"
        AND fpci.contract_status!="INVALID"
        AND fpci.contract_status!="RETURN"
        AND fpci.cnt!="0"
        AND f.status != 'DELETED'
        AND fpc.project_code = #value#
    </select>


	<!-- 查询列表 -->
	<select id="RM-CREDIT-REFRERENCE-APPLY-PROJECT-SEARCH"
		resultMap="RM-CREDIT-REFRERENCE-APPLY-PROJECT">
		SELECT
        p.id,p.company_name,p.project_code,p.project_name,p.credit_report,p.busi_license_no,p.apply_man_name,p.attachment,p.raw_add_time,
		<include refid="formCommonSql" />
		FROM f_credit_refrerence_apply p
		LEFT JOIN form f ON p.form_id=f.form_id
		<include refid="projectPermissionSql" />
		WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isGreaterThan property="id" compareValue="0" prepend=" and ">
				id = #id#
			</isGreaterThan>
			<isGreaterThan property="formId" compareValue="0" prepend=" and ">
                fcra.form_id = #formId#
			</isGreaterThan>
			<isGreaterThan property="applyManId" compareValue="0"
				prepend=" and ">
				apply_man_id = #applyManId#
			</isGreaterThan>
			<isNotEmpty property="companyName" prepend=" and ">
				company_name like concat('%',#companyName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiLicenseNo" prepend=" and ">
				busi_license_no like concat('%',#busiLicenseNo#,'%')
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="applyManName" prepend=" and ">
				apply_man_name like concat('%',#applyManName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="submitTimeStart" prepend=" and ">
                <![CDATA[raw_add_time >= #submitTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="submitTimeEnd" prepend=" and ">
                <![CDATA[raw_add_time <= #submitTimeEnd# ]]>
			</isNotEmpty>
			<isNotEmpty property="sortCol" prepend=" order by ">
				$sortCol$
				<isNotEmpty property="sortOrder">
					$sortOrder$
				</isNotEmpty>
			</isNotEmpty>
            <isEmpty property="sortCol" prepend=" ">
                ORDER BY p.raw_add_time desc
            </isEmpty>
		</dynamic>
		<isGreaterThan property="pageSize" compareValue="0"
			prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>

	<!-- 征信查询列表 统计 -->
	<select id="MS-CREDIT-REFRERENCE-APPLY-PROJECT-SEARCH-COUNT"
		resultClass="long">
		SELECT count(*) FROM f_credit_refrerence_apply p
		LEFT JOIN form f ON p.form_id=f.form_id
		<include refid="projectPermissionSql" />
		WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isGreaterThan property="id" compareValue="0" prepend=" and ">
				id = #id#
			</isGreaterThan>
			<isGreaterThan property="formId" compareValue="0"
				prepend=" and ">
                p.form_id = #formId#
			</isGreaterThan>
			<isGreaterThan property="applyManId" compareValue="0"
				prepend=" and ">
				apply_man_id = #applyManId#
			</isGreaterThan>
			<isNotEmpty property="companyName" prepend=" and ">
				company_name like concat('%',#companyName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiLicenseNo" prepend=" and ">
				busi_license_no like concat('%',#busiLicenseNo#,'%')
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="applyManName" prepend=" and ">
				apply_man_name like concat('%',#applyManName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="submitTimeStart" prepend=" and ">
                <![CDATA[raw_add_time >= #submitTimeStart# ]]>
			</isNotEmpty>
			<isNotEmpty property="submitTimeEnd" prepend=" and ">
                <![CDATA[raw_add_time <= #submitTimeEnd# ]]>
			</isNotEmpty>
		</dynamic>
	</select>
	
	
	<!-- 客户的征信报告-->
	<select id="RM-NEW-CREDIT-REFRERENCE-APPLY-PROJECT-SEARCH"
		resultMap="RM-CREDIT-REFRERENCE-APPLY-PROJECT">
		SELECT
        p.id,p.company_name,p.project_code,p.project_name,p.credit_report,p.busi_license_no,p.apply_man_name,p.attachment,p.raw_add_time,
		<include refid="formCommonSql" />
		FROM f_credit_refrerence_apply p
		LEFT JOIN form f ON p.form_id=f.form_id
		<include refid="projectPermissionSql" />
		WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="companyName" prepend=" and ">
				company_name like concat('%',#companyName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiLicenseNo" prepend=" and ">
				busi_license_no like concat('%',#busiLicenseNo#,'%') or social_unity_credit_code like  concat('%',#busiLicenseNo#,'%') 
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			 ORDER BY p.raw_add_time desc
		</dynamic>
	</select>
	
	
	<!--弹框 征信查询列表 -->
	<select id="RM-CREDIT-REFRERENCE-LIST-SEARCH"
		resultMap="RM-CREDIT-REFRERENCE-APPLY-PROJECT">
		SELECT
        p.id,p.company_name,p.project_code,p.project_name,p.credit_report,p.busi_license_no,p.apply_man_name,p.attachment,p.raw_add_time,
		<include refid="formCommonSql" />
		FROM f_credit_refrerence_apply p
		LEFT JOIN form f ON p.form_id=f.form_id
		<include refid="projectPermissionSql" />
		WHERE 1=1 AND f.status = 'APPROVAL'
		<dynamic>
			<isNotEmpty property="creditReport" prepend=" and ">
				credit_report is not null 
			</isNotEmpty>
			<isNotEmpty property="companyName" prepend=" and ">
				company_name like concat('%',#companyName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			
			<isNotEmpty property="sortCol" prepend=" order by ">
				$sortCol$
				<isNotEmpty property="sortOrder">
					$sortOrder$
				</isNotEmpty>
			</isNotEmpty>
            <isEmpty property="sortCol" prepend=" ">
                ORDER BY p.raw_add_time desc
            </isEmpty>
		</dynamic>
		<isGreaterThan property="pageSize" compareValue="0"
			prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>
	
	
	<!--弹框 征信查询列表 统计 -->
	<select id="MS-CREDIT-REFRERENCE-LIST-SEARCH-COUNT"
		resultClass="long">
		SELECT count(*) FROM f_credit_refrerence_apply p
		LEFT JOIN form f ON p.form_id=f.form_id
		<include refid="projectPermissionSql" />
		WHERE 1=1 AND f.status = 'APPROVAL'
		<dynamic>
			<isNotEmpty property="companyName" prepend=" and ">
				company_name like concat('%',#companyName#,'%')
			</isNotEmpty>
			<isNotEmpty property="creditReport" prepend=" and ">
				credit_report is not null 
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			
		</dynamic>
	</select>
	

    <!-- 收费通知、函通知书选择项目 -->
    <select id="MS-EXTRA-CHARGE-NOTIFICATION-SELECT-PROJECT" resultMap="RM-PROJECT">
        SELECT
        project.*
        FROM (SELECT
        cnum,
        anum,
        p.*
        FROM project p
        <include refid="projectPermissionSql"/>
        LEFT JOIN (SELECT
        project_code,
        COUNT(*) cnum
        FROM project_credit_condition
        GROUP BY project_code) cnum
        ON cnum.project_code = p.project_code
        LEFT JOIN (SELECT
        c.project_code,
        COUNT(*) anum
        FROM f_credit_condition_confirm c
        JOIN form f
        ON c.form_id = f.form_id
        AND f.status = 'APPROVAL'
        GROUP BY c.project_code) anum
        ON anum.project_code = p.project_code
        WHERE (cnum IS NULL OR anum > 0 OR p.is_redo_project='IS') ) project where 1=1
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                project.project_code = #projectCode#
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                project.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                project.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCodeOrName" prepend=" and ">
                (project.project_code like concat('%',#projectCodeOrName#,'%') OR project.project_name like concat('%',#projectCodeOrName#,'%'))
            </isNotEmpty>
            <isNotEmpty property="phasesStatus" prepend=" and ">
                project.phases_status in
                <iterate property="phasesStatus" open="(" close=")" conjunction=",">
                    #phasesStatus[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
                project.phases in
                <iterate property="phases" open="(" close=")" conjunction=",">
                    #phases[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                project.status in
                <iterate property="status" open="(" close=")" conjunction=",">
                    #status[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="hasContract" prepend=" and ">
                <isEqual property="hasContract" compareValue="IS">
                    ((project.contract_no is not null and project.contract_no != '') OR project.is_redo_project='IS')
                </isEqual>
                <isEqual property="hasContract" compareValue="NO">
                   ((project.contract_no is null or project.contract_no = '') OR project.is_redo_project='IS')
                </isEqual>
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY project.project_id DESC
        </isEmpty>
        LIMIT #limitStart#,#pageSize#;

    </select>

    <!-- 收费 函通知选择项目统计 -->
    <select id="MS-EXTRA-CHARGE-NOTIFICATION-SELECT-PROJECT-COUNT" resultClass="long">

        SELECT
        count(*)
        FROM (SELECT
        cnum,
        anum,
        p.*
        FROM project p
        <include refid="projectPermissionSql"/>
        LEFT JOIN (SELECT
        project_code,
        COUNT(*) cnum
        FROM project_credit_condition
        GROUP BY project_code) cnum
        ON cnum.project_code = p.project_code
        LEFT JOIN (SELECT
        c.project_code,
        COUNT(*) anum
        FROM f_credit_condition_confirm c
        JOIN form f
        ON c.form_id = f.form_id
        AND f.status = 'APPROVAL'
        GROUP BY c.project_code) anum
        ON anum.project_code = p.project_code
        WHERE(cnum IS NULL OR anum > 0 OR p.is_redo_project='IS')) project where 1=1
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                project.project_code = #projectCode#
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                project.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                project.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCodeOrName" prepend=" and ">
                (project.project_code like concat('%',#projectCodeOrName#,'%') OR project.project_name like concat('%',#projectCodeOrName#,'%'))
            </isNotEmpty>
            <isNotEmpty property="phasesStatus" prepend=" and ">
                project.phases_status in
                <iterate property="phasesStatus" open="(" close=")" conjunction=",">
                    #phasesStatus[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
                project.phases in
                <iterate property="phases" open="(" close=")" conjunction=",">
                    #phases[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                project.status in
                <iterate property="status" open="(" close=")" conjunction=",">
                    #status[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty property="hasContract" prepend=" and ">
                <isEqual property="hasContract" compareValue="IS">
                    ((project.contract_no is not null and project.contract_no != '') OR project.is_redo_project='IS')
                </isEqual>
                <isEqual property="hasContract" compareValue="NO">
                    ((project.contract_no is null or project.contract_no = '') OR project.is_redo_project='IS')
                </isEqual>
            </isNotEmpty>
        </dynamic>
    </select>
    <!-- 收费通知列表 -->
    <select id="RM-CHARGE-NOTIFICATION-SEARCH" resultMap="RM-CHARGE-NOTIFICATION-FORM">
        SELECT
        p.charge_basis,p.project_code,p.project_name,p.customer_name,p.submit_man_name,SUM(fcnf.charge_amount) AS charge_amount,SUM(ffad.pay_amount) AS actual_amount,p.raw_add_time,
        <include refid="formCommonSql"/>,
        p1.status as project_status,p1.busi_type,p1.busi_type_name,p.notification_id
        FROM f_charge_notification p
        <include refid="projectPermissionSql"/>
        LEFT JOIN f_charge_notification_fee fcnf
        ON fcnf.notification_id=p.notification_id
        LEFT JOIN project p1
        ON p.project_code=p1.project_code
        LEFT JOIN form f ON p.form_id=f.form_id
        LEFT JOIN f_finance_affirm ffa on ffa.form_id=p.form_id
        LEFT JOIN f_finance_affirm_detail ffad on ffad.affirm_id=ffa.affirm_id and ffad.detail_id=fcnf.id
        WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isNotEmpty property="chargeBasis" prepend=" and ">
                p.charge_basis = #chargeBasis#
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
                p1.busi_type = #busiType#
            </isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
                f.status  = #formStatus#
            </isNotEmpty>
        </dynamic>
        GROUP BY p.notification_id
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY p.raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 收费通知 统计-->
    <select id="MS-CHARGE-NOTIFICATION-SEARCH-COUNT" resultClass="long">
        SELECT COUNT(*) 
        FROM ( SELECT
        	p.*
        	FROM f_charge_notification p
        <include refid="projectPermissionSql"/>
        LEFT JOIN f_charge_notification_fee fcnf
        ON fcnf.notification_id=p.notification_id
        LEFT JOIN project p1
        ON p.project_code=p1.project_code
        LEFT JOIN form f ON p.form_id=f.form_id
        	WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
            <isNotEmpty property="chargeBasis" prepend=" and ">
                p.charge_basis = #chargeBasis#
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
                p1.busi_type = #busiType#
            </isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
                f.status  = #formStatus#
            </isNotEmpty>
        </dynamic>
        GROUP BY p.notification_id) b;
    </select>

    <!-- 收费通知导出 -->
    <select id="RM-CHARGE-NOTIFICATION-EXPORT" resultMap="RM-CHARGE-NOTIFICATION-EXPORT">
       Select * from ( SELECT
            fcn.submit_man_name,fcn.raw_add_time,fcn.notification_id,fcn.charge_basis,fcn.project_code,fcn.project_name,fcn.customer_name, fcn.contract_code,fcn.contract_name,fcn.institution_name,fcn.charge_name,fcn.charge_fee,fcn.charge_type,
            p.busi_type,p.busi_type_name,p.time_limit,p.time_unit,p.contract_amount,p.amount,p.loaned_amount,p.releasable_amount,p.released_amount,p.comp_principal_amount,
            fcnf.charge_base,fcnf.fee_type_desc,fcnf.charge_rate,fcnf.charge_amount,fcnf.start_time,fcnf.end_time,
            ffd.pay_time,ffd.pay_amount as  actual_amount,
            f.status
            FROM  f_charge_notification fcn
            JOIN project p
            ON fcn.project_code = p.project_code
            <include refid="projectPermissionSql"/>
            JOIN form f
            ON f.form_id = fcn.form_id
            LEFT JOIN f_charge_notification_fee fcnf
            ON fcn.notification_id = fcnf.notification_id
            LEFT JOIN f_finance_affirm ff
            ON ff.form_id=fcn.form_id
            LEFT JOIN f_finance_affirm_detail ffd
            ON ff.affirm_id = ffd.affirm_id AND ffd.detail_id=fcnf.id
            WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        UNION ALL
        SELECT
        p.submit_man_name,
        p.raw_add_time,
        p.notification_id,
        p.charge_basis,
        p.project_code,
        p.project_name,
        p.customer_name,
        p.contract_code,
        p.contract_name,
        p.institution_name,
        p.charge_name,
        p.charge_fee,
        p.charge_type,
        "" AS busi_type,
        "" AS busi_type_name,
        0 AS time_limit,
        "" AS time_unit,
        0 AS contract_amount,
        0 AS amount,
        0 AS loaned_amount,
        0 AS releasable_amount,
        0 AS released_amount,
        0 AS comp_principal_amount,
        fcnf.charge_base,
        fcnf.fee_type_desc,
        fcnf.charge_rate,
        fcnf.charge_amount,
        fcnf.start_time,
        fcnf.end_time,
        ffd.pay_time,
        ffd.pay_amount as  actual_amount,
        f.status
        FROM
        f_charge_notification p
        <include refid="projectPermissionSql"/>
        JOIN f_broker_business fb
        ON fb.project_code = p.project_code
        JOIN form f
        ON f.form_id = p.form_id
        LEFT JOIN f_charge_notification_fee fcnf
        ON p.notification_id = fcnf.notification_id
        LEFT JOIN f_finance_affirm ff
        ON ff.form_id = p.form_id
        LEFT JOIN f_finance_affirm_detail ffd
        ON ff.affirm_id = ffd.affirm_id
        AND ffd.detail_id = fcnf.id
        WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        )A where 1=1
        <dynamic>
            <isNotEmpty property="chargeBasis" prepend=" and ">
                A.charge_basis = #chargeBasis#
            </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code like concat('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                A.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                A.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                A.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
                A.busi_type = #busiType#
            </isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
                A.status  = #formStatus#
            </isNotEmpty>
        </dynamic>
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY A.raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 特殊纸作废列表 -->
    <select id="RM-SPECIAL-PAPER-INVALID-SEARCH" resultMap="RM-SPECIAL-PAPER">
        SELECT spn.id,spn.start_no,spn.end_no,CONCAT(start_no,'-', end_no ) AS special_no,spi.keeping_man_name,spi.receive_man_name,spi.remark,spi.receive_date,spi.raw_add_time,
        "" as project_code,"" as project_name,"" as dept_name,"" as profiles,"" as provide_man_name,
        spn.end_no-spn.start_no+1 AS pieces,
        "" as receipt_place,""as receipt_man
        FROM special_paper_invalid spi LEFT JOIN special_paper_no spn
        ON spi.id=spn.source_id
        WHERE 1=1 AND spn.source="INVALID"
        <dynamic>
            <isNotEmpty property="projectName" prepend=" and ">
                project_name = #projectName#
            </isNotEmpty>
            <isNotEmpty property="isSaveInvail" prepend="and ">
                (<![CDATA[start_no<=#startNo# ]]> AND <![CDATA[ end_no>=#startNo#]]> ) OR  (<![CDATA[start_no<=#endNo#]]> AND <![CDATA[end_no>=#endNo#]]>)
            </isNotEmpty>
            <isEmpty property="isSaveInvail" prepend=" ">
            <isGreaterThan property="startNo"  compareValue="0" prepend=" and ">
                start_no = #startNo#
            </isGreaterThan>
            <isGreaterThan property="endNo"  compareValue="0" prepend=" and ">
                end_no = #endNo#
            </isGreaterThan>
            </isEmpty>
            <isNotEmpty property="keepingManName" prepend=" and ">
                spi.keeping_man_name like concat('%',#keepingManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiveManName" prepend=" and ">
                receive_man_name like concat('%',#receiveManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptMan" prepend=" and ">
                receipt_man like concat('%',#receiptMan#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptPlace" prepend=" and ">
                receipt_place like concat('%',#receiptPlace#,'%')
            </isNotEmpty>
            <isNotEmpty property="provideManName" prepend=" and ">
                provide_man_name like concat('%',#provideManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[spi.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[spi.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
            <isNotEmpty property="invalidReceiveDateStart" prepend=" and ">
                <![CDATA[spi.receive_date >= #invalidReceiveDateStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="invalidReceiveDateEnd" prepend=" and ">
                <![CDATA[spi.receive_date <= #invalidReceiveDateEnd# ]]>
            </isNotEmpty>
        </dynamic>

        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 特殊纸作废 统计-->
    <select id="MS-SPECIAL-PAPER-INVALID-SEARCH-COUNT" resultClass="long">
        SELECT COUNT(*) from
        special_paper_invalid spi LEFT JOIN special_paper_no spn
        ON spi.id=spn.source_id
        WHERE 1=1 AND spn.source="INVALID"
        <dynamic>
            <isNotEmpty property="projectName" prepend=" and ">
                project_name = #projectName#
            </isNotEmpty>
            <isGreaterThan property="startNo"  compareValue="0" prepend=" and ">
                start_no = #startNo#
            </isGreaterThan>
            <isGreaterThan property="endNo"  compareValue="0" prepend=" and ">
                end_no = #endNo#
            </isGreaterThan>
            <isNotEmpty property="keepingManName" prepend=" and ">
                spi.keeping_man_name like concat('%',#keepingManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiveManName" prepend=" and ">
                receive_man_name like concat('%',#receiveManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptMan" prepend=" and ">
                receipt_man like concat('%',#receiptMan#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptPlace" prepend=" and ">
                receipt_place like concat('%',#receiptPlace#,'%')
            </isNotEmpty>
            <isNotEmpty property="provideManName" prepend=" and ">
                provide_man_name like concat('%',#provideManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[spi.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[spi.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
            <isNotEmpty property="invalidReceiveDateStart" prepend=" and ">
                <![CDATA[spi.receive_date >= #invalidReceiveDateStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="invalidReceiveDateEnd" prepend=" and ">
                <![CDATA[spi.receive_date <= #invalidReceiveDateEnd# ]]>
            </isNotEmpty>
        </dynamic>
    </select>

    <!-- 特殊纸部门领取列表 -->
    <select id="RM-SPECIAL-PAPER-DEPT-SEARCH" resultMap="RM-SPECIAL-PAPER">
        SELECT sppd.id,spn.start_no,spn.end_no,CONCAT(start_no,'-', end_no ) AS special_no,"" AS keeping_man_name,sppd.receive_man_name,sppd.remark,sppd.raw_add_time,sppd.raw_add_time as receive_date,
        "" as project_code,"" as project_name,sppd.dept_name,"" as profiles,sppd.provide_man_name,
        spn.end_no-spn.start_no+1 AS pieces,
        "" as receipt_place,""as receipt_man
        FROM special_paper_provide_dept sppd  LEFT JOIN special_paper_no spn
        ON sppd.id=spn.source_id
        WHERE 1=1 AND spn.source="PROVIDE_DEPT"
        <dynamic>
            <isNotEmpty property="projectName" prepend=" and ">
                project_name = #projectName#
            </isNotEmpty>
            <isGreaterThan property="startNo"  compareValue="0" prepend=" and ">
                start_no = #startNo#
            </isGreaterThan>
            <isGreaterThan property="endNo"  compareValue="0" prepend=" and ">
                end_no = #endNo#
            </isGreaterThan>
            <isNotEmpty property="keepingManName" prepend=" and ">
                keeping_man_name like concat('%',#keepingManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiveManName" prepend=" and ">
                receive_man_name like concat('%',#receiveManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptMan" prepend=" and ">
                receipt_man like concat('%',#receiptMan#,'%')
            </isNotEmpty>
            <isNotEmpty property="deptName" prepend=" and ">
                dept_name like concat('%',#deptName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptPlace" prepend=" and ">
                receipt_place like concat('%',#receiptPlace#,'%')
            </isNotEmpty>
            <isNotEmpty property="provideManName" prepend=" and ">
                provide_man_name like concat('%',#provideManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[sppd.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[sppd.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>

        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 特殊纸部门领取列表 统计-->
    <select id="MS-SPECIAL-PAPER-DEPT-SEARCH-COUNT" resultClass="long">
        SELECT COUNT(*)
        FROM special_paper_provide_dept sppd  LEFT JOIN special_paper_no spn
        ON sppd.id=spn.source_id
        WHERE 1=1 AND spn.source="PROVIDE_DEPT"
        <dynamic>
            <isNotEmpty property="projectName" prepend=" and ">
                project_name = #projectName#
            </isNotEmpty>
            <isGreaterThan property="startNo"  compareValue="0" prepend=" and ">
                start_no = #startNo#
            </isGreaterThan>
            <isGreaterThan property="endNo"  compareValue="0" prepend=" and ">
                end_no = #endNo#
            </isGreaterThan>
            <isNotEmpty property="keepingManName" prepend=" and ">
                keeping_man_name like concat('%',#keepingManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiveManName" prepend=" and ">
                receive_man_name like concat('%',#receiveManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptMan" prepend=" and ">
                receipt_man like concat('%',#receiptMan#,'%')
            </isNotEmpty>
            <isNotEmpty property="deptName" prepend=" and ">
                dept_name like concat('%',#deptName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptPlace" prepend=" and ">
                receipt_place like concat('%',#receiptPlace#,'%')
            </isNotEmpty>
            <isNotEmpty property="provideManName" prepend=" and ">
                provide_man_name like concat('%',#provideManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[sppd.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[sppd.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>
    </select>

    <!-- 特殊纸明细列表 -->
    <select id="RM-SPECIAL-PAPER-PROJECT-SEARCH" resultMap="RM-SPECIAL-PAPER">
        SELECT sppp.id,spn.start_no,spn.end_no,CONCAT(start_no,'-', end_no ) AS special_no,"" AS keeping_man_name,sppp.receive_man_name,"" AS remark,sppp.raw_add_time,sppp.raw_add_time as receive_date,
        sppp.project_code,sppp.project_name,"" AS dept_name,sppp.profiles,sppp.provide_man_name,
        spn.end_no-spn.start_no+1 AS pieces,
        sppp.receipt_place,sppp.receipt_man
        FROM special_paper_provide_project sppp  LEFT JOIN special_paper_no spn
        ON sppp.id=spn.source_id
        WHERE 1=1 AND spn.source="PROVIDE_PROJECT"
        <dynamic>
            <isNotEmpty property="projectName" prepend=" and ">
                project_name = #projectName#
            </isNotEmpty>
            <isGreaterThan property="startNo"  compareValue="0" prepend=" and ">
                start_no = #startNo#
            </isGreaterThan>
            <isGreaterThan property="endNo"  compareValue="0" prepend=" and ">
                end_no = #endNo#
            </isGreaterThan>
            <isNotEmpty property="keepingManName" prepend=" and ">
                provide_man_name like concat('%',#keepingManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiveManName" prepend=" and ">
                receive_man_name like concat('%',#receiveManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptMan" prepend=" and ">
                receipt_man like concat('%',#receiptMan#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptPlace" prepend=" and ">
                receipt_place like concat('%',#receiptPlace#,'%')
            </isNotEmpty>
            <isNotEmpty property="provideManName" prepend=" and ">
                provide_man_name like concat('%',#provideManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[sppp.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[sppp.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>

        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 特殊纸明细 统计-->
    <select id="MS-SPECIAL-PAPER-PROJECT-SEARCH-COUNT" resultClass="long">
        SELECT COUNT(*)  FROM special_paper_provide_project sppp  LEFT JOIN special_paper_no spn
        ON sppp.id=spn.source_id
        WHERE 1=1
        AND spn.source="PROVIDE_PROJECT"
        <dynamic>
            <isNotEmpty property="projectName" prepend=" and ">
                project_name = #projectName#
            </isNotEmpty>
            <isGreaterThan property="startNo"  compareValue="0" prepend=" and ">
                start_no = #startNo#
            </isGreaterThan>
            <isGreaterThan property="endNo"  compareValue="0" prepend=" and ">
                end_no = #endNo#
            </isGreaterThan>
            <isNotEmpty property="keepingManName" prepend=" and ">
                provide_man_name like concat('%',#keepingManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiveManName" prepend=" and ">
                receive_man_name like concat('%',#receiveManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptMan" prepend=" and ">
                receipt_man like concat('%',#receiptMan#,'%')
            </isNotEmpty>
            <isNotEmpty property="receiptPlace" prepend=" and ">
                receipt_place like concat('%',#receiptPlace#,'%')
            </isNotEmpty>
            <isNotEmpty property="provideManName" prepend=" and ">
                provide_man_name like concat('%',#provideManName#,'%')
            </isNotEmpty>
            <isNotEmpty property="applyTimeStart" prepend=" and ">
                <![CDATA[sppp.raw_add_time >= #applyTimeStart# ]]>
            </isNotEmpty>
            <isNotEmpty property="applyTimeEnd" prepend=" and ">
                <![CDATA[sppp.raw_add_time <= #applyTimeEnd# ]]>
            </isNotEmpty>
        </dynamic>
    </select>

    <!-- 特殊纸作废校验 -->
    <select id="RM-SPECIAL-PAPER-INVALID-CHECK-SEARCH" resultMap="RM-SPECIAL-PAPER">
        SELECT * FROM (SELECT sppd.id,spn.start_no,spn.end_no,CONCAT(start_no,'-', end_no ) AS special_no,"" AS keeping_man_name,sppd.receive_man_name,sppd.remark,sppd.raw_add_time,sppd.raw_add_time AS receive_date,
        "" AS project_code,"" AS project_name,sppd.dept_name,"" AS PROFILES,sppd.provide_man_name,
        spn.end_no-spn.start_no+1 AS pieces,
        "" AS receipt_place,""AS receipt_man
        FROM special_paper_provide_dept sppd  LEFT JOIN special_paper_no spn
        ON sppd.id=spn.source_id
        WHERE 1=1 AND spn.source="PROVIDE_DEPT"

        UNION ALL

        SELECT sppp.id,spn.start_no,spn.end_no,CONCAT(start_no,'-', end_no ) AS special_no,"" AS keeping_man_name,sppp.receive_man_name,"" AS remark,sppp.raw_add_time,sppp.raw_add_time AS receive_date,
        sppp.project_code,sppp.project_name,"" AS dept_name,sppp.profiles,sppp.provide_man_name,
        spn.end_no-spn.start_no+1 AS pieces,
        sppp.receipt_place,sppp.receipt_man
        FROM special_paper_provide_project sppp  LEFT JOIN special_paper_no spn
        ON sppp.id=spn.source_id
        WHERE 1=1 AND spn.source="PROVIDE_PROJECT"
        ) A
        WHERE   (<![CDATA[start_no<=#startNo# ]]> AND <![CDATA[ end_no>=#startNo#]]> ) AND  (<![CDATA[start_no<=#endNo#]]> AND <![CDATA[end_no>=#endNo#]]>)

    </select>

    <!--  资金划付表单项目列表 -->
    <select id="MS-EXTRA-FORM-PROJECT-CAPITAL-APPROPRIATION-SEARCH" resultMap="RM-CAPITAL-APPROPRIATION-PROJECT">
		     <!--SELECT c.*,p.busi_type,p.busi_type_name,<include refid="projectCommonSql"/>,SUM(fc.appropriate_amount) AS appropriate_amount,
 		 f.form_id,f.user_id,f.status as form_status,f.user_name,<include refid="formCommonSql"/>,pf.project_code,pf.project_name,pf.product_type,pf.product_name
     FROM f_capital_appropriation_apply c
 		  Left join f_capital_appropriation_apply_fee fc
 		  on c.apply_id = fc.apply_id
 		   LEFT JOIN form f ON f.form_id = c.form_id
 		   left JOIN project p ON p.project_code = c.project_code 
 		   Left join project_financial pf on pf.project_code = c.project_code
 		   -->
 		    SELECT p.*,SUM(fc.appropriate_amount) AS appropriate_amount,
  			f.form_id,f.user_id,f.STATUS AS form_status,f.user_name,<include refid="formCommonSql"/>
			FROM f_capital_appropriation_apply p
  			LEFT JOIN f_capital_appropriation_apply_fee fc
   			 ON p.apply_id = fc.apply_id
  		LEFT JOIN form f ON f.form_id = p.form_id
   <include refid="projectPermissionSql"/>
		 WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		 
		<dynamic>
			<isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	         </isNotEmpty>
	         <isNotEmpty property="projectType" prepend=" and ">
				p.project_type = #projectType#
			</isNotEmpty>
	         <isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="formUserName" prepend=" and ">
				f.user_name like concat('%',#formUserName#,'%')
			</isNotEmpty>
			<isNotEmpty property="appropriateReasonList" prepend=" and ">
              	fc.appropriate_reason in 
              	<iterate property="appropriateReasonList" conjunction="," open="(" close=")">
              		#appropriateReasonList[]#
              	</iterate>
           </isNotEmpty> 
			<isNotEmpty property="isSimple" prepend=" and ">
               is_simple = #isSimple#
            </isNotEmpty>          
		</dynamic>
		GROUP BY p.apply_id
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   <!-- 资金划付表单项目列表统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-CAPITAL-APPROPRIATION-SEARCH-COUNT" resultClass="long">
		  SELECT count(*)
		FROM (SELECT p.project_code,p.project_name,SUM(fc.appropriate_amount) AS appropriate_amount,
  			<include refid="formCommonSql"/>
			FROM f_capital_appropriation_apply p
  			LEFT JOIN f_capital_appropriation_apply_fee fc
   			 ON p.apply_id = fc.apply_id
  		LEFT JOIN form f ON f.form_id = p.form_id
   			 <include refid="projectPermissionSql"/>
		 WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
          
		<dynamic>
			<isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	         </isNotEmpty>
	         <isNotEmpty property="projectType" prepend=" and ">
				p.project_type = #projectType#
			</isNotEmpty>
	         <isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="formUserName" prepend=" and ">
				f.user_name like concat('%',#formUserName#,'%')
			</isNotEmpty>
			<isNotEmpty property="appropriateReasonList" prepend=" and ">
              	fc.appropriate_reason in 
              	<iterate property="appropriateReasonList" conjunction="," open="(" close=")">
              		#appropriateReasonList[]#
              	</iterate>
           </isNotEmpty>  
			<isNotEmpty property="isSimple" prepend=" and ">
               is_simple = #isSimple#
            </isNotEmpty>         
			GROUP BY p.apply_id) a;
		</dynamic>
	</select>
	<!--  退费申请 表单项目列表 -->
    <select id="MS-EXTRA-FORM-PROJECT-REFUND-APPLICATION-SEARCH" resultMap="RM-REFUND-APPLICATION-PROJECT">
		     SELECT r.*,p.busi_type,p.busi_type_name,SUM(fr.refund_amount) AS refund_amount,
 		 f.status as form_status,<include refid="formCommonSql"/>
     FROM f_refund_application r
 		  Left join f_refund_application_fee fr on r.refund_id = fr.refund_id
 		   LEFT JOIN form f ON f.form_id = r.form_id
 		   left JOIN project p ON p.project_code = r.project_code 
   		<include refid="projectPermissionSql"/>
		 WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				r.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				r.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	         </isNotEmpty>
	         <isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="formUserName" prepend=" and ">
				f.user_name = #formUserName#
			</isNotEmpty>
		</dynamic>
		GROUP BY r.refund_id
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   <!-- 退费申请单项目列表统计 -->
	<select id="MS-EXTRA-FORM-PROJECT-REFUND-APPLICATION-SEARCH-COUNT" resultClass="long">
		  SELECT count(*)
		FROM ( SELECT r.refund_id,r.project_name,r.project_code,p.busi_type,p.busi_type_name,SUM(fr.refund_amount) AS refund_amount,
 		f.status as form_status,<include refid="formCommonSql"/>
     FROM f_refund_application r
 		  Left join f_refund_application_fee fr on r.refund_id = fr.refund_id
 		   LEFT JOIN form f ON f.form_id = r.form_id
 		   left JOIN project p ON p.project_code = r.project_code 
   		<include refid="projectPermissionSql"/>
		 WHERE 1=1 AND f.status!="DELETED" AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
          
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				r.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				r.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>			
			<isNotEmpty property="busiTypeName" prepend=" and ">
				p.busi_type_name like concat('%',#busiTypeName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
	               	p.busi_type = #busiType#
	         </isNotEmpty>
	         <isNotEmpty property="formStatus" prepend=" and ">
				f.status = #formStatus#
			</isNotEmpty>
			<isNotEmpty property="formUserName" prepend=" and ">
				f.user_name = #formUserName#
			</isNotEmpty>
			GROUP BY r.refund_id) a;
		</dynamic>
	</select>
	<!-- 退费申请单选择列表(查询收费表单) -->
    <select id="RM-REFUND-APPLICATION-SEARCH" resultMap="RM-PROJECT">
      <!--   SELECT * FROM f_charge_notification c 
        LEFT JOIN project p ON c.project_code = p.project_code
       LEFT JOIN form f ON f.form_id = c.form_id
        <include refid="projectPermissionSql"/>
        WHERE 1=1 AND f.status!="DELETED"-->
         SELECT p.* FROM project p
  	LEFT JOIN f_charge_notification c
    	ON p.project_code = c.project_code
 	 LEFT JOIN form f
   	 ON f.form_id = c.form_id
   	 <include refid="projectPermissionSql"/>
	WHERE  p.project_code IN (SELECT
        project_code
      FROM f_charge_notification
      GROUP BY project_code) AND 1 = 1 and f.status = "APPROVAL"
        <dynamic>
       		 <isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code = #projectCode#
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
        </dynamic>
       GROUP BY c.project_code
        <isNotEmpty property="sortCol" prepend=" order by ">
            $sortCol$
            <isNotEmpty property="sortOrder">
                $sortOrder$
            </isNotEmpty>
        </isNotEmpty>
        <isEmpty property="sortCol" prepend=" ">
            ORDER BY c.raw_add_time desc
        </isEmpty>
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
            LIMIT #limitStart#,#pageSize#;
        </isGreaterThan>
    </select>

    <!-- 退费申请 选择列表 统计-->
    <select id="MS-REFUND-APPLICATION-SEARCH-COUNT" resultClass="long">
        <!-- SELECT COUNT(*) FROM (SELECT c.* FROM f_charge_notification c
  		LEFT JOIN project p ON c.project_code = p.project_code
  		LEFT JOIN form f ON f.form_id = c.form_id
        <include refid="projectPermissionSql"/>
        WHERE 1=1 AND f.status!="DELETED"  -->
        SELECT COUNT(*) FROM (SELECT p.* FROM project p
  	LEFT JOIN f_charge_notification c
    	ON p.project_code = c.project_code
 	 LEFT JOIN form f
   	 ON f.form_id = c.form_id
   	 <include refid="projectPermissionSql"/>
	WHERE  p.project_code IN (SELECT
        project_code
      FROM f_charge_notification
      GROUP BY project_code) AND 1 = 1 and f.status = "APPROVAL"
        <dynamic>
        	<isGreaterThan property="busiManagerId"  compareValue="0" prepend=" and ">
	                p.busi_manager_id = #busiManagerId#
	            </isGreaterThan>
	            <isGreaterThan property="busiManagerbId"  compareValue="0" prepend=" and ">
	                p.busi_managerb_id = #busiManagerbId#
	            </isGreaterThan>
            <isNotEmpty property="projectCode" prepend=" and ">
                p.project_code = #projectCode#
            </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
                p.project_name like concat('%',#projectName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                p.customer_name like concat('%',#customerName#,'%')
            </isNotEmpty>
        </dynamic>
        GROUP BY c.project_code) a; 
    </select>
	<!-- 复议申请列表 -->
	<select id="MS-EXTRA-RECOUNCIL-APPLY-FORM-SEARCH" resultMap="RM-RECOUNCIL-APPLY-FORM">
		SELECT <include refid="formCommonSql"/>,
			   <include refid="projectCommonSimpleSql"/>,
			   a.id apply_id,a.old_sp_id,a.old_sp_code,a.content_reason,a.overview,
			   a.council_apply_id,a.council_back,a.raw_add_time,a.raw_update_time,
			   i.investigate_id,i.form_id investigate_form_id,i.review investigate_review
		  FROM form f
		  JOIN f_re_council_apply a ON f.form_id = a.form_id
		  JOIN project p ON a.project_code = p.project_code
		  LEFT JOIN (SELECT
					  fi.project_code,
					  fi.investigate_id,
					  fi.form_id,
					  fi.review
					FROM f_investigation fi
					  JOIN (SELECT
					      MAX(fi.investigate_id) investigate_id,
					      review,
					      fi.project_code
					    FROM f_investigation fi
					      JOIN form f
					        ON fi.form_id = f.form_id
					    WHERE f.status != 'DELETED'
					    GROUP BY fi.project_code) i
					    ON fi.investigate_id = i.investigate_id) i ON i.project_code = p.project_code		  
		  <include refid="projectPermissionSql"/>
		  WHERE 1= 1 AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
           <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.id = #applyId#
           </isGreaterThan>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
           <isNotEmpty property="formStatus" prepend=" and ">
              	f.status = #formStatus#
           </isNotEmpty>
           <isNotEmpty property="statusList" prepend=" and ">
              	f.status in 
              	<iterate property="statusList" conjunction="," open="(" close=")">
              		#statusList[]#
              	</iterate>
           </isNotEmpty>           
            <isNotEmpty property="projectCode" prepend=" and ">
              	p.project_code = #projectCode#
           </isNotEmpty>
            <isNotEmpty property="likeProjectCode" prepend=" and ">
              	p.project_code like concat('%',#likeProjectCode#,'%')
           </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
              	p.busi_type like concat(#busiType#,'%')
           </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
              	p.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
              	p.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
       </dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
			$sortCol$
			<isNotEmpty property="sortOrder">
				$sortOrder$
			</isNotEmpty>
		</isNotEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>
	
	<!-- 复议申请列表 统计-->
	<select id="MS-EXTRA-RECOUNCIL-APPLY-FORM-SEARCH-COUNT" resultClass="long">
		SELECT count(*)
		  FROM form f
		  JOIN f_re_council_apply a ON f.form_id = a.form_id
		  JOIN project p ON a.project_code = p.project_code
		  LEFT JOIN (SELECT
					  fi.project_code,
					  fi.investigate_id,
					  fi.form_id,
					  fi.review
					FROM f_investigation fi
					  JOIN (SELECT
					      MAX(fi.investigate_id) investigate_id,
					      review,
					      fi.project_code
					    FROM f_investigation fi
					      JOIN form f
					        ON fi.form_id = f.form_id
					    WHERE f.status != 'DELETED'
					    GROUP BY fi.project_code) i
					    ON fi.investigate_id = i.investigate_id) i ON i.project_code = p.project_code	
		 <include refid="projectPermissionSql"/>
		  WHERE 1= 1 AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
           <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               a.id = #applyId#
           </isGreaterThan>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
           <isNotEmpty property="formStatus" prepend=" and ">
              	f.status = #formStatus#
           </isNotEmpty>
           <isNotEmpty property="statusList" prepend=" and ">
              	f.status in 
              	<iterate property="statusList" conjunction="," open="(" close=")">
              		#statusList[]#
              	</iterate>
           </isNotEmpty>           
            <isNotEmpty property="projectCode" prepend=" and ">
              	p.project_code = #projectCode#
           </isNotEmpty>
           <isNotEmpty property="likeProjectCode" prepend=" and ">
              	p.project_code like concat('%',#likeProjectCode#,'%')
           </isNotEmpty>          
           <isNotEmpty property="busiType" prepend=" and ">
              	p.busi_type like concat(#busiType#,'%')
           </isNotEmpty>
           <isNotEmpty property="projectName" prepend=" and ">
              	p.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
              	p.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
       </dynamic>
	</select>
	
    <!-- 保后项目汇总 上季度 节点 放用款金额（用于计算在保余额）-->
	<select id="MS-EXTRA-AFTERWARDS-PROJECT-SUMMARY-LOANED-AMOUNT-SEARCH" resultMap="RM-AFTERWARDS-PROJECT-SUMMARY">
		SELECT  p.customer_name,SUM(lr.actual_amount) loaned_amount,'0' apply_amount,f.finish_time,p.busi_type,p.dept_id,
  		p.dept_code,p.dept_name
  		FROM  project p 
  		LEFT JOIN f_loan_use_apply l ON l.project_code=p.project_code 
      LEFT JOIN f_loan_use_apply_receipt lr ON lr.apply_id = l.apply_id
  		INNER JOIN form f ON l.form_id = f.form_id AND f.status='APPROVAL'
  		<!--  WHERE lr.actual_loan_time < '2016-07-01 00:00:00'  AND p.busi_type ="135"
 		 AND p.dept_code='YWB'
 		 -->
		WHERE 1=1 AND p.dept_code IS NOT NULL
		<dynamic>
			<isNotEmpty property="finishTime" prepend=" and ">
				<![CDATA[lr.actual_loan_time < #finishTime# ]]>
			</isNotEmpty>
			<isNotEmpty property="busiTypeList" prepend=" and ">
                <iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
                    p.busi_type like concat(#busiTypeList[]#,'%')
                </iterate>
            </isNotEmpty>
			<isNotEmpty property="deptCode" prepend=" and ">
				p.dept_code =#deptCode#
			</isNotEmpty>
		</dynamic>
		 GROUP BY p.dept_code
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>
	<!-- 保后项目汇总 上季度 节点 解保金额（用于计算在保余额）-->
	<select id="MS-EXTRA-AFTERWARDS-PROJECT-SUMMARY-APPLY-AMOUNT-SEARCH" resultMap="RM-AFTERWARDS-PROJECT-SUMMARY">
		SELECT  p.customer_name,SUM(r.apply_amount) apply_amount,'0' loaned_amount,f.finish_time,p.busi_type,p.dept_id,
  		p.dept_code,p.dept_name
  		FROM  project p 
  		LEFT JOIN f_counter_guarantee_release r ON r.project_code=p.project_code 
  		INNER JOIN form f ON r.form_id = f.form_id AND f.status='APPROVAL'
  		<!--  WHERE lr.actual_loan_time < '2016-07-01 00:00:00'  AND p.busi_type ="135"
 		 AND p.dept_code='YWB'
 		 -->
		WHERE 1=1 AND p.dept_code IS NOT NULL
		<dynamic>
			<isNotEmpty property="finishTime" prepend=" and ">
				<![CDATA[ f.finish_time < #finishTime# ]]>
			</isNotEmpty>
			<isNotEmpty property="busiTypeList" prepend=" and ">
                <iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
                    p.busi_type like concat(#busiTypeList[]#,'%')
                </iterate>
            </isNotEmpty>
			<isNotEmpty property="deptCode" prepend=" and ">
				p.dept_code =#deptCode#
			</isNotEmpty>
		</dynamic>
		 GROUP BY p.dept_code
        <isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>
	<!-- 保后项目汇总 户数 统计-->
	<select id="MS-EXTRA-AFTERWARDS-PROJECT-SUMMARY-SEARCH-COUNT" resultClass="long">
       SELECT COUNT(*)   
       FROM (SELECT  p.customer_name,SUM(lr.actual_amount) loaned_amount,f.finish_time,p.busi_type,p.dept_id,
  		p.dept_code,p.dept_name
  		FROM  project p 
  		LEFT JOIN f_loan_use_apply l ON l.project_code=p.project_code 
      LEFT JOIN f_loan_use_apply_receipt lr ON lr.apply_id = l.apply_id
  		INNER JOIN form f ON l.form_id = f.form_id AND f.status='APPROVAL'
 	 WHERE 1=1 AND p.dept_code IS NOT NULL
  <!--  f.finish_time < '2016-07-01 00:00:00' AND  f.finish_time > '2016-04-01'-->
		<dynamic>
			<isNotEmpty property="finishTime" prepend=" and ">
				<![CDATA[lr.actual_loan_time < #finishTime# ]]>
			</isNotEmpty>
			<isNotEmpty property="busiTypeList" prepend=" and ">
                <iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
                    p.busi_type like concat(#busiTypeList[]#,'%')
                </iterate>
            </isNotEmpty>
			<isNotEmpty property="deptCode" prepend=" and ">
				p.dept_code =#deptCode#
			</isNotEmpty>
		</dynamic>
		GROUP BY p.customer_name) a;
	</select>
	<!-- 保后汇总列表 -->
	<resultMap id="RM-FORM-AFTERWARDS-PROJECT-SUMMARY" extends="RM-EXTRA-SIMPLE-FORM"  class="com.born.fcs.pm.dataobject.AfterwardsProjectSummaryFormDO">
        <result property="summaryId" column="summary_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="formId" column="form_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="deptId" column="dept_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="deptCode" column="dept_code" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="deptName" column="dept_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="reportPeriod" column="report_period" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="submitManId" column="submit_man_id" javaType="long" jdbcType="BIGINT" nullValue="0"/>
        <result property="submitManName" column="submit_man_name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="submitManAccount" column="submit_man_account" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="guaranteeHouseholds" column="guarantee_households" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="guaranteeReleasingAmount" column="guarantee_releasing_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="loanHouseholds" column="loan_households" javaType="int" jdbcType="INT" nullValue="0"/>
        <result property="loanReleasingAmount" column="loan_releasing_amount" javaType="com.yjf.common.lang.util.money.Money" jdbcType="BIGINT"/>
        <result property="creditRisk" column="credit_risk" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="creditAfterCheck" column="credit_after_check" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="creditAfterCheckProb" column="credit_after_check_prob" javaType="java.lang.String" jdbcType="TEXT"/>
        <result property="rawAddTime" column="raw_add_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="rawUpdateTime" column="raw_update_time" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>
    <!--  保后汇总列表 -->
    <select id="MS-EXTRA-FORM-AFTERWARDS-PROJECT-SUMMARY-SEARCH" resultMap="RM-FORM-AFTERWARDS-PROJECT-SUMMARY">
 		 SELECT P.*,<include refid="formCommonSql"/>
 		  FROM afterwards_project_summary p 
 		  LEFT JOIN form f ON f.form_id = p.form_id
		 WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isGreaterThan property="formId" compareValue="0" prepend=" and ">
				 p.form_id = #formId#
			</isGreaterThan>
			<isGreaterThan property="summaryId" compareValue="0" prepend=" and ">
				p.summary_id = #summaryId#
			</isGreaterThan>
			
			<isGreaterThan property="deptId" compareValue="0" prepend=" and ">
				p.dept_id = #deptId#
			</isGreaterThan>
			
			<isGreaterThan property="submitManId" compareValue="0" prepend=" and ">
				p.submit_man_id = #submitManId#
			</isGreaterThan>
			
			<isNotEmpty property="deptCode"  prepend=" and ">
				p.dept_code = #deptCode#
			</isNotEmpty>
			
			<isNotEmpty property="deptName"  prepend=" and ">
				p.dept_name = #deptName#
			</isNotEmpty>
			
			<isNotEmpty property="reportPeriod"  prepend=" and ">
				p.report_period like concat('%',#reportPeriod#,'%')
			</isNotEmpty>
			
			<isNotEmpty property="submitManName"  prepend=" and ">
				p.submit_man_name = #submitManName#
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>
		   <isNotEmpty property="deptIdList" prepend=" and ">
	           p.dept_id IN
	           <iterate property="deptIdList" open="(" close=")" conjunction=",">
					#deptIdList[]#
			   </iterate>
	       </isNotEmpty>            
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.raw_add_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   <!-- 保后汇总列表统计 -->
	<select id="MS-EXTRA-FORM-AFTERWARDS-PROJECT-SUMMARY-SEARCH-COUNT" resultClass="long">
		  SELECT count(*)
		 FROM afterwards_project_summary P 
 		  LEFT JOIN form f ON f.form_id = p.form_id
		 WHERE f.status != 'DELETED'  AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isGreaterThan property="formId" compareValue="0" prepend=" and ">
				 p.form_id = #formId#
			</isGreaterThan>
			<isGreaterThan property="summaryId" compareValue="0" prepend=" and ">
				p.summary_id = #summaryId#
			</isGreaterThan>
			
			<isGreaterThan property="deptId" compareValue="0" prepend=" and ">
				p.dept_id = #deptId#
			</isGreaterThan>
			
			<isGreaterThan property="submitManId" compareValue="0" prepend=" and ">
				p.submit_man_id = #submitManId#
			</isGreaterThan>
			
			<isNotEmpty property="deptCode"  prepend=" and ">
				p.dept_code = #deptCode#
			</isNotEmpty>
			
			<isNotEmpty property="deptName"  prepend=" and ">
				p.dept_name = #deptName#
			</isNotEmpty>
			
			<isNotEmpty property="reportPeriod"  prepend=" and ">
				p.report_period like concat('%',#reportPeriod#,'%')
			</isNotEmpty>
			
			<isNotEmpty property="submitManName"  prepend=" and ">
				p.submit_man_name = #submitManName#
			</isNotEmpty>
			<isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>
		   <isNotEmpty property="deptIdList"  prepend=" and ">
	           p.dept_id IN
	           <iterate property="deptIdList" open="(" close=")" conjunction=",">
					#deptIdList[]#
			   </iterate>
	       </isNotEmpty>            
		</dynamic>
	</select>
    
	<!-- 解保申请项目选择列表 -->
    <select id="MS-EXTRA-AVAILABLE-RELEASE-PROJECT-SEARCH" resultMap="RM-PROJECT">
		SELECT p.* 
		FROM release_project r 
		INNER JOIN project p ON p.project_code = r.project_code 
		LEFT JOIN subsystem_dock_project sdp ON sdp.project_code = r.project_code AND sdp.dock_form_type = 'ASSETS_TRANSFER' 
		<include refid="projectPermissionSql"/>
		WHERE (p.status != 'FAILED' AND p.status != 'PAUSE') AND p.phases != 'FINISH_PHASES' AND r.status='AVAILABLE' 
			 AND sdp.project_code IS NULL 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY r.id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>	
    
   	<!-- 解保申请项目选择列表统计 -->
	<select id="MS-EXTRA-AVAILABLE-RELEASE-PROJECT-COUNT" resultClass="long">
		SELECT count(*)
		FROM release_project r 
		INNER JOIN project p ON p.project_code = r.project_code 
		LEFT JOIN subsystem_dock_project sdp ON sdp.project_code = r.project_code AND sdp.dock_form_type = 'ASSETS_TRANSFER' 
		<include refid="projectPermissionSql"/>
		WHERE (p.status != 'FAILED' AND p.status != 'PAUSE') AND p.phases != 'FINISH_PHASES' AND r.status='AVAILABLE' 
			 AND sdp.project_code IS NULL 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
		</dynamic>
	</select> 
	
   	<!-- 企业收入核实情况工作底稿历史数据 -->
	<select id="MS-EXTRA-CHECK-REPORT-INCOME-FORMID" resultClass="long">
		SELECT f.form_id 
		FROM form f INNER JOIN f_afterwards_check i ON f.form_id = i.form_id 
		WHERE f.status = 'APPROVAL' AND i.project_code = #projectCode# AND i.round_year=#roundYear#  
		ORDER BY f.finish_time DESC LIMIT 1		
	</select> 
	
   	<!-- 最新财务报表数据 -->
	<select id="MS-EXTRA-NEWEST-FINANCIAL-KPI-REVIEW-ID" resultClass="long">
		SELECT r.f_review_id 
		FROM f_investigation_financial_review r INNER JOIN form f ON f.form_id = r.form_id 
		WHERE f.status != 'DELETED' AND r.project_code = #value# 
		ORDER BY f.finish_time DESC LIMIT 1
	</select> 
	
	<!-- 保后检查报告列表list -->
    <select id="MS-EXTRA-AFTER-CHECK-SEARCH" resultMap="RM-AFTER-CHECK-FORM">
       	SELECT <include refid="formCommonSql"/>, <include refid="projectCommonSimpleSql"/>, p.busi_manager_id, p.busi_manager_name, 
       		c.id AS check_id, c.edition, c.round_year, c.round_time  
 		FROM f_afterwards_check c 
 			LEFT JOIN form f ON c.form_id = f.form_id 
			LEFT JOIN project p ON c.project_code = p.project_code 
		<include refid="projectPermissionSql"/>			
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>			
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectStatus" prepend=" and ">
				p.status = #projectStatus#
			</isNotEmpty>
			<isNotEmpty property="projectPhases" prepend=" and ">
				p.phases = #projectPhases#
			</isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>			
            <isNotEmpty property="edition" prepend=" and ">
               c.edition = #edition#
            </isNotEmpty>            
           <isNotEmpty property="isLatest" prepend=" and ">
               	c.is_lastest = #isLatest#
           </isNotEmpty>       
            <isGreaterThan property="roundYear"  compareValue="0" prepend=" and ">
               c.round_year = #roundYear#
           </isGreaterThan>
           <isGreaterThan property="roundTime"  compareValue="0" prepend=" and ">
               c.round_time = #roundTime#
           </isGreaterThan>        
		</dynamic>    
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY c.id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
    <!-- 保后检查报告列表count -->
	<select id="MS-EXTRA-AFTER-CHECK-COUNT" resultClass="long">
       	SELECT COUNT(c.id) 
 		FROM f_afterwards_check c 
 			LEFT JOIN form f ON c.form_id = f.form_id 
			LEFT JOIN project p ON c.project_code = p.project_code 
		<include refid="projectPermissionSql"/>
		WHERE p.status != 'DELETED' AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectStatus" prepend=" and ">
				p.status = #projectStatus#
			</isNotEmpty>
			<isNotEmpty property="projectPhases" prepend=" and ">
				p.phases = #projectPhases#
			</isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>			
            <isNotEmpty property="edition" prepend=" and ">
               c.edition = #edition#
            </isNotEmpty>			
           <isNotEmpty property="isLatest" prepend=" and ">
               	c.is_lastest = #isLatest#
           </isNotEmpty>
           <isGreaterThan property="roundYear"  compareValue="0" prepend=" and ">
               c.round_year = #roundYear#
           </isGreaterThan>
           <isGreaterThan property="roundTime"  compareValue="0" prepend=" and ">
               c.round_time = #roundTime#
           </isGreaterThan>  
		</dynamic>
	</select>
	
    <!-- 保后检查报告查询期数 -->
	<select id="MS-EXTRA-AFTER-CHECK-COUNT-EDITION" resultClass="long">
       	SELECT COUNT(c.id) 
 		FROM f_afterwards_check c 
 			LEFT JOIN form f ON c.form_id = f.form_id 
			LEFT JOIN project p ON c.project_code = p.project_code 
		<include refid="projectPermissionSql"/>
		WHERE p.status != 'DELETED' AND c.form_id != #formId# 
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code = #projectCode#
			</isNotEmpty>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="busiManagerName" prepend=" and ">
				p.busi_manager_name like concat('%',#busiManagerName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectStatus" prepend=" and ">
				p.status = #projectStatus#
			</isNotEmpty>
			<isNotEmpty property="projectPhases" prepend=" and ">
				p.phases = #projectPhases#
			</isNotEmpty>
            <isNotEmpty property="formStatus" prepend=" and ">
               f.status = #formStatus#
            </isNotEmpty>		
            <isNotEmpty property="formStatuses" prepend=" and ">
				 f.status in 
				<iterate property="formStatuses" open="(" close=")" conjunction=",">
					#formStatuses[]#
				</iterate>
			</isNotEmpty>            	
            <isNotEmpty property="edition" prepend=" and ">
               c.edition = #edition#
            </isNotEmpty>			
            <isGreaterThan property="roundYear" compareValue="0" prepend=" and ">
               c.round_year = #roundYear#
            </isGreaterThan>			
            <isGreaterThan property="roundTime" compareValue="0" prepend=" and ">
               c.round_time = #roundTime#
            </isGreaterThan>			
           <isNotEmpty property="isLatest" prepend=" and ">
               	c.is_lastest = #isLatest#
           </isNotEmpty>  
		</dynamic>
	</select>
	
	<!-- 发债类到期项目list -->
    <select id="MS-BOND-EXPIRE-PROJECT-SEARCH" resultMap="RM-PROJECT-ISSUE-INFORMATION-SIMPLE">
    	SELECT pii.project_code AS project_code, p.releasable_amount AS amount, SUM(pii.actual_amount) AS actual_amount 
    	FROM project_issue_information pii 
    	INNER JOIN project p ON pii.project_code=p.project_code 
    	WHERE 
    	<![CDATA[
    	pii.busi_type LIKE '12%' AND p.status='NORMAL' AND pii.expire_time<#value# GROUP BY pii.project_code;
    	]]>
    </select>
    
   	<!-- 代偿上会项目选择列表 -->
    <select id="MS-EXTRA-REPAY-PROJECT-SEARCH" resultMap="RM-PROJECT">
		SELECT p.*
		FROM project p 
		INNER JOIN release_project r ON r.project_code=p.project_code 
		<!-- 
		INNER JOIN (SELECT DISTINCT lua.project_code AS project_code FROM f_loan_use_apply lua LEFT JOIN form f ON f.form_id=lua.form_id AND f.status='APPROVAL') fk 
					ON r.project_code=fk.project_code 
		 -->
		<include refid="projectPermissionSql"/>
		WHERE <![CDATA[ p.releasable_amount > (p.released_amount + p.releasing_amount) ]]> AND 
				p.status = 'NORMAL' AND p.phases != 'FINISH_PHASES' AND r.status='AVAILABLE' 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY r.id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 代偿上会项目选择列表统计 -->
	<select id="MS-EXTRA-REPAY-PROJECT-COUNT" resultClass="long">
		SELECT COUNT(*)
		FROM project p 
		INNER JOIN release_project r ON r.project_code=p.project_code 
		<!-- 
		INNER JOIN (SELECT DISTINCT lua.project_code AS project_code FROM f_loan_use_apply lua LEFT JOIN form f ON f.form_id=lua.form_id AND f.status='APPROVAL') fk 
					ON r.project_code=fk.project_code 
		 -->
		<include refid="projectPermissionSql"/>
		WHERE <![CDATA[ p.releasable_amount > (p.released_amount + p.releasing_amount) ]]> AND 
				p.status = 'NORMAL' AND p.phases != 'FINISH_PHASES' AND r.status='AVAILABLE' 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
		</dynamic>
	</select>     
   	<!-- 非代偿上会项目选择列表 -->
    <select id="MS-EXTRA-NO-REPAY-PROJECT-SEARCH" resultMap="RM-PROJECT">
		SELECT p.*
		FROM project p 
		<include refid="projectPermissionSql"/>		
		WHERE p.status != 'PAUSE' AND p.status != 'FAILED' AND p.phases != 'FINISH_PHASES' 
			<!-- 上会结束前不可再申请上会 -->
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.project_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 非代偿上会项目选择列表统计 -->
	<select id="MS-EXTRA-NO-REPAY-PROJECT-COUNT" resultClass="long">
		SELECT COUNT(*) 
		FROM project p 
		<include refid="projectPermissionSql"/>
		WHERE p.status != 'PAUSE' AND p.status != 'FAILED' AND p.phases != 'FINISH_PHASES' 
			<!-- 上会结束前不可再申请上会 -->
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
		</dynamic>
	</select>
	
   	<!-- 保后检查报告选择列表 -->
    <select id="MS-EXTRA-AFTER-CHECK-PROJECT-SEARCH" resultMap="RM-PROJECT">
		SELECT p.*
		FROM project p 
		 LEFT JOIN (SELECT ac.project_code FROM f_afterwards_check ac INNER JOIN form f2 ON ac.form_id=f2.form_id WHERE f2.status IN('DRAFT','SUBMIT','CANCEL','AUDITING','BACK')) pc
		 	ON p.project_code = pc.project_code 
		<include refid="projectPermissionSql"/>
		WHERE p.status != 'PAUSE' AND p.phases != 'FAILED' AND p.phases != 'FINISH_PHASES' AND pc.project_code IS NULL 
			<!-- 需要取放用款通过的项目 -->
			AND p.project_code NOT IN (SELECT lua.project_code FROM f_loan_use_apply lua INNER JOIN form f ON lua.form_id=f.form_id INNER JOIN project pt ON lua.project_code=pt.project_code WHERE f.status!='APPROVAL' AND f.status!='DELETED' AND (lua.apply_type='LOAN' OR lua.apply_type='BOTH') AND pt.phases='LOAN_USE_PHASES') 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
				p.busi_type like concat(#busiType#,'%')
			</isNotEmpty>			
			<isEmpty property="busiType" prepend=" and ">
			    p.busi_type NOT LIKE '5%' AND p.busi_type NOT LIKE '211%' 
			</isEmpty>			
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.project_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 保后检查报告项目选择列表统计 -->
	<select id="MS-EXTRA-AFTER-CHECK-PROJECT-COUNT" resultClass="long">
		SELECT COUNT(*) 
		FROM project p 
		 LEFT JOIN (SELECT ac.project_code FROM f_afterwards_check ac INNER JOIN form f2 ON ac.form_id=f2.form_id WHERE f2.status IN('DRAFT','SUBMIT','CANCEL','AUDITING','BACK')) pc
		 	ON p.project_code = pc.project_code
		<include refid="projectPermissionSql"/>
		WHERE p.status != 'PAUSE' AND p.phases != 'FAILED' AND p.phases != 'FINISH_PHASES' AND pc.project_code IS NULL 
			<!-- 需要取放用款通过的项目 -->
			AND p.project_code NOT IN (SELECT lua.project_code FROM f_loan_use_apply lua INNER JOIN form f ON lua.form_id=f.form_id INNER JOIN project pt ON lua.project_code=pt.project_code WHERE f.status!='APPROVAL' AND f.status!='DELETED' AND (lua.apply_type='LOAN' OR lua.apply_type='BOTH') AND pt.phases='LOAN_USE_PHASES') 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
			<isNotEmpty property="busiType" prepend=" and ">
				p.busi_type like concat(#busiType#,'%')
			</isNotEmpty>			
			<isEmpty property="busiType" prepend=" and ">
			    p.busi_type NOT LIKE '5%' AND p.busi_type NOT LIKE '211%' 
			</isEmpty>			
		</dynamic>
	</select>
	
   	<!-- 保后检查报告选择列表(诉讼保函类) -->
    <select id="MS-EXTRA-AFTER-CHECK-LITIGATION-PROJECT-SEARCH" resultMap="RM-PROJECT">
		SELECT p.*
		FROM project p 
		 LEFT JOIN (SELECT ac.project_code,ac.case_status FROM f_afterwards_check_litigation ac INNER JOIN form f ON ac.form_id=f.form_id WHERE f.status = 'APPROVAL') pc
		 	ON p.project_code = pc.project_code AND pc.case_status IN('WIN','LOSE','WITHDRAW') 
		 LEFT JOIN (SELECT ac2.project_code FROM f_afterwards_check_litigation ac2 INNER JOIN form f2 ON ac2.form_id=f2.form_id WHERE f2.status IN('DRAFT','SUBMIT','CANCEL','AUDITING','BACK')) pc2
		 	ON p.project_code = pc2.project_code
		 <include refid="projectPermissionSql"/>
		WHERE p.busi_type LIKE '211%' AND p.status != 'PAUSE' AND p.phases != 'FAILED' AND p.phases != 'FINISH_PHASES' AND p.contract_no != '' AND p.is_court_ruling = 'IS' 
			AND pc.project_code IS NULL 
			AND pc2.project_code IS NULL 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.project_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 保后检查报告项目选择列表统计(诉讼保函类) -->
	<select id="MS-EXTRA-AFTER-CHECK-LITIGATION-PROJECT-COUNT" resultClass="long">
		SELECT COUNT(*) 
		FROM project p 
		 LEFT JOIN (SELECT ac.project_code,ac.case_status FROM f_afterwards_check_litigation ac INNER JOIN form f ON ac.form_id=f.form_id WHERE f.status = 'APPROVAL') pc
		 	ON p.project_code = pc.project_code AND pc.case_status IN('WIN','LOSE','WITHDRAW') 
		 LEFT JOIN (SELECT ac2.project_code FROM f_afterwards_check_litigation ac2 INNER JOIN form f2 ON ac2.form_id=f2.form_id WHERE f2.status IN('DRAFT','SUBMIT','CANCEL','AUDITING','BACK')) pc2
		 	ON p.project_code = pc2.project_code 			  	
		 <include refid="projectPermissionSql"/>
		WHERE p.busi_type LIKE '211%' AND p.status != 'PAUSE' AND p.phases != 'FAILED' AND p.phases != 'FINISH_PHASES' AND p.contract_no != '' AND p.is_court_ruling = 'IS' 
			AND pc.project_code IS NULL 
			AND pc2.project_code IS NULL 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
		</dynamic>
	</select>
	
	
	<!-- 签报申请列表 -->
	<select id="MS-EXTRA-FORM-CHANGE-APPLY-SEARCH" resultMap="RM-FORM-CHANGE-APPLY">
		SELECT <include refid="formCommonSql"/>,
			   p.apply_id,p.apply_type,p.project_code,p.project_name,p.customer_id,p.customer_name,p.customer_type,p.busi_type,p.status apply_status,
			   p.busi_type_name,p.change_form,p.change_form_id,p.change_remark,p.apply_title,p.apply_code,p.is_need_council,p.status,p.charged_amount,p.raw_add_time,p.raw_update_time,
			   pro.status project_status
		  FROM form f
		  JOIN form_change_apply p ON f.form_id = p.form_id
		  LEFT JOIN project pro ON p.project_code = pro.project_code
 		  <include refid="projectPermissionSql"/>
 		 <!-- 
          <isGreaterThan property="formUserId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM form_related_user 
            	   WHERE user_id = #formUserId# AND user_type = 'FORM_SUBMIT_MAN'  GROUP BY project_code) r1
   			  ON r1.project_code = p.project_code AND r1.rnum > 0
      	  </isGreaterThan>
      	  -->
		  WHERE 1= 1 AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
           <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               p.apply_id = #applyId#
           </isGreaterThan>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
           <isNotEmpty property="formStatus" prepend=" and ">
           		<isEqual property="formStatus" compareValue="COUNCIL_WAITING">
           			p.status = 'COUNCIL_WAITING'
           		</isEqual>
           		<isEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
           			p.status = 'COUNCIL_APPROVAL'
           		</isEqual>
           		<isEqual property="formStatus" compareValue="COUNCIL_DENY">
           			p.status = 'COUNCIL_DENY'
           		</isEqual>
           		<isNotEqual property="formStatus" compareValue="COUNCIL_WAITING">
					<isNotEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
		           		<isNotEqual property="formStatus" compareValue="COUNCIL_DENY">
		           			f.status = #formStatus#
		           		</isNotEqual>           			
           			</isNotEqual>           			
           		</isNotEqual>
           </isNotEmpty>
           <isNotEmpty property="statusList" prepend=" and ">
              	f.status in 
              	<iterate property="statusList" conjunction="," open="(" close=")">
              		#statusList[]#
              	</iterate>
           </isNotEmpty>           
            <isNotEmpty property="applyType" prepend=" and ">
              	p.apply_type = #applyType#
           </isNotEmpty>
           <isNotEmpty property="changeForm" prepend=" and ">
              	p.change_form = #changeForm#
           </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
              	p.project_code = #projectCode#
           </isNotEmpty>
            <isNotEmpty property="likeProjectCode" prepend=" and ">
              	p.project_code like concat('%',#likeProjectCode#,'%')
           </isNotEmpty>
            <isNotEmpty property="busiType" prepend=" and ">
              	p.busi_type like concat(#busiType#,'%')
           </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
              	p.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
              	p.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
             <isNotEmpty property="applyTitle" prepend=" and ">
               p.apply_title like concat('%',#applyTitle#,'%')
            </isNotEmpty>  
             <isNotEmpty property="applyCode" prepend=" and ">
               p.apply_code = #applyCode#
            </isNotEmpty>  
             <isNotEmpty property="likeApplyCode" prepend=" and ">
               p.apply_code like concat('%',#likeApplyCode#,'%')
            </isNotEmpty>                                     
             <isNotEmpty property="isNeedCouncil" prepend=" and ">
               p.is_need_council = #isNeedCouncil#
            </isNotEmpty>
        	 <isNotEmpty property="isSelForCharge" prepend="  ">
	            <isEqual property="isSelForCharge"  compareValue="IS" prepend=" and ">
	            	p.apply_type = 'ITEM' AND
	                (
	                (p.is_need_council = 'IS' AND p.status = 'COUNCIL_APPROVAL')
	                	OR
	                (p.is_need_council != 'IS' AND p.status = 'APPROVAL')
	                )
	            </isEqual>
          	  </isNotEmpty>                                     
       </dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
			$sortCol$
			<isNotEmpty property="sortOrder">
				$sortOrder$
			</isNotEmpty>
		</isNotEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
	</select>
	
	<!-- 签报申请列表 统计-->
	<select id="MS-EXTRA-FORM-CHANGE-APPLY-SEARCH-COUNT" resultClass="long">
		SELECT count(*)
		  FROM form f
		  JOIN form_change_apply p ON f.form_id = p.form_id
		 <include refid="projectPermissionSql"/>
		  <!-- 
          <isGreaterThan property="formUserId"  compareValue="0">
            JOIN (SELECT COUNT(*) rnum,project_code FROM form_related_user 
            	   WHERE user_id = #formUserId# AND user_type = 'FORM_SUBMIT_MAN'  GROUP BY project_code) r1
   			  ON r1.project_code = p.apply_code AND r1.rnum > 0
      	  </isGreaterThan>
      	  -->
		  WHERE 1= 1 AND f.status != 'DELETED' AND (f.status != 'DRAFT' OR f.user_id = #draftUserId#)
        <dynamic>
           <isGreaterThan property="formId"  compareValue="0" prepend=" and ">
               f.form_id = #formId#
           </isGreaterThan>
           <isGreaterThan property="applyId"  compareValue="0" prepend=" and ">
               p.apply_id = #applyId#
           </isGreaterThan>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
               p.customer_id = #customerId#
           </isGreaterThan>
           <isNotEmpty property="formStatus" prepend=" and ">
           		<isEqual property="formStatus" compareValue="COUNCIL_WAITING">
           			p.status = 'COUNCIL_WAITING'
           		</isEqual>
           		<isEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
           			p.status = 'COUNCIL_APPROVAL'
           		</isEqual>
           		<isEqual property="formStatus" compareValue="COUNCIL_DENY">
           			p.status = 'COUNCIL_DENY'
           		</isEqual>
           		<isNotEqual property="formStatus" compareValue="COUNCIL_WAITING">
					<isNotEqual property="formStatus" compareValue="COUNCIL_APPROVAL">
		           		<isNotEqual property="formStatus" compareValue="COUNCIL_DENY">
		           			f.status = #formStatus#
		           		</isNotEqual>           			
           			</isNotEqual>           			
           		</isNotEqual>
           </isNotEmpty>
           <isNotEmpty property="statusList" prepend=" and ">
              	f.status in 
              	<iterate property="statusList" conjunction="," open="(" close=")">
              		#statusList[]#
              	</iterate>
           </isNotEmpty>           
            <isNotEmpty property="applyType" prepend=" and ">
              	p.apply_type = #applyType#
           </isNotEmpty>
            <isNotEmpty property="changeForm" prepend=" and ">
              	p.change_form = #changeForm#
           </isNotEmpty>
            <isNotEmpty property="projectCode" prepend=" and ">
              	p.project_code = #projectCode#
           </isNotEmpty>
            <isNotEmpty property="likeProjectCode" prepend=" and ">
              	p.project_code like concat('%',#likeProjectCode#,'%')
           </isNotEmpty>           
            <isNotEmpty property="busiType" prepend=" and ">
              	p.busi_type like concat(#busiType#,'%')
           </isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
              	p.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
              	p.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
             <isNotEmpty property="applyTitle" prepend=" and ">
               p.apply_title like concat('%',#applyTitle#,'%')
            </isNotEmpty>            
             <isNotEmpty property="applyCode" prepend=" and ">
               p.apply_code = #applyCode#
            </isNotEmpty>   
             <isNotEmpty property="likeApplyCode" prepend=" and ">
               p.apply_code like concat('%',#likeApplyCode#,'%')
            </isNotEmpty>   
             <isNotEmpty property="isNeedCouncil" prepend=" and ">
               p.is_need_council = #isNeedCouncil#
            </isNotEmpty> 
        	 <isNotEmpty property="isSelForCharge" prepend="  ">
	            <isEqual property="isSelForCharge"  compareValue="IS" prepend=" and ">
	            	p.apply_type = 'ITEM' AND
	                (
	                (p.is_need_council = 'IS' AND p.status = 'COUNCIL_APPROVAL')
	                	OR
	                (p.is_need_council != 'IS' AND p.status = 'APPROVAL')
	                )
	            </isEqual>
          	  </isNotEmpty>                                
       </dynamic>
	</select>
	
   	<!-- 保后检查报告最新版本 -->
    <select id="MS-EXTRA-AFTER-CHECK-LATEST-EDITION-SEARCH" resultMap="RM-AFTERWARDS-CHECK">
		SELECT ac.* 
		FROM f_afterwards_check ac 
		LEFT JOIN form f ON f.form_id = ac.form_id 
		WHERE f.status = 'APPROVAL' AND ac.project_code=#projectCode#  
		<dynamic>
			<isNotEmpty property="edition" prepend=" and ">
				ac.edition = #edition#
			</isNotEmpty>
           <isGreaterThan property="roundYear"  compareValue="0" prepend=" and ">
                ac.round_year = #roundYear#
           </isGreaterThan>           
           <isGreaterThan property="roundTime"  compareValue="0" prepend=" and ">
                ac.round_time = #roundTime#
           </isGreaterThan> 			
		</dynamic>		
		 ORDER BY ac.round_year DESC, ac.round_time DESC LIMIT 1
    </select>
    
   	<!-- 保后检查报告查询版本 -->
    <select id="MS-EXTRA-AFTER-CHECK-EDITION-SEARCH" resultMap="RM-AFTERWARDS-CHECK">
		SELECT ac.* 
		FROM f_afterwards_check ac 
		LEFT JOIN form f ON f.form_id = ac.form_id 
		WHERE f.status = 'APPROVAL' 
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				ac.project_code = #projectCode#
			</isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
              	ac.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
                ac.customer_id = #customerId#
           </isGreaterThan>           
           <isNotEmpty property="customerName" prepend=" and ">
              	ac.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
           <isGreaterThan property="roundYear"  compareValue="0" prepend=" and ">
                ac.round_year = #roundYear#
           </isGreaterThan>           
           <isGreaterThan property="roundTime"  compareValue="0" prepend=" and ">
                ac.round_time = #roundTime#
           </isGreaterThan>           
           <isNotEmpty property="edition" prepend=" and ">
               	ac.edition = #edition#
           </isNotEmpty>           
           <isNotEmpty property="isLatest" prepend=" and ">
               	ac.is_lastest = #isLatest#
           </isNotEmpty>           
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY ac.round_year DESC, ac.round_time DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 保后检查报告查询版本count -->
	<select id="MS-EXTRA-AFTER-CHECK-EDITION-COUNT" resultClass="long">
		SELECT COUNT(ac.id) 
		FROM f_afterwards_check ac 
		LEFT JOIN form f ON f.form_id = ac.form_id 
		WHERE f.status = 'APPROVAL' 
		<dynamic>
			<isNotEmpty property="projectCode" prepend=" and ">
				ac.project_code = #projectCode#
			</isNotEmpty>
            <isNotEmpty property="projectName" prepend=" and ">
              	ac.project_name like concat('%',#projectName#,'%')
           </isNotEmpty>
           <isGreaterThan property="customerId"  compareValue="0" prepend=" and ">
                ac.customer_id = #customerId#
           </isGreaterThan>           
           <isNotEmpty property="customerName" prepend=" and ">
              	ac.customer_name like concat('%',#customerName#,'%')
           </isNotEmpty>
           <isGreaterThan property="roundYear"  compareValue="0" prepend=" and ">
                ac.round_year = #roundYear#
           </isGreaterThan>           
           <isGreaterThan property="roundTime"  compareValue="0" prepend=" and ">
                ac.round_time = #roundTime#
           </isGreaterThan>           
           <isNotEmpty property="edition" prepend=" and ">
               	ac.edition = #edition#
           </isNotEmpty>
           <isNotEmpty property="isLatest" prepend=" and ">
               	ac.is_lastest = #isLatest#
           </isNotEmpty>
		</dynamic>
	</select>    
	
   	<!-- 风险等级评定选择项目列表 -->
    <select id="MS-EXTRA-RISK-LEVEL-PROJECT-SEARCH" resultMap="RM-PROJECT">
		SELECT p.*
		FROM project p 
		<include refid="projectPermissionSql"/>		
			<!-- 需要取放用款通过的项目 -->
		  LEFT JOIN 
		  (SELECT project_code, COUNT(*) loan_num FROM form f JOIN f_loan_use_apply a ON f.form_id = a.form_id
        	AND f.status = 'APPROVAL' GROUP BY a.project_code) loan ON loan.project_code = p.project_code
		WHERE p.status != 'FAILED' AND p.status != 'PAUSE' AND p.phases != 'FINISH_PHASES' AND loan.loan_num > 0 
			<!-- 排除正在评级的 -->
			AND p.project_code NOT IN (SELECT rl.project_code FROM f_risk_level rl INNER JOIN form f ON rl.form_id=f.form_id WHERE f.status IN('DRAFT','SUBMIT','CANCEL','AUDITING','BACK')) 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
            <isNotEmpty property="busiTypeList" prepend=" and ">
				<iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
					p.busi_type like concat(#busiTypeList[]#,'%')
				</iterate>
			</isNotEmpty>			
		</dynamic>
		<isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
		       <isNotEmpty property="sortOrder">
		    	 		$sortOrder$
		   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY p.project_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>
    </select>
    
   	<!-- 风险等级评定选择项目列表统计 -->
	<select id="MS-EXTRA-RISK-LEVEL-PROJECT-COUNT" resultClass="long">
		SELECT COUNT(*) 
		FROM project p 
		<include refid="projectPermissionSql"/>		
			<!-- 需要取放用款通过的项目 -->
		  LEFT JOIN 
		  (SELECT project_code, COUNT(*) loan_num FROM form f JOIN f_loan_use_apply a ON f.form_id = a.form_id
        	AND f.status = 'APPROVAL' GROUP BY a.project_code) loan ON loan.project_code = p.project_code
		WHERE p.status != 'FAILED' AND p.status != 'PAUSE' AND p.phases != 'FINISH_PHASES' AND loan.loan_num > 0 
			<!-- 排除正在评级的 -->
			AND p.project_code NOT IN (SELECT rl.project_code FROM f_risk_level rl INNER JOIN form f ON rl.form_id=f.form_id WHERE f.status IN('DRAFT','SUBMIT','CANCEL','AUDITING','BACK')) 
		<dynamic>
			<isNotEmpty property="projectName" prepend=" and ">
				p.project_name like concat('%',#projectName#,'%')
			</isNotEmpty>
			<isNotEmpty property="projectCode" prepend=" and ">
				p.project_code like concat('%',#projectCode#,'%')
			</isNotEmpty>
			<isNotEmpty property="customerName" prepend=" and ">
				p.customer_name like concat('%',#customerName#,'%')
			</isNotEmpty>
            <isNotEmpty property="phases" prepend=" and ">
				 p.phases in 
				<iterate property="phases" open="(" close=")" conjunction=",">
					#phases[]#
				</iterate>
			</isNotEmpty>
            <isNotEmpty property="busiTypeList" prepend=" and ">
				<iterate property="busiTypeList" open="(" close=")" conjunction=" or ">
					p.busi_type like concat(#busiTypeList[]#,'%')
				</iterate>
			</isNotEmpty>			
		</dynamic>
	</select>
	
   	<!-- 风险预警客户相关项目列表 -->
    <select id="MS-EXTRA-RISK-WARNING-CUSTOMER-PROJECT-SEARCH" resultMap="RM-PROJECT">
		SELECT p.*
		FROM project p 
		WHERE p.customer_name=#value# AND p.phases IN('INVESTIGATING_PHASES','COUNCIL_PHASES','RE_COUNCIL_PHASES','CONTRACT_PHASES','LOAN_USE_PHASES','FUND_RAISING_PHASES','AFTERWARDS_PHASES','RECOVERY_PHASES')
    </select>
    
    <!-- 按档案编号查询总数 -->
    <select id="MS-EXTRA-FILE-CODE-SEARCH-COUNT" resultClass="long">
    	SELECT COUNT(ff.file_code) 
    		FROM f_file ff 
    		LEFT JOIN (SELECT file_id, COUNT(*) FROM f_file_input_list WHERE status!='INPUT' GROUP BY file_id) fi ON ff.file_id=fi.file_id
    		LEFT JOIN form f on ff.form_id = f.form_id 
    		WHERE fi.file_id IS NULL 
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                ff.project_code LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCodes" prepend=" and ">
     	   		ff.project_code in 
      	   		<iterate property="projectCodes" open="(" close=")" conjunction=",">
					#projectCodes[]#
				</iterate>           
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                ff.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerNames" prepend=" and ">
				<iterate property="customerNames" open="(" close=")" conjunction=" or ">
					ff.customer_name like concat('%',#customerNames[]#,'%')
				</iterate>
            </isNotEmpty>
            <isNotEmpty property="fileCode" prepend=" and ">
                ff.file_code LIKE CONCAT('%',#fileCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileCodes" prepend=" and ">
				<iterate property="fileCodes" open="(" close=")" conjunction=" or ">
					ff.file_code like concat('%',#fileCodes[]#,'%')
				</iterate>            
            </isNotEmpty>
            <isNotEmpty property="type" prepend=" and ">
                ff.type = #type#
            </isNotEmpty>
            <isNotEmpty property="status" prepend=" and ">
                f.status = #status#
            </isNotEmpty>
            <isNotEmpty property="startTime" prepend=" and ">
                <![CDATA[f.finish_time >= #startTime# ]]>
            </isNotEmpty>
            <isNotEmpty property="endTime" prepend=" and ">
                <![CDATA[f.finish_time <= #endTime# ]]>
            </isNotEmpty>            
        </dynamic>    		
    </select>
    
    <!-- 按档案编号查询列表 -->
   	<select id="MS-EXTRA-FILE-CODE-SEARCH" resultMap="EX-F-FILE">
   		SELECT ff.file_code,ff.file_id,ff.form_id,ff.old_file_code,ff.type,ff.project_code,ff.project_name,ff.customer_id,ff.customer_name,ff.busi_manager_id,ff.busi_manager_name,ff.first_loan_time,ff.filing_time,ff.hand_over_dept_code,ff.hand_over_dept,ff.hand_over_man_id,ff.hand_over_man,ff.hand_over_time,ff.principal_man,ff.vice_manager,ff.receive_dept_code,ff.receive_dept,ff.receive_man_id,ff.receive_man,ff.receive_time,ff.status,ff.file_check_status,ff.dept_code,ff.dept_name,ff.update_time,ff.remark,ff.raw_add_time,ff.raw_update_time  
    		FROM f_file ff 
    		LEFT JOIN (SELECT file_id, COUNT(*) FROM f_file_input_list WHERE status!='INPUT' GROUP BY file_id) fi ON ff.file_id=fi.file_id
    		LEFT JOIN form f on ff.form_id = f.form_id 
    		WHERE fi.file_id IS NULL     		
        <dynamic>
            <isNotEmpty property="projectCode" prepend=" and ">
                ff.project_code LIKE CONCAT('%',#projectCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="projectCodes" prepend=" and ">
     	   		ff.project_code in 
      	   		<iterate property="projectCodes" open="(" close=")" conjunction=",">
					#projectCodes[]#
				</iterate>           
            </isNotEmpty>
            <isNotEmpty property="customerName" prepend=" and ">
                ff.customer_name LIKE CONCAT('%',#customerName#,'%')
            </isNotEmpty>
            <isNotEmpty property="customerNames" prepend=" and ">
				<iterate property="customerNames" open="(" close=")" conjunction=" or ">
					ff.customer_name like concat('%',#customerNames[]#,'%')
				</iterate>
            </isNotEmpty>
            <isNotEmpty property="fileCode" prepend=" and ">
                ff.file_code LIKE CONCAT('%',#fileCode#,'%')
            </isNotEmpty>
            <isNotEmpty property="fileCodes" prepend=" and ">
				<iterate property="fileCodes" open="(" close=")" conjunction=" or ">
					ff.file_code like concat('%',#fileCodes[]#,'%')
				</iterate>
            </isNotEmpty>
            <isNotEmpty property="type" prepend=" and ">
                ff.type = #type#
            </isNotEmpty>            
            <isNotEmpty property="status" prepend=" and ">
                f.status = #status#
            </isNotEmpty>
            <isNotEmpty property="startTime" prepend=" and ">
                <![CDATA[f.finish_time >= #startTime# ]]>
            </isNotEmpty>
            <isNotEmpty property="endTime" prepend=" and ">
                <![CDATA[f.finish_time <= #endTime# ]]>
            </isNotEmpty>            
        </dynamic>
         <isNotEmpty property="sortCol" prepend=" order by ">
		    $sortCol$
	        <isNotEmpty property="sortOrder">
		    	 $sortOrder$
	   		</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="sortCol" prepend=" ">
		    ORDER BY ff.file_id DESC 
		</isEmpty>
		<isGreaterThan property="pageSize" compareValue="0" prepend="">
			LIMIT #limitStart#,#pageSize#;
		</isGreaterThan>        
    </select>
    
    <!-- 按档案状态查询总数 -->
    <select id="MS-EXTRA-FILE-STATUS-SEARCH-COUNT" resultClass="long">
    	SELECT COUNT(*) 
    		FROM f_file_input_list WHERE 1=1 
        <dynamic>
            <isNotEmpty property="status" prepend=" and ">
                status != #status#
            </isNotEmpty>       
            <isGreaterThan property="fileId"  compareValue="0" prepend=" and ">
                file_id = #fileId#
            </isGreaterThan>        
            <isNotEmpty property="fileIds" prepend=" and ">
     	   		file_id in 
      	   		<iterate property="fileIds" open="(" close=")" conjunction=",">
					#fileIds[]#
				</iterate>           
            </isNotEmpty>
        </dynamic>    		
    </select>    
</sqlMap>